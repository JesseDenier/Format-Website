/*! For license information please see HotspotImage.js.LICENSE.txt */
!function(){var e,t={55479:function(e,t,n){"use strict";n.d(t,{pictureId:function(){return a}}),n(18149),n(90882),n(79421),n(35676),n(93493),n(9850),n(76156);var r=n(16760),o=n.n(r),i=(n(87649),n(92620),n(35516),n(86152),n(85505),function(){function e(t,n,r,o){this.message=t,this.expected=n,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(e,Error),{SyntaxError:e,parse:function(t){var r,i,a,u,s,l=arguments.length>1?arguments[1]:{},c={},d={Expression:Y},f=Y,p=function(e){return e},g=function(e){return o()(e,(function(e){return e[0]}))},h="^",m={type:"literal",value:"^",description:'"^"'},v=function(){return{cmd:"^"}},b="_",w={type:"literal",value:"_",description:'"_"'},y=function(){return{cmd:"_"}},D="\\",E={type:"literal",value:"\\",description:'"\\\\"'},C=/^[A-Za-z]/,A={type:"class",value:"[A-Za-z]",description:"[A-Za-z]"},S=function(e){return{cmd:"\\"+e.join("")}},_=/^[\\ {}|'."~=\^`&#]/,k={type:"class",value:"[\\\\ {}|'.\"~=^`&#]",description:"[\\\\ {}|'.\"~=^`&#]"},O=function(e){return{cmd:"\\"+e}},x="{",F={type:"literal",value:"{",description:'"{"'},T="}",I={type:"literal",value:"}",description:'"}"'},B=function(){return{grp:[]}},N=function(e){return{grp:e}},R=/^[A-Za-z0-9\xC0-\u10FFFF.*\/+\-!=><&()[\]|\xB0,;:'\uFFFD"]/,P={type:"class",value:"[A-Za-z0-9\\u00c0-\\u10FFFF.*/+\\-!=><&()\\[\\]|°,;:'�\"]",description:"[A-Za-z0-9\\u00c0-\\u10FFFF.*/+\\-!=><&()\\[\\]|°,;:'�\"]"},L=function(e){return e},W=/^[ \t\n\r]/,U={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},M=0,j=[{line:1,column:1,seenCR:!1}],z=0,V=[],H=0;if("startRule"in l){if(!(l.startRule in d))throw new Error("Can't start parsing from rule \""+l.startRule+'".');f=d[l.startRule]}function q(e){var n,r,o=j[e];if(o)return o;for(n=e-1;!j[n];)n--;for(o={line:(o=j[n]).line,column:o.column,seenCR:o.seenCR};n<e;)"\n"===(r=t.charAt(n))?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),n++;return j[e]=o,o}function K(e,t){var n=q(e),r=q(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function J(e){M<z||(M>z&&(z=M,V=[]),V.push(e))}function Y(){var e,t,n,r;return e=M,(t=G())===c&&(t=null),t!==c?(n=function(){var e,t,n,r;if(M,e=[],t=M,(n=Q())!==c?((r=G())===c&&(r=null),r!==c?t=n=[n,r]:(M=t,t=c)):(M=t,t=c),t!==c)for(;t!==c;)e.push(t),t=M,(n=Q())!==c?((r=G())===c&&(r=null),r!==c?t=n=[n,r]:(M=t,t=c)):(M=t,t=c);else e=c;return e!==c&&(e=g(e)),e}(),n!==c?((r=G())===c&&(r=null),r!==c?e=t=p(n):(M=e,e=c)):(M=e,e=c)):(M=e,e=c),e}function Q(){var e,n;return(e=function(){var e,n,r,o;if(e=M,94===t.charCodeAt(M)?(n=h,M++):(n=c,0===H&&J(m)),n!==c&&(n=v()),(e=n)===c&&(e=M,95===t.charCodeAt(M)?(n=b,M++):(n=c,0===H&&J(w)),n!==c&&(n=y()),(e=n)===c)){if(e=M,92===t.charCodeAt(M)?(n=D,M++):(n=c,0===H&&J(E)),n!==c){if(r=[],C.test(t.charAt(M))?(o=t.charAt(M),M++):(o=c,0===H&&J(A)),o!==c)for(;o!==c;)r.push(o),C.test(t.charAt(M))?(o=t.charAt(M),M++):(o=c,0===H&&J(A));else r=c;r!==c?e=n=S(r):(M=e,e=c)}else M=e,e=c;e===c&&(e=M,92===t.charCodeAt(M)?(n=D,M++):(n=c,0===H&&J(E)),n!==c?(_.test(t.charAt(M))?(r=t.charAt(M),M++):(r=c,0===H&&J(k)),r!==c?e=n=O(r):(M=e,e=c)):(M=e,e=c))}return e}())===c&&(e=function(){var e,n,r,o;return e=M,123===t.charCodeAt(M)?(n=x,M++):(n=c,0===H&&J(F)),n!==c?((r=G())===c&&(r=null),r!==c?(125===t.charCodeAt(M)?(o=T,M++):(o=c,0===H&&J(I)),o!==c?e=n=B():(M=e,e=c)):(M=e,e=c)):(M=e,e=c),e}())===c&&(e=function(){var e,n,r,o;return e=M,123===t.charCodeAt(M)?(n=x,M++):(n=c,0===H&&J(F)),n!==c&&(r=Y())!==c?(125===t.charCodeAt(M)?(o=T,M++):(o=c,0===H&&J(I)),o!==c?e=n=N(r):(M=e,e=c)):(M=e,e=c),e}())===c&&(R.test(t.charAt(M))?(n=t.charAt(M),M++):(n=c,0===H&&J(P)),n!==c&&(n=L(n)),e=n),e}function G(){var e,n;if(e=[],W.test(t.charAt(M))?(n=t.charAt(M),M++):(n=c,0===H&&J(U)),n!==c)for(;n!==c;)e.push(n),W.test(t.charAt(M))?(n=t.charAt(M),M++):(n=c,0===H&&J(U));else e=c;return e}if(window._=n(76635),(r=f())!==c&&M===t.length)return r;throw r!==c&&M<t.length&&J({type:"end",description:"end of input"}),i=null,a=V,u=z<t.length?t.charAt(z):null,s=z<t.length?K(z,z+1):K(z,z),null!==a&&function(e){var t=1;for(e.sort((function(e,t){return e.description<t.description?-1:e.description>t.description?1:0}));t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(a),new e(null!==i?i:function(e,t){var n,r=new Array(e.length);for(n=0;n<e.length;n++)r[n]=e[n].description;return"Expected "+(e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0])+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(e){return"\\x0"+t(e)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(e){return"\\x"+t(e)})).replace(/[\u0100-\u0FFF]/g,(function(e){return"\\u0"+t(e)})).replace(/[\u1000-\uFFFF]/g,(function(e){return"\\u"+t(e)}))}(t)+'"':"end of input")+" found."}(a,u),a,u,s)}}}());function a(e){var t=e.hasOwnProperty("filename")?e.filename:e;return e.hasOwnProperty("origbase")?e.origbase:t}i.parse,n(32944),n(92817)},92620:function(e,t,n){"use strict";n.d(t,{equalFormulas:function(){return A},formatEquation:function(){return m},isBalanced:function(){return D},joinIonsToFormula:function(){return E},parseEquation:function(){return p},parseFormula:function(){return d},reduceReactantsAndProducts:function(){return y},totalCharge:function(){return C}});var r=n(86152),o=n.n(r),i=function(e){return!isNaN(1*e)},a=function(e){var t=e.charCodeAt(0);return t>=65&&t<=90||t>=97&&t<=122},u=function(e){return a(e)&&e===e.toUpperCase()},s=function(e){return a(e)&&e===e.toLowerCase()},l=function(e,t,n,r,i){var a;if(t)if(""===n&&(n=1),o()(t)&&"1"===n)for(var u=0;u<t.length;++u)a={atom:t[u].atom,qty:parseInt(t[u].qty)},u===t.length-1&&(0!==r&&(a.charge=r),""!==i&&(a.phase=i)),e.push(a);else a={atom:t,qty:parseInt(n)},0!==r&&(a.charge=r),""!==i&&(a.phase=i),e.push(a)},c=function(e){for(var t="",n=0,r=0;r<e.length;++r){var o=e.charAt(r);if(i(o))t+=o;else if("+"===o){if(n=1,r!==e.length-1)return 0}else{if("-"!==o)return 0;if(n=-1,r!==e.length-1)return 0}}return parseInt(t)*n},d=function e(t){var n=[],r="",o="",a=0,d="";if(-1!==t.indexOf("!")||-1!==t.indexOf("@")||-1!==t.indexOf("#")||-1!==t.indexOf("$"))return[];var f=t+"H";f=f.replace(/\(s\)/g,"!").replace(/\(aq\)/g,"@").replace(/\(g\)/g,"#").replace(/\(l\)/g,"$");for(var p=0;p<f.length;++p){var g=f.charAt(p);if(u(g))l(n,r,o,a,d),r=g,o="",d="",a=0;else if(s(g)){if(!r)return[];r+=g}else if(i(g)){if(!r)return[];o+=g}else if("("===g){for(var h=!1,m=p+1;m<f.length;++m)if(")"===f.charAt(m)){h=!0;break}if(!h)return[];if(!i(f.charAt(m+1)))return[];if(l(n,r,o,a,d),0===(r=e(f.substring(p+1,m))).length)return[];o="",d="",a=0,p=m}else if("{"===g){for(h=!1,m=p+1;m<f.length;++m)if("}"===f.charAt(m)){h=!0;break}if(!h)return[];var v=f.substring(p+1,m);a=c(v),p=m}else if("!"===g){if(""!==d)return[];d="s"}else if("@"===g){if(""!==d)return[];d="aq"}else if("#"===g){if(""!==d)return[];d="g"}else{if("$"!==g)return[];if(""!==d)return[];d="l"}}return n},f=function(e,t){for(var n="",r=0;r<e.length;++r){var o=e.charAt(r);if(!i(o)){n=""===n?1:parseInt(n);var a=d(e.substring(r));return 0!==a.length&&(t.push({formula:a,qty:n}),!0)}n+=o}return console.error("Chemistryparser parseTerm: This should never happen"),!1},p=function(e){var t=e.replace(/ /g,"").split("=");if(2!==t.length)return{reactants:[],products:[]};for(var n=t[0].replace(/\+\}/g,"*}").split("+"),r=t[1].replace(/\+\}/g,"*}").split("+"),o=[],i=[],a=0;a<n.length;++a){var u=n[a].replace(/\*\}/g,"+}");if(!f(u,o))return{reactants:[],products:[]}}for(a=0;a<r.length;++a)if(u=r[a].replace(/\*\}/g,"+}"),!f(u,i))return{reactants:[],products:[]};return{reactants:o,products:i}},g=function e(t){for(var n="",r=0;r<t.length;++r){var i=t[r];o()(i.atom)?i.qty>1?n=n+"("+e(i.atom)+")":n+=e(i.atom):n+=i.atom,i.qty>1&&(n=n+"_{"+i.qty+"}"),i.phase&&(n=n+"("+i.phase+")")}return n},h=function(e,t){for(var n=[],r=0;r<e.length;++r){var o=e[r],i="";t||1===o.qty||(i=o.qty+" \\, "),i+=g(o.formula),t?n.push({formula:i,qty:o.qty}):n.push(i)}return n},m=function(e,t){return{reactants:h(e.reactants,t),products:h(e.products,t)}},v=function(e){for(var t=[],n=0;n<e.length;++n)for(var r=e[n].formula,i=e[n].qty,a=0;a<r.length;++a){var u=r[a];if(o()(u.atom))for(var s=0;s<u.atom.length;++s)t.push({atom:u.atom[s].atom,qty:u.atom[s].qty*u.qty*i});else t.push({atom:u.atom,qty:u.qty*i})}return t},b=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],o=!1,i=0;i<t.length;++i){var a=t[i];if(r.atom===a.atom){a.qty=a.qty+r.qty,o=!0;break}}o||t.push(r)}return t},w=function(e,t){for(var n=0;n<e.length;++n)if(e[n].atom===t)return n;return-1},y=function(e){var t=v(e.reactants),n=v(e.products);return function(e,t){for(var n=0,r=0;r<e.length;++r){var o=w(t,e[r].atom);if(o===n)++n;else if(o>=n){var i=t.splice(o,1)[0];t.splice(n,0,i),++n}}}(t=b(t),n=b(n)),{reactants:t,products:n}},D=function(e){var t=p(e),n=y(t);if(0===n.reactants.length)return!1;if(n.reactants.length!==n.products.length)return!1;for(var r=0;r<n.reactants.length;++r){var o=n.reactants[r],i=n.products[r];if(i.atom!==o.atom||i.qty!==o.qty)return!1}return!0},E=function(e){e=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],o=!1,i=0;i<t.length;++i){var a=t[i];if(r.ion===a.ion.ion&&r.charge===a.ion.charge){a.qty++,o=!0;break}}o||t.push({ion:r,qty:1})}return t}(e);for(var t=[],n=0;n<e.length;++n){var r=e[n];1===r.ion.pattern.length?t.push({atom:r.ion.pattern[0].atom,qty:r.qty}):t.push({atom:r.ion.pattern,qty:r.qty})}return function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];if(o()(r.atom))if(1===r.qty)for(var i=0;i<r.atom.length;++i)t.push({atom:r.atom[i].atom,qty:r.atom[i].qty});else t.push(r);else t.push(r)}return t}(t)},C=function(e){for(var t=0,n=0;n<e.length;++n)t+=e[n].charge;return t},A=function e(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;++r){if(t[r].qty!==n[r].qty)return!1;if(o()(t[r].atom)){if(!o()(n[r].atom))return!1;if(!e(t[r].atom,n[r].atom))return!1}else if(t[r].atom!==n[r].atom)return!1}return!0}},36710:function(e,t){"use strict";t.Z=function(e){return"undefined"==typeof window||window.navigator&&window.navigator.userAgent&&(window.navigator.userAgent.indexOf("PhantomJS")>=0||window.navigator.userAgent.indexOf("ibookwidgets")>=0)?e:(new window.DOMParser).parseFromString("<html>"+e+"</html>","text/html").documentElement.textContent}},98:function(e,t,n){"use strict";!function(){try{return RegExp(/^\p{L}/,"u")}catch(e){return/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])/}}()},21506:function(e,t,n){var r=n(28524),o=n(35368);o.default&&(o=o.default);var i={ADD_ATTR:["target","autocorrect","marker"]},a=o();r.fn.extend({sanitizeHtml:function(e,t){return a.sanitize(e,t||i)},safeHtml:function(e,t){return null==e?this.html():this.html(this.sanitizeHtml(e,t))},safeAppend:function(e,t){return null==e?this.append(null):this.append(this.sanitizeHtml(e,t))},safeAttr:function(e,t){var n=this.get(0).tagName;return a.isValidAttribute(n,e,t)?this.attr(e,t):this},isSafeURLForNavigation:function(e){return a.isValidAttribute("a","href",e)}}),e.exports=r},22927:function(e){e.exports=function(){var e={0:"debug",1:"info",2:"error"};function t(t,n,r){return n>=r?function(){!function(t,n,r){var o=Array.prototype.slice.call(r);o.unshift(t+" ("+e[n]+"):"),console.log.apply(console,o)}(t,n,arguments)}:function(){}}return{DEBUG:0,INFO:1,ERROR:2,createLogger:function(e,n){return void 0===n&&(n=1),{debug:t(e,0,n),info:t(e,1,n),error:t(e,2,n)}}}}()},44334:function(e,t,n){"use strict";n.d(t,{randomId:function(){return o}}),Math.imul||(Math.imul=function(e,t){var n=(4194303&e)*(t|=0);return 4290772992&e&&(n+=(4290772992&e)*t|0),0|n}),function(e){for(var t=1779033703^e.length,n=0;n<e.length;n++)t=(t=Math.imul(t^e.charCodeAt(n),3432918353))<<13|t>>>19}((new Date).toLocaleString()+Math.random());var r={};function o(e){for(;;){for(var t="",n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-".charAt(Math.floor(54*Math.random()));if(!r.hasOwnProperty(t))return r[t]=!0,t}}},32944:function(e,t,n){"use strict";n.d(t,{matchesOneOfAnswers:function(){return h},prepareForCompare:function(){return f},replaceBadQuotes:function(){return i},trimAll:function(){return g}}),n(16760);var r=n(90882),o=n.n(r);function i(e){return(e||"").replace(/[\u2018\u2019]/g,"'")}n(98),n(3255);var a=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹÐ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"OE",letters:"Œ"},{base:"oe",letters:"œ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],u=null;var s=/[!,-.:;?"'`()[\]{}\u2026\u2014]/g,l=/\s+/g,c=/ ([!,-.:;?"'`()[\]{}\u2026\u2014])/g,d=/([!,-.:;?"'`()[\]{}\u2026\u2014]) /g;function f(e,t){return e?(t=function(e){if("string"==typeof e||e instanceof String)switch(e){case"no":e={case:"1",accent:"0",white:"0",punct:"0"};break;case"yes_ignore_accents":e={case:"0",accent:"1",white:"0",punct:"0"};break;case"no_ignore_accents":e={case:"1",accent:"1",white:"0",punct:"0"};break;default:e={case:"0",accent:"0",white:"0",punct:"0"}}return e}(t),e.normalize&&(e=e.normalize("NFKC")),t&&("1"===t.case&&(e=e.toLowerCase()),"1"===t.accent&&(n=e,null==u&&(u=function(){for(var e={},t=0;t<a.length;t++)for(var n=a[t].letters,r=0;r<n.length;r++)e[n[r]]=a[t].base;return e}()),e=n.replace(/[\u0301\u0060]/gi,"").replace(/[^\u0000-\u007E]/g,(function(e){return u[e]||e}))),"1"===t.punct&&(e=e.replace(s,"")),"1"===t.white&&(e=function(e){return e.replace(l," ").replace(c,"$1").replace(d,"$1")}(e))),e):"";var n}function p(e){return e.replace(/[\x00-\x09\x0B-\x0C\x0E-\x1F\x7F-\x9F\u200B]/g,"")}function g(e){for(var t=0;t<e.length;++t)e[t]=e[t].trim();return e}function h(e,t,n){e=i(e),t=i(t),e=f(e,n);var r=g((t=f(t,n)).split(/##/));r.length>1&&(r=o()(r));for(var a=0;a<r.length;++a)if(p(e.trim())===p(r[a].trim()))return!0;return!1}},21941:function(e,t,n){"use strict";function r(e){return e.firstName&&""!==e.firstName&&e.lastName&&""!==e.lastName?e.firstName+" "+e.lastName:e.firstName&&""!==e.firstName?e.firstName:e.lastName&&""!==e.lastName?e.lastName:e.providerHumanID&&""!==e.providerHumanID&&e.providerHumanID!==e.providerID?e.providerHumanID:e.email&&""!==e.email?e.email.substring(0,e.email.indexOf("@")):e.providerID}n.d(t,{s:function(){return r}})},88853:function(e,t,n){"use strict";n.d(t,{Iu:function(){return o}}),n(21506);var r=[];function o(e){return r[e]&&""!==r[e]?r[e]:e}},44166:function(e,t,n){"use strict";n.r(t),n.d(t,{BCE_NO_LABEL:function(){return O},BCE_YES_LABEL:function(){return k},MATCH_TYPE_AUDIO:function(){return p},MATCH_TYPE_PIC:function(){return f},MATCH_TYPE_WORD:function(){return d},appSafeUnescape:function(){return v},arrayContains:function(){return b},bceBalancedLabelToYesNo:function(){return x},bceCreateTableData:function(){return F},bceFormatQuestion:function(){return N},bceProductsEditableFields:function(){return I},bceReactantsEditableFields:function(){return T},getDateString:function(){return R},isDefined:function(){return g},isMatchDistractor:function(){return y},matchElemId:function(){return D},numericGetMatrixElem:function(){return _},questionTableRowAnswer:function(){return A},questionTableRowAnswers:function(){return S},questionTableRowQuestion:function(){return C},questionTableSplitRow:function(){return E},removeNonNumbers:function(){return w},safeArray:function(){return h},safeString:function(){return m}});var r=n(29259),o=n.n(r),i=n(85505),a=n.n(i),u=n(55479),s=n(92620),l=n(21506),c=n.n(l),d=0,f=1,p=2;function g(e){return!(null==e||a()(e)&&""===e.trim()||(o()(e)&&console.log("isDefined returns true for ",e),0))}function h(e){return null==e?[]:e}function m(e){return null==e?"":e}function v(e){return c()(document.createElement("div")).safeHtml(e).text()}function b(e,t){return-1!==e.indexOf(t)}function w(e){return e.replace(/\D/g," ")}function y(e,t){return t===f?null==e.sources||0===e.sources.length:""===e}function D(e,t,n){return e===d?t:e===f?(0,u.pictureId)(t):e===p?n+"":(console.error("Invalid element type: ",e),0)}function E(e,t){return e.rows[t].split(/##/)}function C(e,t){return E(e,t)[0].trim()}function A(e,t){var n=E(e,t);return n.length>1?n[1].trim():null}function S(e,t){for(var n=E(e,t),r=[],o=1;o<n.length;++o)r.push(n[o].trim());return r}function _(e,t,n){if(null==e)return null;if(e.length<=t)return null;var r=e[t].split(" ");return r.length<=n?null:r[n]}var k="Yes, this equation is balanced",O="No, this equation is not balanced";function x(e,t){return null==e||""===e?"":"yes"===e||"no"===e?e:e===(t=t||function(e){return e})(k)?"yes":"no"}function F(e,t){var n,r=[];switch(t){case"none":break;case"all":r=function(e,t){for(var n=[],r=0;r<=t;r++)n.push(r);return n}(0,e.length-1);break;case"odd":for(n=1;n<e.length;n+=2)r.push(n);break;case"even":for(n=0;n<e.length;n+=2)r.push(n)}var o={values:[],layout:{rows:[],columns:[{width:100},{width:100}]},answers:[]};for(n=0;n<e.length;++n){var i="readonly",a=""+e[n].qty;r.length>0&&n===r[0]&&(i="checked",r.shift()),o.values.push([{value:e[n].atom,CellRole:"readonly"},{value:a,CellRole:i}]),o.layout.rows.push({height:30}),o.answers.push(""+e[n].qty)}return o}function T(e){return"type1"===e?"none":"odd"}function I(e){return"type1"===e?"all":"even"}function B(e,t,n){for(var r=[],o=0;o<e.length;++o)n?r.push("<span class='nowrap'>_____ $$"+e[o].formula+"$$</span>"):t?r.push("<span class='nowrap bce-field empty'><input type='text' /> $$"+e[o].formula+"$$</span>"):r.push("<span class='nowrap'>$$"+e[o]+"$$</span>");return r}function N(e,t){var n=s.parseEquation(e.Equation),r="type3"===e.SubType,o=s.formatEquation(n,r||t),i="";return i+=B(o.reactants,r,t).join("$$\\, + \\,$$"),(i+=" <span class='nowrap'>$$\\: \\rightarrow \\:$$</span> ")+B(o.products,r,t).join("$$\\, + \\,$$")}function R(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,r=e.getYear();return r<1900&&(r+=1900),(1===n?"January":2===n?"February":3===n?"March":4===n?"April":5===n?"May":6===n?"June":7===n?"July":8===n?"August":9===n?"September":10===n?"October":11===n?"November":"December")+" "+t+", "+r}},1019:function(e,t,n){n(99290);var r,o,i,a,u,s,l,c,d,f,p,g,h=n(27813).createDefaultContext,m=n(74397),v=h({nostorage:!0}),b=v.studentaccount,w=v.studentaccountbutton,y=n(3328).instructionsAreEmpty,D=n(56577).openLinkOrWidgetLink;e.exports=(r=n(937),o=n(5733),i=n(89372),a=n(39458),u=n(92824),s=n(93189),l=n(95792),c=n(25081),d=n(21506),f=n(25750),p=n(91845).Z,g=n(88235),void d((function(){return r.getConfig().then((function(e){var t=d(document.createElement("div")).attr("id",y(e.instructions)&&!e.title?"container":"bottom-container").prependTo("body"),n="Image draggable and resizeable"===e["resize-policy"]?d(document.createElement("div")).appendTo(t):t,r=void 0;l.makeWidget({layout:y(e.instructions)&&!e.title?void 0:"title_layout","no-user-select":!0,instructions:e.instructions,uuid:e.uuid2,title:e.title});var h,v,E,C=e.hotspots||[];function A(){d(".popup").addClass("hidden"),d(".triangle").remove(),d("video").each((function(){this.pause()})),d("iframe.youtube").each((function(){this.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})),d("iframe.vimeo").each((function(){this.contentWindow.postMessage('{"method":"pause"}',"*")})),d("audio").each((function(){this.pause()}))}function S(e,t,n,r){if(u.isYoutubeUrl(e.url)){var o=d(document.createElement("div")).addClass("webpopup").addClass("youtube").attr(t).css(t).appendTo(n);u.playYouTube(o,e.url)}else{var i=d(document.createElement("div")).addClass("webpopup").attr(t).appendTo(n);d(document.createElement("iframe")).addClass("vimeo").attr({id:"playerframe"+r.attr("id"),src:p("http://player.vimeo.com/video")+"/"+u.getVimeoId(e.url),width:e.width||"300",height:e.height||"300",frameborder:"0",webkitAllowFullScreen:"",mozallowfullscreen:"",allowFullScreen:""}).appendTo(i)}}function _(e,t,n){var o=a.addElement(e,n);t.tapOrClick((function(){!0===o.paused()?(r=void 0,A(),o.play()):o.pause()}))}function k(e,t,n){n.tapOrClick((function(){D(e,!0,t)}))}function O(e,t){var n=t.find(".popupcontent"),r=t.attr("id");n.safeHtml(i.prepare(e.text)),o.process(n),u.resolveYoutubePlaceholders(n),a.processAudioTags("#"+r);var s=i.processMathElems(n),l=d.Deferred();function c(){t.height()>50&&n.addClass("large"),l.resolve()}return s?i.schedule(c):c(),l}function x(e,t){t.find(".popupcontent").append(d(document.createElement("img")).attr("src",f(e.image)))}function F(e,t){var n=t.find(".popupcontent"),r=""!==e.width?e.width:null,o=""!==e.height?e.height:null;"youtube"===e.videosource?(u.isYoutubeUrl(e.url)||u.isVimeo(e.url))&&S(e,{height:o,width:r},n,t):u.createHtml5VideoPlayer(e.video,r,o).appendTo(n)}function T(e,t){var n=t.find(".popupcontent"),r={};""!==e.width&&(r.width=e.width),""!==e.height&&(r.height=e.height),u.isYoutubeUrl(e.url)||u.isVimeo(e.url)?S(e,r,n,t):n.append(d(document.createElement("div")).addClass("webpopup").attr(r).append(d(document.createElement("iframe")).safeAttr("src",p(e.url)).attr(r)))}b.isStudentAccountsSupported()&&(w.init(),m.init()),n.css("background","black url("+f(e.background_picture)+") no-repeat center center"),"Cover entire area, keep aspect ratio"===e["resize-policy"]?n.css("background-size","cover"):"Contain entire picture, keep aspect ratio"===e["resize-policy"]?n.css("background-size","contain"):"Cover entire area with entire picture"===e["resize-policy"]&&n.css("background-size","100% 100%"),d(document.createElement("div")).attr("id","hotspots").appendTo(n),d(document.createElement("div")).attr("id","popups").appendTo(n);for(var I=0;I<C.length;++I){var B,N=C[I],R="popup_"+I,P="hotspot_"+I,L=d(document.createElement("div")).addClass("hotspot").attr({id:P,popupid:R,type:N.Type}).appendTo(d("#hotspots"));"image"===N["marker-type"]?(L.addClass("image"),B=d(document.createElement("div")).addClass("content").append(d(document.createElement("img")).attr("src",f(N["marker-image"])).load((function(){h()}))).appendTo(L)):"label"===N["marker-type"]?(L.addClass("label"),B=d(document.createElement("div")).addClass("content").safeHtml(N["marker-label"]).appendTo(L)):(L.addClass("none"),B=L);var W=d(document.createElement("div")).attr({id:R,hotspotid:P}).addClass("popup hidden").appendTo(d("#popups")),U=d(document.createElement("div")).addClass("popupcontent").appendTo(W);"AudioPopup"===N.Type?N.audiofile&&""!==N.audiofile&&_(N.audiofile,B,U):"WebLink"===N.Type?k(N.url,"yes"===N.open_link_in_new_tab,B):"ImagePopup"===N.Type?(x(N,W),W.attr("initialised","yes")):W.data("hotspot",JSON.stringify(N)),W.css({left:N.position.X+"px",top:N.position.Y+"px"}),"AudioPopup"!==N.Type&&"WebLink"!==N.Type&&(L.attr("popup-location",N["popup-location-preference"]),B.tapOrClick((function(e){e.stopPropagation();var t=d(this);t.hasClass("hotspot")||(t=t.parent());var o=d("#"+t.attr("popupid"));function i(){var e=d("body").width(),r=d("body").height(),i=n.width(),a=n.height();i>e&&(e=i),a>r&&(r=a);var u,s,l,c,f=n.position().left,p=n.position().top,h=t.find(".content");h.length>0?(l=h.width(),c=h.height(),u=t.position().left,s=t.position().top):(l=t.width(),c=t.height(),u=t.position().left+l/2,s=t.position().top+c/2),g.positionPointerPopup(25,o,{x:t.position().left,y:t.position().top,width:l,height:c,centerx:u,centery:s},f,p,e,r,t.attr("popup-location"),o.parent())}if(r&&r===t.attr("popupid"))r=void 0,A();else{if(r=t.attr("popupid"),"yes"!==o.attr("initialised")){var a=JSON.parse(o.data("hotspot"));"TextPopup"===a.Type?O(a,o).then(i):"ImagePopup"===a.Type?x(a,o):"VideoPopup"===a.Type?F(a,o):"WebPopup"===a.Type&&T(a,o),o.attr("initialised","yes")}A(),setTimeout(i,0)}})))}h=function(){var t,r,o,i;if(l.centerTitle(),d("body").width(),d("body").height(),"Image draggable and resizeable"===e["resize-policy"]){var a=n.width(),u=n.height();o=0,i=0,t=a/v,r=u/E}else{var s=n.width(),f=n.height(),p=c.calculateScaleAndOffset(e["resize-policy"],s,f,v,E);t=p.scale_x,r=p.scale_y,o=p.offset_x,i=p.offset_y}function g(e){return o+e*t}function h(e){return i+e*r}for(var m=0;m<C.length;++m){var b=C[m],w=d("#hotspot_"+m);"label"===b["marker-type"]||"image"===b["marker-type"]?w.css({left:g(b.point.x)+"px",top:h(b.point.y)+"px"}):w.css({left:g(b.position.X)+"px",top:h(b.position.Y)+"px",width:b.position.Width*t+"px",height:b.position.Height*r+"px"});var y=w.find(".content");y.length>0&&y.css({left:(w.width()-y.outerWidth())/2,top:(w.height()-y.outerHeight())/2})}},c.getImageSize(e.background_picture,(function(t,o){if(v=t,E=o,"Image draggable and resizeable"===e["resize-policy"]){n.css({position:"absolute",left:"0",top:"0",width:v+"px",height:E+"px","background-size":"contain"}),s.bwMakeDragAndResizable(n,d("#zoomin"),d("#zoomout"),void 0,(function(){r=void 0,A(),h()}));var i=e.position;if(""!==i.X&&""!==i.Y&&""!==i.Width&&""!==i.Height){var a=parseInt(i.X),u=parseInt(i.Y);if(t=parseFloat(i.Width),o=parseFloat(i.Height),t>0&&o>0){var l=d(window).width(),c=d(window).height(),f=l/t,p=c/o,g=f<p?f:p;n.width(v*g),n.height(E*g);var m=l/2-(a+t/2)*g,b=c/2-(u+o/2)*g;n.css("left",m),n.css("top",b)}}d("#tools").removeClass("hidden")}h()})),window.onresize=h,n.tapOrClick((function(e){(e.gesture&&e.gesture.target===n[0]||!e.gesture&&e.target===n[0]||!e.gesture&&d(e.target).hasClass("triangle"))&&(r=void 0,A())})),window.widget||(window.widget=[]),l.pauseAudioVisual=function(){r=void 0,A()}})),null})))},39458:function(e,t,n){"use strict";n.r(t),n.d(t,{addElement:function(){return y},createElement:function(){return m},createPlayer:function(){return b},createPlayerLimited:function(){return v},pauseAll:function(){return g},process:function(){return h},processAudioTags:function(){return w}});var r=n(21506),o=n.n(r),i=n(97462),a=n.n(i),u=n(35226),s=n.n(u),l="<polygon points='10,10 40,25 10,40'/>",c="<rect x='13' y='13' width='24' height='24'/>",d="<rect x='10' y='10' width='11' height='30'/><rect x='29' y='10' width='11' height='30'/>",f=function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" version="1.1">'+e+"</svg>"};function p(e,t,n,r,i,u){var p=1,g=!1,h=!1,m=Number(r);function v(){return s()("plays left: %d").replace("%d",p>m?"0":m-p+1)}(!m||m<0||Number.isNaN(m))&&(m=0);var b=o()(document.createElement("div")).addClass("bw-audio-player").attr({state:"stopped","data-plays":"enabled",role:"group","aria-label":s()("Audio player")});n?o()(e).replaceWith(b):b.appendTo(e);var w,y=o()(document.createElement("div")).appendTo(b),D=o()(document.createElement("div")).addClass("bw-audio-player-button bw-audio-play").append(f(l)).makeButton(s()("play")).appendTo(y),E=o()(document.createElement("div")).addClass("bw-audio-player-button bw-audio-pause").append(f(d)).makeButton(s()("pause")).appendTo(y),C=o()(document.createElement("div")).addClass("bw-audio-player-button bw-audio-stop").append(f(c)).makeButton(s()("stop")).appendTo(y),A=o()(document.createElement("div")).addClass("bw-audio-player-time bw-audio-player-playtime").safeHtml("__:__").appendTo(y);o()(document.createElement("span")).text(" / ").addClass("bw-audio-player-time  bw-audio-player-slash").appendTo(y);var S=o()(document.createElement("div")).addClass("bw-audio-player-time bw-audio-player-totaltime").safeHtml("__:__").appendTo(y),_=o()(document.createElement("div")).addClass("bw-audio-progress-container").appendTo(b),k=o()(document.createElement("input")).attr("type","range").addClass("bw-audio-progress").attr("min","0").attr("max","0").val(0).appendTo(_);if(m){var O=o()(document.createElement("div")).addClass("bw-audio-player-playcount").appendTo(b);w=o()(document.createElement("span")).addClass("bw-audio-player-plays").safeHtml(v()).appendTo(O),b.attr("data-plays","limited")}m&&k.attr("disabled",!0);var x,F,T=a()({parent:b});function I(e){var t=Math.floor(e),n=t%60+"",r=Math.trunc(t/60)+"";n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),k&&k.val(t),A.safeHtml(r+":"+n)}function B(){p&&w&&w.safeHtml(v())}function N(){x&&clearInterval(x),x=setInterval((function(){I(T.getCurrentTime())}),500),m&&(F&&clearInterval(F),F=setInterval((function(){i(p,Math.floor(T.getCurrentTime()))}),1e4))}function R(){clearInterval(x),m&&(clearInterval(F),i(p,Math.floor(T.getCurrentTime())))}return T.setAudioData(t),m&&function e(){var t=u();!t||g||h?setTimeout(e,100):(p=t.numberOfPlays,T.goToTime(t.numberOfSeconds),I(T.getCurrentTime()),B(),h=!0,p>m&&b.attr("data-plays","disabled"))}(),window.addEventListener("clearReset",(function(e){T.pause(),p=1,T.goToTime(0),I(T.getCurrentTime()),m?(B(),b.attr("data-plays","limited")):b.attr("data-plays","enabled")}),!1),D.tapOrClick((function(e){e.stopPropagation();var t=b.attr("state");(!m||p<=m)&&("playing_paused"===t?T.resume():T.play())})),E.tapOrClick((function(e){e.stopPropagation();var t=b.attr("state");"inactive"!==t&&"playing"===t&&T.pause()})),C.tapOrClick((function(e){e.stopPropagation();var t=b.attr("state");if(m){if("inactive"===t)return;"playing"===t&&T.pause()}else{if("inactive"===t)return;"playing"!==t&&"playing_paused"!==t||(T.pause(),T.goToTime(0),b.attr("state","stopped"),b.removeClass("active"),I(T.getCurrentTime()))}})),k.tapOrClick((function(e){e.stopPropagation()})),k.on("input",(function(e){if(e.stopPropagation(),!m){var t=b.attr("state");e.target.value!==Math.floor(T.getCurrentTime())&&("playing_paused"===t&&(T.goToTime(e.target.value),I(T.getCurrentTime())),"playing"===t&&(T.pause(),T.goToTime(e.target.value),I(T.getCurrentTime()),T.resume()),"stopped"===t&&(T.goToTime(e.target.value),I(T.getCurrentTime()),b.attr("state","playing_paused")))}})),T.addEventListener("play",(function(){b.attr("state","playing"),g=!0,N()})),T.addEventListener("durationchange",(function(){var e,t,n;t=(e=Math.floor(T.getDuration()))%60+"",n=Math.trunc(e/60)+"",t.length<2&&(t="0"+t),n.length<2&&(n="0"+n),k&&k.attr("max",e),S.safeHtml(n+":"+t)})),T.addEventListener("ended",(function(){b.attr("state","stopped"),I(0),R(),m&&(p+=1,B(),i(p,0),p>m&&b.attr("data-plays","disabled"))})),T.addEventListener("pause",(function(){b.attr("state","playing_paused"),I(T.getCurrentTime()),R()})),T.addEventListener("playing",(function(){b.attr("state","playing"),N()})),{player:T}}function g(){o()("audio").each((function(){this.duration>0&&!this.paused&&this.pause()}))}function h(e){0===e.find(".bw-audio-player").length&&e.each((function(e){p(o()(this),o()(this).attr("src")||o()(this).find("source").attr("src"),!0,0,(function(){}),(function(){}))}))}function m(e,t){var n={play:function(e){if(void 0===this.element)return!1;var t;try{return e&&(t=this.element,this.element.addEventListener("playing",(function n(){t.removeEventListener("playing",n),e()}))),this.element.play()}catch(e){return null}},pause:function(){if(void 0===this.element)return!1;try{return this.element.pause(),!0}catch(e){return!1}},paused:function(){return void 0!==this.element&&this.element.paused()},toggle:function(){void 0!==this.paused()&&!0===this.paused()?(g(),this.play()):this.pause()},rewind:function(){if(void 0===this.element)return!1;try{return this.element.goToTime(0),!0}catch(e){return!1}},setVolume:function(e){if(void 0===this.element)return!1;try{return this.element.setVolume(e),!0}catch(e){return!1}},on:function(e,t){if(void 0===this.element)return!1;try{return this.element.addEventListener(e,t),!0}catch(e){return!1}},onLoaded:function(e){this.element?e():this.onLoadedCB=e}};return n.element=a()({parent:t}),n.obj=n.element.player[0],n.element.setAudioData(e),n}function v(e,t,n,r,i){if(t){var a=o()(document.createElement("div")).addClass("audiowrapper");return o()(document.createElement("div")).addClass("audio-placeholder").attr("data-src",e).appendTo(a),a}return{control:a=o()(document.createElement("div")).addClass("audiowrapper"),player:p(a,e,!1,n,r,i)}}function b(e,t){if(t){var n=o()(document.createElement("div")).addClass("audiowrapper");return o()(document.createElement("div")).addClass("audio-placeholder").attr("data-src",e).appendTo(n),n}return p(n=o()(document.createElement("div")).addClass("audiowrapper"),e,!1,0,(function(){}),(function(){})),n}function w(e){e instanceof o()?h(e.find("audio:not(.no-audio-wrap)")):h(o()(e+" audio"))}function y(e,t){return m(e,t)}var D={pauseAll:g,process:h,createElement:m,createPlayerLimited:v,createPlayer:b,processAudioTags:w,addElement:y};window.BWAUDIO=D},78563:function(e,t,n){var r=n(60801).isLTI,o=n(90985).getParameters;e.exports=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n(58436),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n(1723),u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n(80322),s=r()||o().sso;return s&&console.log("Using session storage for credentials"),"ibw-platform-ipad-bookwidgets"===i.getPlatform()?new function(t){this._storage=t,this.setCredentials=function(t){var n=this;return e.Deferred((function(e){n._storage.setItemsAsync([{key:"BwCredentials",value:JSON.stringify(t),attribs:""}],(function(){e.resolve()}),(function(){e.reject()}))}))},this.getCredentials=function(){var t=this;return e.Deferred((function(e){t._storage.getItemsAsync(["BwCredentials"],(function(t){try{var n=JSON.parse(t.BwCredentials.value);e.resolve(n)}catch(t){e.reject()}}),(function(){e.reject()}))}))}}(new u):new function(t){this.setCredentials=function(n){return e.Deferred((function(e){try{t.SetItem("BwCredentials",JSON.stringify(n)),e.resolve()}catch(t){e.reject()}}))},this.getCredentials=function(){return e.Deferred((function(e){try{var n=JSON.parse(t.GetItem("BwCredentials"));e.resolve(n)}catch(t){e.reject()}}))}}(s?t:a)}.bind(null,n(21506),n(2758))},13352:function(e,t,n){var r,o,i,a,u,s,l,c,d,f,p,g,h,m,v;e.exports=(r=n(58436),o=n(88178).f(),i=n(46958),a=n(99065),u=n(80322),n(63347).Z,s=n(51177),c=new(n(35613))(o),f=new s(d=new i),g=new s(p=new a),m=new s(h=new u),"ibw-platform-ipad-bookwidgets"===(v=r.getPlatform())?(l=m,window.BWKSNativeSQL=h,console.log("BWDS: Native")):"ibw-platform-ipad-other"!==v&&"ibw-platform-osx-chrome"!==v&&"ibw-platform-win32-chrome"!==v&&"ibw-platform-chromebook-chrome"!==v&&"ibw-platform-android-chrome"!==v&&"kotobee:"!==window.location.protocol||!window.indexedDB?"ibw-platform-osx-preview"!==v&&"ibw-platform-win32-preview"!==v||!window.openDatabase?(l=c,console.log("BWDS: Local")):(console.log("BWDS: WebSQL"),l=f):(console.log("BWDS: IndexedDB"),l=g),l.test={BWKSIDB:p,BWKSWebSQL:d,BWDSLocal:c,BWDSWebSQL:f},-1!==navigator.userAgent.indexOf("ibookwidgets")&&(window.BWDS=l),l)},69238:function(e,t,n){e.exports=function(e){var t={},n=function(e){return e<10?"0"+e:""+e};function r(e){var t=Array.prototype.slice.call(arguments,1);try{e&&e.apply(null,t)}catch(e){console.log("Received error when executing callback: "+e)}}return t.getDateTime=function(){var e=new Date;return n(e.getFullYear())+"-"+n(1+e.getMonth())+"-"+n(e.getDate())+" "+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())},t.error=function(e,t){return{code:e,message:t}},t.trimLeadingSlash=function(e){return e.length>0&&"/"==e[0]?e.substr(1):e},t.newCallbackQueue=function(){var e={executeList:[],executing:!1,executeNext:function(){e.executeList.length>0?(e.executing=!0,e.executeList.shift().cb(e.executeNext)):e.executing=!1},executeSequential:function(t,n){if(null!=n&&!1!==n&&null!=n&&e.executeList.length>0)for(var r=0;r<e.executeList.length;++r)e.executeList[r].tag==n&&e.executeList.splice(r,1);e.executeList.push({cb:t,tag:n}),e.executing||e.executeNext()}};return e},t.callSafe=r,t.handleException=function(n,o,i){18==n.code?r(o,t.error(e.BWDS_ERROR_SECURITY,"AsyncBWDS Security Error: problem when accessing: "+JSON.stringify(n))):r(o,t.error(e.BWDS_ERROR_INTERNAL,"AsyncBWDS Error: problem when accessing: "+JSON.stringify(n))),i&&i()},t}(n(63347).Z)},88178:function(e,t,n){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n(1723);function r(e){return"iBookWidgets/"+e}var o=e.createLogger("BWKSLocal");return{getItem:function(e){return o.debug("getItem "+r(e)),t.GetItem(r(e))},setItem:function(e,n){o.debug("setItem "+r(e));try{return t.SetItem(r(e),n),!0}catch(e){return!1}},removeItem:function(e){o.debug("removeItem "+r(e)),t.RemoveItem(r(e))},clear:function(){o.debug("clear"),t.Clear()}}}.bind(null,n(22927));e.exports={f:r}},1723:function(e){e.exports={GetItem:function(e){return window.localStorage.getItem(e)},RemoveItem:function(e){window.localStorage.removeItem(e)},SetItem:function(e,t){window.localStorage.setItem(e,t)},Clear:function(){window.localStorage.clear()}}},89372:function(e,t,n){var r,o,i,a,u,s=n(45127).loadJS;e.exports=(r=n(937),o=n(58436),i=n(21506),a=n(76176),u={},window.BWMATH=u,u.disabled=!1,u.nextUniqueId=1,u.queue=[],u.customCssClasses=[],u.initialized=!1,u.initialize=function(){if(!1===this.initialized&&-1!==o.getPlatform().indexOf("chrome")){var e=i(document.createElement("div")).attr("id","chromemathjaxhack").css({position:"absolute","pointer-events":"none"}).prependTo(i("body")),t=i(document.createElement("canvas")).attr({width:300,height:300}).appendTo(e)[0];t.getContext("2d").clearRect(0,0,t.width,t.height),this.initialized=!0}},u.prepare=function(e){if(this.disabled)return e;var t="",n=0,r=e.indexOf("$$"),o=0;for(r>=0&&this.initialize();r>=0&&!(++o>1e4);){t+=e.substring(n,r);var i=e.indexOf("$$",r+2);if(i<0){n=r;break}t+='<span class="bwmathquill" style="direction:ltr; visibility: hidden">\\('+e.substring(r+2,i)+"\\)</span>",n=i+2,r=e.indexOf("$$",n)}return t+e.substring(n)},u._createCssClass=function(e,t){var n=document.createElement("style");n.type="text/css",document.getElementsByTagName("head")[0].appendChild(n),(n.sheet||{}).insertRule?n.sheet.insertRule("."+e+"{"+t+"}",0):(n.styleSheet||n.sheet).addRule(e,t),u.customCssClasses.push(e)},u._copyColorToStrokeAndFill=function(e){var t=e.css("color");e.find("g[stroke]").attr("stroke",null).attr("fill",null);var n="bw-math-jax-expression-"+u.nextUniqueId++,r="stroke: "+t+"; fill: "+t+";";u._createCssClass(n,r),e.addClass(n)},u.schedule=function(e){void 0!==window.MathJax&&window.MathJax.hasOwnProperty("Hub")&&window.MathJax.Hub.hasOwnProperty("Queue")?window.MathJax.Hub.Queue(e):u.queue.push({cb:e})},u.findMathElems=function(e){return e.find(".bwmathquill")},u.allMathElems=function(){return i(".bwmathquill")},u.processMathElems=function(e){var t=this.findMathElems(e);return t.length>0&&(this.process(t),!0)},u.redrawMathElems=function(e){this.redraw(this.findMathElems(e))},u.processAll=function(){this.process(this.allMathElems())},u.redrawAll=function(){this.redraw(this.allMathElems())},u.process=function(e){this.disabled||e.each((function(){if(void 0!==window.MathJax&&window.MathJax.hasOwnProperty("Hub")&&window.MathJax.Hub.hasOwnProperty("Queue")){var e=this;window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,e],(function(){u._copyColorToStrokeAndFill(i(e)),i(e).css("visibility","")}))}else u.queue.push({obj:i(this)})}))},u.processqueue=function(){for(;u.queue.length>0;){var e=u.queue.shift();e.obj&&u.process(e.obj),e.cb&&u.schedule(e.cb)}},window.MathJax={showMathMenu:!1,skipStartupTypeset:!0},"ibw-platform-win32-preview"==o.getPlatform()&&(window.MathJax.SVG={scale:200}),u.loadMathJax=function(){s("external/MathJax24/MathJax.js?config=TeX-AMS-MML_SVG").then(u.processqueue.bind(u))},u.widgetUsesLatex=function(e){return e.hasOwnProperty("modules")&&-1!==e.modules.indexOf("MathJax24")},u.scheduleOrExecuteIfNoLatex=function(e){r.getConfig().then((function(t){u.widgetUsesLatex(t)?u.schedule(e):e()}))},r.getConfig().then((function(e){u.widgetUsesLatex(e)?u.loadMathJax():u.disabled=!0})),u.redraw=function(e){},a.CssUpdateCallbacks&&a.CssUpdateCallbacks.push((function(){var e=u.customCssClasses;u.customCssClasses=[];for(var t=0;t<e.length;++t){var n=e[t],r=i("."+n);r.removeClass(n),u._copyColorToStrokeAndFill(r)}})),u.isOnlyMath=function(e){var t=e.trim();return t.startsWith("$$")&&t.endsWith("$$")&&-1===t.substring(2,e.length-4).indexOf("$$")},u)},2758:function(e){e.exports={GetItem:function(e){return sessionStorage.getItem(e)},RemoveItem:function(e){sessionStorage.removeItem(e)},SetItem:function(e,t){sessionStorage.setItem(e,t)},Clear:function(){sessionStorage.clear()}}},92824:function(e,t,n){"use strict";n.r(t),n.d(t,{addYoutubePlayerIFrame:function(){return l},adjustRichTextVideoSize:function(){return b},createHtml5VideoPlayer:function(){return v},getVimeoId:function(){return o.L2},isVimeo:function(){return o.pn},isYoutubeUrl:function(){return o.Qd},loadYouTubePlayer:function(){return g},playYouTube:function(){return m},pollStartVideos:function(){return h},resolveYoutubePlaceholders:function(){return w},resolveYoutubePlaceholdersNew:function(){return d}});var r=n(44334),o=n(57873),i=n(58436),a=n(21506),u=n.n(a),s=n(91845);function l(e,t){var n=u()(e);if("ibw-platform-win32-preview"===i.getPlatform()||"ibw-platform-osx-preview"===i.getPlatform())return n.safeHtml("<br>Youtube videos are not supported in preview mode."),void n.css({"background-color":"black",color:"white","text-weight":"bold","text-align":"center"});var r=(0,s.Z)("http://www.youtube.com/embed/")+(0,o.qS)(t)+(0,o.Zr)(t);u()(document.createElement("iframe")).attr({seamless:"",id:"playeriframe",src:r}).appendTo(n)}var c=0;function d(e){e.find(".youtubeplaceholder").each((function(){var e=u()(this);if(void 0===e.attr("id")){var t="YTP_"+c++;e.attr("id",t),l("#"+t,e.attr("src"))}}))}var f=!1,p=[];function g(e,t,n){var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",(0,s.Z)("http://www.youtube.com/player_api")),document.getElementsByTagName("body")[0].appendChild(r)}function h(){if(void 0!==window.YT&&void 0!==window.YT.Player)for(var e=0;e<p.length;++e)p[e]();else setTimeout(h,100)}function m(e,t){var n=u()(e),a=n.attr("id");if(null==a&&(a=(0,r.randomId)(20),n.attr("id",a)),"ibw-platform-win32-preview"===i.getPlatform()||"ibw-platform-osx-preview"===i.getPlatform())return n.safeHtml("<br>Youtube videos are not supported in preview mode."),void n.css({"background-color":"black",color:"white","text-weight":"bold","text-align":"center"});function s(){var n=u()(e),r={rel:0},i=(0,o.hC)(t);0!==i&&(r.start=i);var s=(0,o.U0)(t);0!==s&&(r.end=s);var l=(0,o.oj)(t);null!=l&&(r.cc_lang_pref=l);var c=(0,o.Z7)(t);null!=c&&(r.cc_load_policy=c);var d=(0,o.qS)(t);new window.YT.Player(a,{height:n.height(),width:n.width(),videoId:d,playerVars:r})}void 0!==window.YT&&void 0!==window.YT.Player?s():(p.push(s),f||(f="true",g(),setTimeout(h,100)))}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"video/mp4",o=u()(document.createElement("video")).attr({controls:"",preload:"auto",poster:""});return null!=t&&o.attr("width",t),null!=n&&o.attr("height",n),u()(document.createElement("source")).attr({src:e,type:r}).appendTo(o),o}function b(e){"0px"===e.css("width")&&null==e.css("float")||"none"===e.css("float")?e.css({width:"640px",height:"400px","max-width":"90%"}):e.css({width:"320px",height:"240px"})}function w(e){function t(e,t){var n=t.width(),r=t.height(),o=u()(document.createElement("div")).addClass("videodiv").css({width:n,height:r}).appendTo(t);return u()(document.createElement("iframe")).attr({frameborder:"0",webkitAllowFullScreen:"",mozallowfullscreen:"",allowFullScreen:""}).css({width:n,height:r}).appendTo(o).attr("src",e.trim()),o}e.find(".youtubeplaceholder").each((function(){var e=u()(this);if(void 0===e.attr("id")){var n="YTP_"+c++;e.attr("id",n);var r=e.attr("src");b(e),(0,o.aJ)(r)?m("#"+n,r):(0,o.pn)(r)?function(e,n){t((0,s.Z)("http://player.vimeo.com/video")+"/"+(0,o.L2)(e),n).addClass("bw-vimeo-wrapper")}(r,u()("#"+n)):(0,o.Cj)(r)?function(e,n){t((0,s.Z)("http://giphy.com/embed")+"/"+(0,o.BZ)(e),n).addClass("bw-giphy-wrapper")}(r,u()("#"+n)):console.error("Unsupported video URL: "+r)}}))}},87171:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o,i,a,u;e.exports=(o=n(22927),i=o.createLogger("CallbackBridge"),a=1,(u=function(){this.id=a++,this.listening=!1,this.nextCallbackID=1,this.callbacks={},this.handleMessage=this._handleMessage.bind(this)}).prototype.getMessagePrefix=function(){return"bw-CBBridge-"+this.id+"-"},u.prototype.startListening=function(){window.addEventListener("message",this.handleMessage)},u.prototype.stopListening=function(){window.removeEventListener("message",this.handleMessage)},u.prototype._handleMessage=function(e){var t=this.getMessagePrefix();"object"===r(e.data)&&"string"==typeof e.data.command&&e.data.command.substr(0,t.length)===t&&(e.data.hasOwnProperty("err")?this.processCallback(e.data.command,e.data.err,e.data.data):this.processCallback(e.data.command,e.data.arg))},u.prototype.registerCallbacks=function(e,t){var n=""+this.nextCallbackID++;return this.callbacks[n]={ok:e,error:t},{ok:this.getMessagePrefix()+n+"-ok",error:this.getMessagePrefix()+n+"-error"}},u.prototype.registerCallback=function(e,t){var n=""+this.nextCallbackID++;return this.callbacks[n]={cb:e,singleshot:!t},this.getMessagePrefix()+n+"-cb"},u.prototype.processCallback=function(e,t,n){try{var r=e.match(/bw-CBBridge-.*-(.*)-(ok|error|cb)$/);if(r){var o,a=r[1],u=this.callbacks[a];return u?"cb"===r[2]?((o=u.cb)(t,n),void(u.singleshot&&delete this.callbacks[a])):(o="ok"===r[2]?u.ok:u.error,delete this.callbacks[a],void o(t)):void i.error("Cannot find callback with ID "+a+" Bridge "+this.id+this.callbacks)}i.error("Malformed callback: "+e)}catch(e){i.error(e)}},u)},25265:function(e,t,n){var r=n(76635).map;e.exports={url:function(e,t){var n="js2objc://"+e;return t&&(n+="?"+r(t,(function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)})).join("&")),n}}},13342:function(e,t,n){var r=n(44166).getDateString,o=n(76635).pick,i=n(60801).isLTI,a=n(90985).getParameters,u=function(e,t,n,u){var s=u.bwConfig,l=u.studentinfo,c=u.tr,d=s.getConfigSync(),f=a();function p(e){return!e||0===e.length}function g(t){return t.indexOf("bookwidgets.com")>=0||t.indexOf("localhost")>=0?{"Bookwidgets-Platform":e.getPlatform()}:{}}function h(){return f.teacher_id}function m(){return f.school_id}function v(){return f.hasOwnProperty("wv")}return{createStudentWorkSubmitter:function(u,b,w,y){var D={FLD_STUDENT_NAME:"#student",FLD_STUDENT_ACCOUNT:"#student_account",FLD_STUDENT_EMAIL:"#student_email",FLD_STUDENT_ID:"#student_id",FLD_STUDENT_CLASS_ID:"#student_class_id",FLD_TEACHER_EMAIL:"#email",FLD_YOUR_NAME:"#you",FLD_YOUR_EMAIL:"#your_email",FLD_TO_EMAIL:"#to_email"},E={};E[D.FLD_STUDENT_NAME]="student_name",E[D.FLD_STUDENT_EMAIL]="student_email",E[D.FLD_STUDENT_ID]="student_id",E[D.FLD_STUDENT_CLASS_ID]="student_class_id",E[D.FLD_TEACHER_EMAIL]="teacher_email",E[D.FLD_YOUR_NAME]="student_name",E[D.FLD_YOUR_EMAIL]="student_email",E[D.FLD_TO_EMAIL]="to_email";var C=h(),A=m();D._postdata={test_name:u,uuid2:w,WA:y,book_title:b,submit_timestamp:(new Date).toISOString(),submit_date:r(),tzoffset:(new Date).getTimezoneOffset()/60*-1,include_grading:!0,submitted_via_shortcode:window.bwshortcode,answers:[]},"wv"in f&&(D._postdata.wv=f.wv),D._extradata={},D._answersComposer=void 0,D._assetUploadAgenda=[],D._eventCallbacks={},D._lastServerResponse="",D._lastServerData=null,D._leftButtons=[],D._rightButtons=[],D._dialogOptions={},D._endpoint="",D._fieldSettings={},D.setCompanyInfo=function(e,t,n,r){D._postdata.company_name=e,D._postdata.company_address=t,D._postdata.company_phone=n,D._postdata.company_website=r},D.setIncludeGrading=function(e){D._postdata.include_grading=e?"yes":"no"},D.setElapsedTime=function(e){D._postdata.time=e},D.setEndpoint=function(e){D._endpoint=e},D._storeField=function(e,t){var n=D._fieldSettings[e].isVisible,r=D._fieldSettings[e].isEditable;if(n&&r){var o=E[e];l.set(o,t)}},D._setStudentInfo=function(e,t,n,r){D._postdata.student_name=e,D._postdata.student_id=t,D._postdata.student_email=n,D._postdata.student_class_id=r,l.hasStudentAccount()&&(D._postdata.student_userid=l.getStudentAccountUserId(),D._postdata.student_name=l.getStudentAccountUserName(),D._postdata.student_email=l.getStudentAccountEmail(),D._postdata.student_id=l.getStudentAccountProviderHumanId(),D._postdata.student_token=l.getStudentAccountToken());var o=f.context_id;o&&(D._postdata.context_id=o),C&&(D._postdata.teacher_id=C),f.course_id&&(D._postdata.course_id=f.course_id),A&&(D._postdata.school_id=A),D._storeField(D.FLD_STUDENT_NAME,e),D._storeField(D.FLD_STUDENT_ID,t),D._storeField(D.FLD_STUDENT_EMAIL,n),D._storeField(D.FLD_STUDENT_CLASS_ID,r)},D._setTeacherEmail=function(e){D._postdata.teacher_email=e,D._storeField(D.FLD_TEACHER_EMAIL,e)},D._setShareInfo=function(e,t,n,r){D._postdata.student_name=e,D._postdata.student_email=t,D._postdata.to_email=n,D._postdata.message=r,D._storeField(D.FLD_YOUR_NAME,e),D._storeField(D.FLD_YOUR_EMAIL,t),D._storeField(D.FLD_TO_EMAIL,n)},D._setDownloadInfo=function(e,t,n,r){D._postdata.student_name=e,D._storeField(D.FLD_YOUR_NAME,e)},D.setAnswersComposer=function(e){D._answersComposer=e},D.addExtraData=function(e){for(var t in e)D._extradata[t]=e[t]},D.scheduleAssetUpload=function(e,t,n){D._assetUploadAgenda.push({assetFetcherCB:e,assetUploadCompleteCB:t,userdata:n})},D.configureFormField=function(e,t,n,r){D._fieldSettings[e]={isVisible:t,isEditable:n,defaultValue:r}},D.configureFormField(D.FLD_STUDENT_ACCOUNT,!0===l.hasStudentAccount(),!1,l.getStudentAccountUserName()||""),D.configureFormField(D.FLD_STUDENT_NAME,!1===l.hasStudentAccount()&&"yes"==d.student_name_isVisible,"yes"==d.student_name_isEditable,p(d.student_name_defaultValue)&&!p(f.default_student_name)?f.default_student_name:d.student_name_defaultValue),D.configureFormField(D.FLD_STUDENT_EMAIL,!1===l.hasStudentAccount()&&"yes"==d.student_email_isVisible,"yes"==d.student_email_isEditable,d.student_email_defaultValue),D.configureFormField(D.FLD_STUDENT_ID,!1===l.hasStudentAccount()&&"yes"==d.student_id_isVisible,"yes"==d.student_id_isEditable,d.student_id_defaultValue);var S=p(f.student_class_id)?p(l.getStudentAccountClassName())?void 0:l.getStudentAccountClassName():f.student_class_id,_="yes"==d.student_class_id_isEditable&&!S;function k(e,n,r,o){var i,a=t(document.createElement("label"));a.attr("for",n),a.attr("id",n+"_label"),a.text(e),o.append(a),"textarea"==r?(i=t(document.createElement("textarea"))).attr("rows",5):((i=t(document.createElement("input"))).attr("type",r),i.on("focus",(function(){this.value=this.value}))),i.attr("name",n),i.attr("id",n),i.attr("value",""),o.append(i)}function O(e){return e.split(",").length>1}function x(t,n){var r={content:"",ibw_platform:e.getPlatform()};for(var o in D._extradata)r[o]=D._extradata[o];void 0===D._submitPreparer&&(D._submitPreparer=function(e){e()}),D.showProgressDialog(n),setTimeout((function(){D._submitPreparer((function(){D.uploadAssets((function(){console.log("All assets uploaded, now sending answers"),D.composeAllAnswers(),r.content=JSON.stringify(D._postdata),t(r),D.trigger(D.EVT_AFTER_SEND),console.log("Submit complete")}),(function(){console.log("Asset upload failed, aborting"),D.closeProgressDialog(),D.trigger(D.EVT_SUBMIT_FAILED),D.trigger(D.EVT_AFTER_SEND)}))}),(function(e){console.log("Aborted by client: "+e),D.closeProgressDialog(),D._lastServerResponse=void 0,D.trigger(D.EVT_SUBMIT_FAILED),D.trigger(D.EVT_AFTER_SEND)}))}),100)}function F(){x(D.sendResults.bind(D),c("Sending, please wait..."))}function T(){var e=t(this),r=e.find("#student").val(),o=e.find("#student_id").val(),i=e.find("#student_email").val(),a=e.find("#student_class_id").val(),u=e.find("#email").val();if(!1!==l.hasStudentAccount()||""!==r){if(!C){if(!(null!=u&&""!==u||"yes"===d.teacher_email_isVisible&&"yes"===d.teacher_email_isEditable||!1!==v()))return void n.showAlert(c("This field is required:")+" "+c("Teacher Email"),c("Send Failed"));if(O(u))return void n.showAlert(c("You can't specify multiple addresses for field:")+" "+c("Teacher Email"),c("Send Failed"))}e.dialog("close"),e.remove(),D.trigger(D.EVT_BEFORE_SEND),D._setStudentInfo(r,o,i,a),D._setTeacherEmail(u),F()}else n.showAlert(c("This field is required:")+" "+c("Student Name"),c("Send Failed"))}function I(){var e=t(this),r=e.find("#you").val(),o=e.find("#your_email").val(),i=e.find("#to_email").val(),a=e.find("#message").val();""!==r?""!==i?(e.dialog("close"),e.remove(),D.trigger(D.EVT_BEFORE_SEND),D._setShareInfo(r,o,i,a),F()):n.showAlert(c("This field is required:")+" "+c("To Email"),c("Send Failed")):n.showAlert(c("This field is required:")+" "+c("Your Name"),c("Send Failed"))}function B(){var e=t(this),r=e.find("#you").val();""!==r?(e.dialog("close"),e.remove(),D.trigger(D.EVT_BEFORE_SEND),D._setDownloadInfo(r),x(D.generate.bind(D),c("Generating PDF, please wait..."))):n.showAlert(c("This field is required:")+" "+c("Your Name"),c("Download Failed"))}return D.configureFormField(D.FLD_STUDENT_CLASS_ID,"yes"==d.student_class_id_isVisible,_,p(S)?p(d.student_class_id_defaultValue)?"":d.student_class_id_defaultValue:S),D.configureFormField(D.FLD_TEACHER_EMAIL,"yes"==d.teacher_email_isVisible&&!C&&!A,"yes"==d.teacher_email_isEditable,C||d.teacher_email_defaultValue),D.configureFormField(D.FLD_YOUR_NAME,!0,!0,""),D.configureFormField(D.FLD_YOUR_EMAIL,!0,!0,""),D.configureFormField(D.FLD_TO_EMAIL,!0,!0,""),D.addButtonBeforeDefaultButtons=function(e,t){D._leftButtons.push({text:e,click:t})},D.addButtonAfterDefaultButtons=function(e,t){D._rightButtons.push({text:e,click:t})},D.addDialogOptions=function(e){for(var t in e)D._dialogOptions[t]=e[t]},D.setAsyncSubmitPreparer=function(e){D._submitPreparer=e},D.EVT_BEFORE_SHOW="beforeShow",D.EVT_BEFORE_SEND="beforeSend",D.EVT_AFTER_SEND="afterSend",D.EVT_SUBMIT_SUCCEEDED="submitSucceeded",D.EVT_SUBMIT_FAILED="submitFailed",D.on=function(e,t){D._eventCallbacks[e]||(D._eventCallbacks[e]=[]),D._eventCallbacks[e].push(t)},D.trigger=function(e){if(D._eventCallbacks[e])for(var t=0;t<D._eventCallbacks[e].length;++t)D._eventCallbacks[e][t]()},D._applyFormFieldSettings=function(e){if(0!=(a=t(e)).length){var n=t(e+"_label"),r=D._fieldSettings[e].isVisible,o=D._fieldSettings[e].isEditable,i=D._fieldSettings[e].defaultValue;O(i)&&(r&&o?function(e,n){for(var r=t(e),o=t(document.createElement("select")).attr({id:r.attr("id"),name:r.attr("name")}),i=0;i<n.length;++i)t(document.createElement("option")).safeHtml(n[i]).appendTo(o);r.replaceWith(o),r.remove()}(e,function(e){for(var t=e.split(","),n=[],r=0;r<t.length;++r)n.push(t[r].trim());return n}(i)):i=i.split(",")[0]);var a=t(e);if(n=t(e+"_label"),!1===r&&(a.hide(),n.hide()),!1===o&&a.attr("disabled","true"),a.val(i),r&&o){var u=E[e];l.get(u,(function(e){null!=e&&""!==e&&a.val(e)}))}}},D.showSendDialog=function(e,r){l.initialized().done((function(){if(l.isCoAccount())n.showAlert(c("Submit is disabled because you're not logged in with a student account. e.g. a parent account."),c("Can't submit"));else{var o=function(){t("#student-work-submitter-dialog").remove();var e=t(document.createElement("div"));e.attr("id","student-work-submitter-dialog"),e.css("display","none");var n=t(document.createElement("div"));return n.attr("id","student-work-submitter-dialog-info"),e.append(n),k("","student_account","text",e),k(c("Student Name"),"student","text",e),k(c("Student ID"),"student_id","text",e),k(c("Student Email"),"student_email","email",e),k(c("Class ID"),"student_class_id","text",e),k(c("Teacher Email"),"email","email",e),t("body").append(e),e}(),u=!1;for(var s in D._fieldSettings)D._applyFormFieldSettings(s),u=u||D._fieldSettings[s].isVisible&&D._fieldSettings[s].isEditable&&t(s).length>0;e?t("#student-work-submitter-dialog-info").safeHtml(e).removeClass("hidden").addClass("dialog-warning"):t("#student-work-submitter-dialog-info").addClass("hidden").removeClass("dialog-warning");for(var d=[],f=0;f<D._leftButtons.length;++f)d.push(D._leftButtons[f]);for(d.push({text:c("Send"),click:T}),f=0;f<D._rightButtons.length;++f)d.push(D._rightButtons[f]);var p={dialogClass:"bw-dialog bw-student-work-submitter",modal:!0,title:c("Send Answer"),width:Math.min(450,.9*t(window).width())+"px",buttons:d};for(var g in D._dialogOptions)p[g]=D._dialogOptions[g];o.dialog(p);var h=a(!1).toplevel;u||1!==d.length||!r||!i()||h||T.call(o)}}))},D.showShareDialog=function(e){console.log("showShare"),l.initialized().done((function(){var n=function(){t("#student-work-share-dialog").remove();var e=t(document.createElement("div"));e.attr("id","student-work-share-dialog"),e.css("display","none");var n=t(document.createElement("div"));return n.attr("id","student-work-share-dialog-info"),e.append(n),k(c("Your Name"),"you","text",e),k(c("Your Email"),"your_email","email",e),k(c("To Email"),"to_email","email",e),k(c("Optional Message"),"message","textarea",e),t("body").append(e),e}();for(var r in D._fieldSettings)D._applyFormFieldSettings(r);e?(t("#student-work-share-dialog-info").safeHtml(e),t("#student-work-share-dialog-info").removeClass("hidden")):t("#student-work-share-dialog-info").addClass("hidden");for(var o=[],i=0;i<D._leftButtons.length;++i)o.push(D._leftButtons[i]);for(o.push({text:c("Send"),click:I}),i=0;i<D._rightButtons.length;++i)o.push(D._rightButtons[i]);var a={dialogClass:"bw-dialog bw-student-work-submitter",modal:!0,title:c("Share"),width:Math.min(450,.9*t(window).width())+"px",buttons:o};for(var u in D._dialogOptions)a[u]=D._dialogOptions[u];n.dialog(a)}))},D.showDownloadDialog=function(e){console.log("showDownload"),l.initialized().done((function(){var n=function(){t("#student-work-download-dialog").remove();var e=t(document.createElement("div"));e.attr("id","student-work-download-dialog"),e.css("display","none");var n=t(document.createElement("div"));return n.attr("id","student-work-download-dialog-info"),e.append(n),k(c("Your Name"),"you","text",e),t("body").append(e),e}();for(var r in D._fieldSettings)D._applyFormFieldSettings(r);e?(t("#student-work-download-dialog-info").safeHtml(e+"<br>"),t("#student-work-download-dialog-info").removeClass("hidden")):t("#student-work-download-dialog-info").addClass("hidden");for(var o=[],i=0;i<D._leftButtons.length;++i)o.push(D._leftButtons[i]);for(o.push({text:c("Generate"),click:B}),i=0;i<D._rightButtons.length;++i)o.push(D._rightButtons[i]);var a={dialogClass:"bw-student-work-submitter",modal:!0,title:c("Download as PDF"),width:Math.min(450,.9*t(window).width())+"px",buttons:o};for(var u in D._dialogOptions)a[u]=D._dialogOptions[u];n.dialog(a)}))},D.showProgressDialog=function(e){(function(){var e="student-work-submitter-progress-dialog";t("#"+e).remove();var n=t(document.createElement("div"));n.attr("id",e),n.css("display","none");var r=t(document.createElement("div"));r.addClass("spinner"),n.append(r);var o=t(document.createElement("div"));return o.addClass("progress-message"),o.text(c("Uploading your answers...")),n.append(o),t("body").append(n),n})().dialog({modal:!0,dialogClass:"no-close bw-dialog",title:e})},D.updateProgressMessage=function(e){t(".progress-message").text(e)},D.closeProgressDialog=function(){t("#student-work-submitter-progress-dialog").remove()},D.uploadAssets=function(e,t){var n=D._assetUploadAgenda,r=null,o=0,i=n.length;(r=function(){if(n.length>0){var a=n.shift(),u=a.assetFetcherCB(a.userdata);console.log("Uploading",u),++o,u?(D.updateProgressMessage(("audio/mpeg"===u.mimetype?c("Uploading audio"):c("Uploading image"))+" "+o+" / "+i),D.sendAsset(u,(function(e){a.assetUploadCompleteCB(e,a.userdata),r()}),(function(){D._lastServerResponse=void 0,t()}))):r()}else D.updateProgressMessage(c("Uploading your answers...")),e()})()},D.sendAssetAjax=function(e,n,r){var o={content:JSON.stringify({is_asset:!0,asset_data:e.data,asset_mimetype:e.mimetype})};for(var i in D._extradata)o[i]=D._extradata[i];t.ajax({type:"POST",headers:g(D._endpoint),url:D._endpoint,data:o,success:function(e){n(e)},error:function(){r()}})},D.genRandomString=function(e){for(var t="",n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t},D.sendAsset=D.sendAssetAjax,D.composeAllAnswers=function(){D._postdata.answers=s.inverseFixResourcePaths(D._answersComposer())},D.sendAudioPacket=function(e,n,r,o,i){var a=D._endpoint+".m4a?t="+e+"&d="+n+"&p="+r,u=new Audio;t(u).on("loadedmetadata",(function(){var e=Math.floor(10*t(this)[0].duration);o(e)})),t(u).on("error",(function(){console.log("Audio package load failure: "+u.error.code),i("Network or server problem")})),u.src=a},D.getPacket=function(e){for(var t=0,n=e.length,r=0,o="",i="";;){var a=n-t;if(0===a)break;var u=e.substr(t,100),s=encodeURIComponent(u),l=s.length;if(r+l>1900){i=e.substr(t);break}t+=a<100?a:100,o+=s,r+=l}return{packet:o,remaining:i}},D.sendAudio=function(e,t,n,r,o){void 0===r&&(r=D.genRandomString(20)),void 0===o&&(o=1);var i,a=D.getPacket(e);""===a.remaining?(i=t,o=0):i=function(e,t,n){return function(i){0===i?D.sendAudio(e,t,n,r,o+1):n("Wrong server response")}}(a.remaining,t,n),D.sendAudioPacket(r,a.packet,o,i,n)},D.sendResultsAudio=function(e){D.sendAudio(JSON.stringify(e),(function(e){switch(console.log("sendAudio success handler called"),D.closeProgressDialog(),e){case 0:console.error("Oops, server expected another packet..."),D._lastServerResponse=void 0,D.trigger(D.EVT_SUBMIT_FAILED);break;case 1:console.log("That's a success!"),D.trigger(D.EVT_SUBMIT_SUCCEEDED);break;case 2:console.error("Network or server error"),D._lastServerResponse="NEWUSER",D.trigger(D.EVT_SUBMIT_FAILED);break;case 3:console.error("Network or server error"),D._lastServerResponse="USERNOTACTIVE",D.trigger(D.EVT_SUBMIT_FAILED);break;case 4:console.error("Network or server error"),D._lastServerResponse="INVALIDUSER",D.trigger(D.EVT_SUBMIT_FAILED);break;case 5:console.error("Network or server error"),D._lastServerResponse="STUDENTNOTAUTHORIZED",D.trigger(D.EVT_SUBMIT_FAILED);break;default:console.error("Unexpected server return value"),D._lastServerResponse=void 0,D.trigger(D.EVT_SUBMIT_FAILED)}}),(function(e){console.error("sendAudio error handler called: "+e),D.closeProgressDialog(),D._lastServerResponse=void 0,D.trigger(D.EVT_SUBMIT_FAILED)}))},D.sendResultsAjax=function(e){e.accept_json_response=!0,d.hasOwnProperty("widget_language")&&""!=d.widget_language&&(e.lang=d.widget_language),t.ajax({type:"POST",headers:g(D._endpoint),url:D._endpoint,data:e,success:function(e,t,n){console.log("Submit OK"),D.closeProgressDialog();var r=n.getResponseHeader("Content-Type");switch(D._lastServerResponse=e,D._lastServerMessage=null,D._lastServerData=null,r){case"application/json":e.hasOwnProperty("status")&&"OK"===e.status?(console.log("That's a success!"),D._lastServerData=o(e,["data","messages"]),D.trigger(D.EVT_SUBMIT_SUCCEEDED)):e.hasOwnProperty("code")?(console.log("That's a failure!",e),D._lastServerResponse=e.code,D._lastServerMessage=e.message,D.trigger(D.EVT_SUBMIT_FAILED)):(console.log("That's a success!"),D.trigger(D.EVT_SUBMIT_SUCCEEDED));break;case"text/html":console.log("That's a success!"),D.trigger(D.EVT_SUBMIT_SUCCEEDED);break;default:"OK"==e?(console.log("That's a success!"),D.trigger(D.EVT_SUBMIT_SUCCEEDED)):(console.log("That's a failure!"),D.trigger(D.EVT_SUBMIT_FAILED))}},error:function(e){console.error("AJAX error handler called");try{var t=JSON.parse(e.responseText);D._lastServerResponse=null,D._lastServerData=null,D._lastServerMessage=t.message}catch(e){console.error("Error msg not json"),D._lastServerResponse=void 0}D.closeProgressDialog(),D.trigger(D.EVT_SUBMIT_FAILED)}})},D.generate=function(e){t.ajax({type:"POST",headers:g(D._endpoint),url:D._endpoint,data:e,success:function(e,r,o){var i,a,u;console.log("AJAX success handler called"),D.closeProgressDialog(),"application/json"==o.getResponseHeader("Content-Type")?(console.log("That's a success!"),D._lastServerResponse=e,i=e.url,a=e.filename,u=t(document.createElement("div")).append(t(document.createElement("a")).attr({href:i,download:a}).safeHtml(c("Click here to download your PDF"))),n.showAlert(u.html(),c("PDF generated"))):(console.log("That's a failure!"),D._lastServerResponse=e,n.showAlert(c("Could not generate PDF.  Please try again later."),c("Generate PDF failed")))},error:function(){console.log("AJAX error handler called"),D.closeProgressDialog(),D._lastServerResponse=void 0,n.showAlert(c("Could not generate PDF.  Please try again later."),c("Generate PDF failed"))}})},D.sendResults="ibw-platform-ipad-ibooks-epub"==e.getPlatform()?D.sendResultsAudio:D.sendResultsAjax,D.getLastServerResponse=function(){return D._lastServerResponse},D.getLastServerMessage=function(){return D._lastServerMessage},D.getLastServerData=function(){return D._lastServerData},D.afterSubmitFailed=function(e,t,r){var o="",i=this.getLastServerResponse();if(i)if(o=e+"<br><br>","NEWUSER"===i)o+=c("The email address you provided has not been registered.")+"<br><br>",o+=c("To prevent abuse, results can only be sent to registered email addresses.")+" ",o+=c("Activate by clicking on the link in the email which was sent to the address provided.")+" ",o+=c("You can also register at www.bookwidgets.com.")+"<br>";else if("USERNOTACTIVE"===i)o+=c("The email address you provided has not been activated.")+"<br><br>",o+=c("To prevent abuse, results can only be sent to registered email addresses.")+" ",o+=c("Activate by clicking on the link in the email which was sent to the address provided.")+" ",o+=c("You can also register at www.bookwidgets.com.")+"<br>";else if("INVALIDUSER"===i)o+=c("Invalid user name")+"<br>";else{var a;o+=(a=this.getLastServerMessage())?a+"<br>":c("Unknown error")+"<br>"}else(a=this.getLastServerMessage())?o+=a+"<br>":o=t;n.showAlert(o,c("Send Failed"),null,r)},D},isTeacherEmailRequired:function(){return!h()&&!m()&&!v()}}}.bind(null,n(58436),n(21506),n(35048));e.exports={bindToContext:u}},91845:function(e,t,n){"use strict";function r(e){var t="file:";window&&window.location&&window.location.protocol&&(t=window.location.protocol);var n="";return 0===e.indexOf("http://")?n="http://":0===e.indexOf("https://")?n="https://":0===e.indexOf("//")&&(n="//"),""!==n?"file:"===t||"http:"===t?"//"===n?"http:"+e:e:"https:"===t&&"http://"===n?e.replace("http://","https://"):"//"===n?"https:"+e:e:e}n.d(t,{Z:function(){return r}})},45442:function(e){e.exports=window.Blob},97462:function(e,t,n){var r=n(21506);e.exports=function(e){var t=r(document.createElement("audio")).addClass("bw-audio-recorder-player no-audio-wrap bw-audio-player-audio").attr("controls","false").appendTo(e.parent);return{player:t,setAudioData:function(e,n){e&&t.attr({url:e,type:n,src:null})},pause:function(){t[0].pause()},paused:function(){return t[0].paused},resume:function(){t[0].play()},play:function(){t.attr("src",t.attr("url")),t[0].play()},stop:function(){t.attr("src",null)},getDuration:function(){return parseInt(t[0].duration)},clear:function(){t.attr({url:"",src:"",type:""})},addEventListener:function(e,n){t[0].addEventListener(e,n)},removeEventListener:function(e,n){t[0].removeEventListener(e,n)},goToTime:function(e){null==t.attr("src")&&t.attr("src",t.attr("url")),t[0].currentTime=e},setVolume:function(e){t[0].volume=e},getCurrentTime:function(){return t[0].currentTime}}}},937:function(e,t,n){"use strict";n.r(t),n.d(t,{extractOnlineResources:function(){return q},fixResourcePaths:function(){return V},getConfig:function(){return K},getConfigSync:function(){return J},inverseFixResourcePaths:function(){return H},inverseReplaceResourceDir:function(){return M},replaceResourceDir:function(){return U}});var r=n(16760),o=n.n(r),i=n(21506),a=n(90985).getParameters,u=n(45127),s=u.loadJS,l=u.loadCSS,c=!1,d=!1,f=new RegExp("https://www.bookwidgets.com/create/api/widgets/[0-9]+/preview/config.(css||js)?"),p=new RegExp("http://localhost(:[0-9]+)?/create/api/widgets/[0-9]+/preview/config.(css||js)?");function g(e){return window.WidgetParams?e:0===window.location.pathname.indexOf("/_ah/gcs/bookwidgets-eu--widgets/")?0===e.search(p)?e:window.location.origin+"/_ah/gcs/bookwidgets-eu--widget-assets"+e:window.location.host.startsWith("widgets-eu.")?0===e.search(f)?e:window.location.host.replace("widgets-eu.","//widget-assets-eu.")+e:e}var h=n(21506),m=n.n(h),v=n(75652),b=n.n(v);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=[],D=0,E=0,C=null;function A(e){console.log("Select design element",e),void 0!==window.previewsidebar?window.previewsidebar.setSelectedItem(e):window.parent.postMessage({command:"select-design-element",element:e})}function S(e){E=0;var t=!1,n=m()(e),r=function(){var e={};m().each(y,(function(r,o){var i,a,u=(a=2,function(e){if(Array.isArray(e))return e}(i=o)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],s=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(i,a)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],l=u[1];try{if(n.is(s)){var c=n.offset().top+"_"+n.offset().left;e[c]?e[c].elements.push(l):e[c]={offset:n.offset(),elements:[l]},t=!0}}catch(e){}})),m().each(e,(function(e,t){var n=m()(document.createElement("div")).addClass("bw-design-tooltip").attr("data-design-element",t.elements[0]).css({position:"absolute",top:t.offset.top,left:t.offset.left}).appendTo("body");m().each(b()(t.elements),(function(e,t){m()(document.createElement("a")).text(C&&C[t]?C[t]:t).attr("href","#").click((function(e){A(t),e.stopPropagation(),e.preventDefault()})).appendTo(n)}))})),n=n.parent()};do{r()}while(!1===t&&n.length>0)}function _(){m()(".bw-design-tooltip").remove()}function k(e){var t=e.target;m()(t).is(".bw-design-tooltip")||m()(t).is(".bw-design-tooltip a")||D!==t&&(0===E&&_(),clearTimeout(E),D=t,E=setTimeout(S.bind(null,t),400))}function O(){var e=m()(".bw-design-tooltip");0!==e.length&&A(e.attr("data-design-element"))}window.activateDesignInfoTooltips=function(e){C=e,window.addEventListener("mousemove",k),window.addEventListener("click",O)},window.disableDesignInfoTooltips=function(){_(),window.removeEventListener("mousemove",k),window.removeEventListener("click",O)};var x=[],F=!1;window.BwNotifyWidgetLoaded=function(){F||(F=!0,window.parent.postMessage("BwWidgetLoaded","*"),window.clientApp&&window.clientApp.widgetLoaded&&window.clientApp.widgetLoaded())};var T=!0;function I(){for(;x.length>0;)x.shift()();T&&window.BwNotifyWidgetLoaded()}function B(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}window.BwUseManualWidgetLoadedNotification=function(){T=!1};var P={},L=m().Deferred();function W(e,t,n){if(null==e)return e;if("string"==typeof e)return e.replace(t,n);if(m().isArray(e)){for(var r=[],o=0;o<e.length;++o)r.push(W(e[o],t,n));return r}if("object"===R(e)){var i={};for(var a in e)e.hasOwnProperty(a)&&(i[a]=W(e[a],t,n));return i}return e}function U(e,t){return t?W(e,/\$RESOURCEDIR/g,t):e}function M(e,t){return t&&"."!==t?W(e,new RegExp(t,"g"),"$RESOURCEDIR"):e}function j(e,t,n){var r=[];if("string"==typeof e)e.startsWith(t)?r.push({resource:e,type:"full",path:n}):(r.push.apply(r,B(o()(B(e.matchAll(new RegExp("(')("+t+"[^']+)'","g"))),(function(e){return{resource:e[2],type:e[1],path:n}})))),r.push.apply(r,B(o()(B(e.matchAll(new RegExp('(")('+t+'[^"]+)"',"g"))),(function(e){return{resource:e[2],type:e[1],path:n}})))));else if(m().isArray(e))for(var i=0;i<e.length;++i)r.push.apply(r,B(j(e[i],t,n+"/"+i)));else if("object"===R(e))for(var a in e)e.hasOwnProperty(a)&&r.push.apply(r,B(j(e[a],t,n+"/"+a)));return r}function z(){var e=".";return window.WidgetResourceBase?window.WidgetResourceBase:(0===window.location.pathname.indexOf("/_ah/gcs/bookwidgets-eu--widgets/")?e=window.location.origin+"/_ah/gcs/bookwidgets-eu--widget-assets":window.location.host.startsWith("widgets-eu.")&&(e=window.location.host.replace("widgets-eu.","https://widget-assets-eu.")),e)}function V(e){return U(e,z())}function H(e){return M(e,z())}function q(e){if("."===z())return[];try{return j(e,z(),"")}catch(e){return console.error("Could not extract resources: ",e),[]}}function K(){return L}function J(){return P}(function(){var e=a(!1);e.dbg5&&n(34089)({apiKey:e.dbg5,autoCaptureSessions:!1,notifyReleaseStages:["production"],releaseStage:"production",beforeSend:function(e){return 1!==e.stacktrace.length||1!==e.stacktrace[0].lineNumber}});var t=i.Deferred();if(!1===d&&!1===c){c=!0;var r=g(e.content)||"config.js",o=g(e.design)||"config.css";i.when(s(r),l(o)).fail((function(){t.reject(new Error("Unable to load config file"))})).always((function(e,n){n&&i(n).attr("id","designconfig"),c=!1,d=!1;var r=window.widgetconfig;t.resolve(r),-1===navigator.userAgent.indexOf("ibookwidgets")&&(window.widgetconfig=void 0)}))}return t})().then((function(e){var t=function(e){return V(function e(t){if("string"==typeof t)return function(e){for(var t="",n=0;n<e.length;++n)2*n<e.length?t+=e.charAt(2*n):t+=e.charAt(2*(e.length-n)-1);return t}(t);if(m().isArray(t)){for(var n=[],r=0;r<t.length;++r)n.push(e(t[r]));return n}if("object"===R(t)){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[i]=e(t[i]));return o}return t}(e))}(e);for(var n in t)P[n]=t[n];(function(e){if(e.hasOwnProperty("LocalizationMap")&&(window.bwlocalizationmap=e.LocalizationMap),"bwshortcode"in e&&(window.bwshortcode=e.bwshortcode),"pre"in e&&(console.log("Preview"),"designinfo"in e)){for(var t=0;t<e.designinfo.length;++t)n=e.designinfo[t].s,r=e.designinfo[t].d,y.push([n,r]);"undefined"!=typeof previewsidebar?(console.log("Previewsidebar is defined, immediately set design config"),m()((function(){var e;e=function(){window.CssUpdateCounter&&(console.log("has CssUpdateCounter -> updating configCss"),window.updateConfigCSS(window.CssUpdateCounter)),setTimeout((function(){window.activateDesignInfoTooltips()}),3e3)},x.push(e)}))):(window.parent.postMessage({command:"enable-design-config-support"},"*"),window.addEventListener("beforeunload",(function(){window.parent.postMessage({command:"disable-design-config-support"})})))}var n,r;if("bra"in e&&m()((function(){"iPad"===navigator.platform&&-1!==navigator.userAgent.indexOf("BookWidgets")||m()(document.createElement("div")).addClass("branding").appendTo("body")})),"tri"in e&&m()((function(){if("iPad"===navigator.platform||-1===navigator.userAgent.indexOf("BookWidgets")&&-1===navigator.userAgent.indexOf("ibookwidgets")){m()(document.createElement("div")).addClass("dialog-sheet").attr("id","preview_alert").css({color:"red","text-shadow":"none"}).append(m()(document.createElement("p")).safeHtml("This is a free preview widget, created using a trial version of BookWidgets. <b>This widget may only be used for demonstration and evaluation purposes!</b>")).append(m()(document.createElement("p")).text("Please purchase a license key for the BookWidgets tool to remove this message.")).appendTo("body");var e=m()(document.createElement("div")).addClass("dialog-sheet-shadow");m()(document.body).append(e),window.CreateDialogSheetFor("#preview_alert"),setTimeout((function(){m()("#preview_alert").data("dialogSheet").show()}),2e3),setTimeout((function(){m()("#preview_alert").data("dialogSheet").hide()}),6e3),setTimeout((function(){m()("#preview_alert").data("dialogSheet").show()}),3e4),setTimeout((function(){m()("#preview_alert").data("dialogSheet").hide()}),34e3)}})),void 0===String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")}),window.getWidgetUrl=function(){return window.location.href},window.bwbackbuttonlabel=null,"performance"in window==0&&(window.performance={}),"now"in window.performance==0){var o=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(o=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-o}}e.hasOwnProperty("backbutton_label")&&""!==e.backbutton_label&&(window.bwbackbuttonlabel=e.backbutton_label),"Vertical"===e.widget_orientation?m()("html").addClass("vertical"):m()("html").addClass("horizontal"),null!=e.widget_language&&""!==e.widget_language&&m()("html").attr("lang",e.widget_language),setTimeout(I,0)})(P),L.resolve(P)}))},68500:function(e,t,n){"use strict";n.r(t);var r=n(76176),o=n(21506),i=n.n(o);window.addEventListener("message",(function(e){var t=e.data;"set-css"===t.command?(function(e){i()("style[id='designconfig'], link[id='designconfig']").remove();var t=document.createElement("style");t.id="designconfig",t.type="text/css",t.appendChild(document.createTextNode(e)),document.head.appendChild(t)}(t.css),r.executeCssUpdateCallbacks()):"show-css-config-elements"===t.command?window.activateDesignInfoTooltips(t.translations):"hide-css-config-elements"===t.command&&window.disableDesignInfoTooltips()}))},35048:function(e,t,n){"use strict";n.r(t),n.d(t,{navigateAlert:function(){return u},showAlert:function(){return a},showConfirmationDialog:function(){return s},showCriticalAlert:function(){return l},showFatalAlert:function(){return c},showInfoMessage:function(){return d}});var r=n(72779),o=n(35226),i=n(21506);function a(e,t,n,r,a){a=a||a+" custom_alert",n=n||o("Ok"),t=t||"Alert",e=e||"No Message to Display";var u=i(document.createElement("div")),s={};return s[n]=function(){i(this).dialog("close"),i(this).remove(),r&&r()},u.safeHtml(e).dialog({title:t,dialogClass:"bw-dialog no-close "+a,resizable:!1,modal:!0,width:"auto",buttons:s}),u}function u(e,t,n,r){var o=a(e,t,n,(function(){}));return o.parent().find("button").replaceWith(i(document.createElement("a")).safeHtml(n).attr({href:r,target:"_top"}).addClass("ui-button")),o}function s(e,t,n,o,a,u,s){t||(t="Please confirm"),e||(e=""),a||(a="OK"),u||(u="Cancel"),i("#BwConfirmationDalog").remove();var l=i(document.createElement("div")).attr("id","BwConfirmationDialog"),c={};return c[a]=function(){i(this).dialog("close"),i(this).remove(),n&&n()},c[u]=function(){i(this).dialog("close"),i(this).remove(),o&&o()},l.safeHtml(e).dialog({title:t,dialogClass:r("bw-dialog BwConfirmationDialog no-close",s&&"bw-confirmation-warning"),open:function(){i(this).parent().find(".ui-dialog-buttonpane button:eq(1)").focus()},resizable:!1,modal:!0,width:500,buttons:c}),l}function l(e,t){var n={message:e,title:t};0===i("#critical-alert-button").length&&i(document.createElement("div")).attr("id","critical-alert-button").addClass("bw-toolbutton").append(i(document.createElement("div")).addClass("bw-icon bw-icon-critical-error")).prependTo(i("#title-toolbar")).click(a),a(n.message,n.title)}function c(e,t){i(document.createElement("div")).safeHtml(e).dialog({title:t,dialogClass:"bw-dialog no-close",resizable:!1,modal:!0,width:"auto"})}function d(e){console.log("ShowInfoMessage");var t=i(document.createElement("div"));function n(){t.removeClass("bw-dialog-animate-in").addClass("bw-dialog-animate-out"),setTimeout((function(){t.remove()}),500)}t.safeHtml(e).addClass("bw-dialog bw-info-dialog bw-dialog-animate-in").click((function(e){e.stopPropagation(),n()})).appendTo(i("body")),setTimeout(n,1e4)}},93189:function(e,t,n){var r,o,i;e.exports=(r=n(21506),o=n(74719),i=n(58436),{bwMakeDragAndResizable:function(e,t,n,a,u){var s=-1!==i.getPlatform().indexOf("ibooks"),l=new o.Manager(e.get(0));l.add(new o.Pan({threshold:0,pointers:0})),s||l.add(new o.Pinch({threshold:0})).recognizeWith([l.get("pan")]);var c=null;function d(t){null===c&&(c={pos:e.offset(),width:e.width(),height:e.height(),center:{x:e.offset().left,y:e.offset().top}}),t&&!c.hasOwnProperty("last_rotation")&&(c.center=t.center)}function f(t){var n=t.scale;e.offset({top:c.pos.top+t.deltaY+(c.center.y-c.pos.top)*(1-n),left:c.pos.left+t.deltaX+(c.center.x-c.pos.left)*(1-n)}),s||(e.width(c.width*n),e.height(c.height*n))}function p(t){var n=e.width(),o=e.height(),i=e.position(),a=r(window).width(),s=r(window).height();e.width(n*t),e.height(o*t),e.css("left",(i.left-a/2)*t+a/2),e.css("top",(i.top-s/2)*t+s/2),u&&u()}l.on("hammer.input",(function(e){e.isFinal&&(c=null)})),l.on("panstart panmove",(function(e){"panstart"===e.type?d():(f(e),a&&a())})),s||(l.on("pinchstart pinchmove",(function(e){"pinchstart"===e.type?d(e):(f(e),u&&u())})),l.on("pinchend pinchcancel",(function(){c&&(c=null,d())}))),t.tapOrClick((function(){p(1.25)})),n.tapOrClick((function(){p(.8)}))}})},72324:function(e,t,n){"use strict";n.d(t,{processEmbeddedIframes:function(){return u}});var r=n(92824),o=n(21506),i=n.n(o);function a(e){e.attr("src").toLowerCase().endsWith("mp4")?function(e){e.replaceWith(r.createHtml5VideoPlayer(e.attr("src")))}(e):(function(e){var t=["allow-downloads","allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-popups-to-escape-sandbox","allow-same-origin","allow-scripts","allow-top-navigation-by-user-activation"];null!=document.hasStorageAccess&&t.push("allow-storage-access-by-user-activation");try{e.attr({allow:"microphone; camera",sandbox:t.join(" "),allowfullscreen:""})}catch(e){console.log()}}(e),e.attr("src",e.attr("src")))}function u(e){e.each((function(){a(i()(this))}))}n(44166)},25081:function(e,t,n){"use strict";n.r(t),n.d(t,{calculateScaleAndOffset:function(){return u},getImageSize:function(){return i},processRichTextImages:function(){return a}});var r=n(21506),o=n.n(r);function i(e,t){var n=new window.Image;n.onload=function(){var e=this.width,n=this.height;t(e,n)},n.onerror=function(){t()},n.src=e}function a(e){e.find("img").attr({height:"",draggable:"false"}).css("max-width","100%").each((function(){var e=o()(this),t=e.css("float");"left"===t?e.css({"margin-right":"10px","margin-bottom":"10px"}):"right"===t&&e.css({"margin-left":"10px","margin-bottom":"10px"})}))}function u(e,t,n,r,o){var i,a,u,s,l,c;return"Cover entire area, keep aspect ratio"===e?((l=t/r)<(c=n/o)?(i=c,a=c):(i=l,a=l),u=(t-r*i)/2,s=(n-o*a)/2):"Contain entire picture, keep aspect ratio"===e?((l=t/r)>(c=n/o)?(i=c,a=c):(i=l,a=l),u=(t-r*i)/2,s=(n-o*a)/2):"Cover entire area with entire picture"===e?(u=0,s=0,i=t/r,a=n/o):(i=1,a=1,u=(t-r)/2,s=(n-o)/2),{scale_x:i,scale_y:a,offset_x:u,offset_y:s}}},45127:function(e,t,n){"use strict";n.r(t),n.d(t,{adaptWidgetLoadPath:function(){return u},loadCSS:function(){return l},loadJS:function(){return s}});var r=n(21506),o=n.n(r),i=n(58436);function a(e){if(window.WidgetParams){if(e&&window.WidgetParams.externalRootURL)return window.WidgetParams.externalRootURL;if(window.WidgetParams.rootURL)return window.WidgetParams.rootURL}return(0,i.isWebPreview)()||window.location.protocol.startsWith("http")&&null!=window.bwshortcode?window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/",window.location.pathname.lastIndexOf("/")-1)):window.location.protocol.startsWith("http")&&null==window.bwshortcode?window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")):""}function u(e,t){return e.startsWith("../")?a(t)+e.substring(2):e.startsWith("http://")||e.startsWith("https://")?e:window.WidgetParams&&window.WidgetParams.rootURL?a(t)+"/"+e:e}function s(e,t,n){e=u(e);var r=o().Deferred(),i=document.createElement("script");if(i.setAttribute("type","text/javascript"),n)for(var a in n)n.hasOwnProperty(a)&&i.setAttribute(a,n[a]);return i.onload=function(){r.resolve()},i.onerror=function(){window.navigator&&window.navigator.userAgent&&-1===window.navigator.userAgent.indexOf("PhantomJS")&&-1===window.navigator.userAgent.indexOf("HeadlessChrome")&&console.error("Could not load: "+e),r.reject()},i.setAttribute("src",e),document.getElementsByTagName(t||"head")[0].appendChild(i),r}function l(e,t){e=u(e);var n=o().Deferred(),r=document.createElement("link");return r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.onload=function(){n.resolve(r)},r.onerror=function(){window.navigator&&window.navigator.userAgent&&-1===window.navigator.userAgent.indexOf("PhantomJS")&&-1===window.navigator.userAgent.indexOf("HeadlessChrome")&&console.error("Could not load: "+e),n.reject()},r.setAttribute("href",e),document.getElementsByTagName(t||"head")[0].appendChild(r),n}window.adaptWidgetLoadPath=u},24021:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r){r=Object(r);for(var o=Object.keys(Object(r)),i=0,a=o.length;i<a;i++){var u=o[i],s=Object.getOwnPropertyDescriptor(r,u);void 0!==s&&s.enumerable&&(t[u]=r[u])}}}return t}})},58436:function(e,t,n){"use strict";n.r(t),n.d(t,{getIOSIBooksRestartInfo:function(){return h},getPlatform:function(){return i},inIframe:function(){return m},isAndroidIosDevice:function(){return s},isIOS:function(){return p},isInternetExplorer:function(){return g},isPreview:function(){return c},isToolPreview:function(){return a},isTopLevelPlay:function(){return d},isTouchDevice:function(){return f},isWebPreview:function(){return u},supportsAppFeature:function(){return l}});var r=n(90985);function o(){var e=window.navigator.userAgent,t=e.indexOf("OS ");return(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&t>-1?window.Number(e.substr(t+3,3).replace("_",".")):0}function i(){return window.BW_PLATFORM_HACK?window.BW_PLATFORM_HACK:"iPad"===navigator.platform||"iPhone"===navigator.platform?void 0!==navigator.epubReadingSystem&&"iBooks"===navigator.epubReadingSystem.name?"ibw-platform-ipad-ibooks-epub":-1!==navigator.userAgent.indexOf("SEB")?"ibw-platform-ipad-seb":-1!==navigator.userAgent.indexOf("Safari")?"ibw-platform-ipad-safari":-1!==navigator.userAgent.indexOf("BookWidgets")?"ibw-platform-ipad-bookwidgets":"http:"!==window.location.protocol&&"https:"!==window.location.protocol?"ibw-platform-ipad-other":"ibw-platform-ipad":"MacIntel"===navigator.platform?void 0!==navigator.epubReadingSystem&&"iBooks"===navigator.epubReadingSystem.name?"ibw-platform-osx-ibooks-epub":-1!==navigator.userAgent.indexOf("PhantomJS")?"ibw-platform-osx-phantomjs":-1!==navigator.userAgent.indexOf("HeadlessChrome")?"ibw-platform-osx-headlesschrome":-1!==navigator.userAgent.indexOf("ibookwidgets")?"ibw-platform-osx-preview":-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-osx-chrome":-1!==navigator.userAgent.indexOf("Safari")?"ibw-platform-osx-safari":-1!==navigator.userAgent.indexOf("Firefox")?"ibw-platform-osx-firefox":"http:"!==window.location.protocol&&"https:"!==window.location.protocol?"ibw-platform-osx-other":"ibw-platform-osx":"Win32"===navigator.platform?-1!==navigator.userAgent.indexOf("BookWidgets")?"ibw-platform-win32-preview":"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&-1!==navigator.userAgent.indexOf("Trident")||"Netscape"===navigator.appName&&-1!==navigator.userAgent.indexOf("Edge")?"ibw-platform-win32-ie":-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-win32-chrome":-1!==navigator.userAgent.indexOf("Firefox")?"ibw-platform-win32-firefox":"ibw-platform-win32":"iPad Simulator"===navigator.platform||"iPhone Simulator"===navigator.platform?"ibw-platform-ipad-bookwidgets":-1!==navigator.userAgent.indexOf("Android")?-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-android-chrome":"ibw-platform-android":-1!==navigator.userAgent.indexOf("CrOS")?-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-chromebook-chrome":"ibw-platform-chromebook":"ibw-platform-unknown"}function a(){return-1!==i().indexOf("preview")}function u(){return"1"===(0,r.getUrlParams)(window.location.href).preview||window.WidgetParams&&window.WidgetParams.preview}function s(){var e=i();return 0===e.indexOf("ibw-platform-ipad")||0===e.indexOf("ibw-platform-android")}function l(e){var t=/BookWidgets\/([0-9]+)\.([0-9]+)\.([0-9]+)/g.exec(navigator.userAgent),n=t&&4===t.length?1e4*parseInt(t[1])+100*parseInt(t[2])+parseInt(t[3]):0;return console.log(e+" "+n),"audiorecording"===e&&n>=20800}function c(){return a()||u()}function d(){return"1"===(0,r.getUrlParams)(window.location.href).toplevel}function f(){return s()||(t=" -webkit- -moz- -o- -ms- ".split(" "),"ontouchstart"in window||(e=["(",t.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(e).matches));var e,t}function p(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)}function g(){return-1!==window.navigator.userAgent.indexOf("MSIE ")||/rv:11.0/i.test(window.navigator.userAgent)}function h(){return o()>=7?'To close iBooks:<ol style="text-align: left;"><li>Double-click the Home button.</li><li>Swipe left or right until you have located iBooks.</li><li>Swipe the app\'s preview up to close it.</li></ol>':o()>=5?"To close iBooks:<ol style=\"text-align: left;\"><li>Double-click the Home button.</li><li>Touch-and-hold the iBooks icon to put it into 'jiggly mode'.</li><li>Tap the red minus-sign icon that appears at the top left corner of iBooks.</li><li>Click the Home button to exit 'jiggly mode'.</li></ol>":""}function m(){try{return window.self!==window.parent}catch(e){return!0}}},88235:function(e,t,n){"use strict";n.r(t),n.d(t,{positionPointerPopup:function(){return i}});var r=n(21506),o=n.n(r);function i(e,t,n,r,i,a,u){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"right",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0;l=l||t,t.css({left:"0px",top:"0px"}).addClass("almostvisible"),l.find(".triangle").remove();var c=n.centerx,d=n.centery,f=t.outerWidth(),p=t.outerHeight();t.removeClass("almostvisible");var g=25,h=25/Math.sqrt(2),m=r+n.x>f+e+g,v=a-n.x-n.width-r>f+e+g,b=i+n.y>p+e+g,w=u-n.y-n.height-i>p+e+g;function y(){d<p/2+e&&(d=p/2+e),u-d<p/2+e&&(d=u-p/2-e)}function D(){return Math.min(Math.max(-2,p/2-h-(t.outerHeight()-t.height())/2+n.centery-d),t.outerHeight()-50-2)}function E(){c<f/2+e&&(c=f/2+e),a-c<f/2+e&&(c=a-f/2-e)}function C(){return Math.min(Math.max(-2,f/2-h-(t.outerWidth()-t.width())/2+n.centerx-c),t.outerWidth()-50-2)}var A=null,S=null;if("center"!==s){var _=0;switch(s){case"right":_=0;break;case"left":_=1;break;case"bottom":_=2;break;case"top":_=3}for(var k=0;k<4;++k){var O=(k+_)%4;if(0===O&&v){y(),S="lefttriangle",A={left:-50,top:D()},c+=f/2+n.width/2+g;break}if(1===O&&m){y(),S="righttriangle",A={left:f-2*parseInt(t.css("border-right-width")),top:D()},c-=f/2+n.width/2+g;break}if(2===O&&w){E(),S="toptriangle",A={left:C(),top:-50},d+=p/2+n.height/2+g;break}if(3===O&&b){E(),S="bottomtriangle",A={left:C(),top:p-2*parseInt(t.css("border-top-width"))},d-=p/2+n.height/2+g;break}}}var x=Math.min(Math.max(0,c-f/2),a-f),F=Math.min(Math.max(0,d-p/2),u-p);if(t.css({left:x+"px",top:F+"px"}),t.removeClass("hidden"),A){var T=t.offset(),I=l.offset();A.left+=T.left-I.left,A.top+=T.top-I.top,o()(document.createElement("div")).addClass("triangle "+S).appendTo(l).css(A)}}},99290:function(e,t,n){"use strict";n.r(t),n(78793),n(30017),n(32009),n(98728),n(87189),n(27708),n(24021),n(78881),n(9716),void 0===n.g&&(window.global=window)},70882:function(e,t,n){"use strict";n.r(t),n.d(t,{setPreparePrint:function(){return c}});var r=n(58436);function o(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function i(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var a=i((function(){return function(e){if(e&&e.then)return e.then(l)}(function(e,t){try{var n=s(u,(function(){window.print()}))}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(0,l))})),u=function(){return o(!0)};function s(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}function l(){}function c(e){u=e}window.addEventListener("message",i((function(e){return"print"===e.data.command&&a(),o()}))),(0,r.isToolPreview)()&&(window.doPrint=function(){return s(u,(function(){window.clientApp&&window.clientApp.doPrint&&window.clientApp.doPrint()}))})},5733:function(e,t,n){"use strict";n.r(t),n.d(t,{isEmptyRichText:function(){return d},process:function(){return c}});var r=n(25081),o=n(56577),i=n(21506),a=n.n(i),u=n(72324),s=n(92824),l=n(44166);function c(e){e.addClass("bw-richtext"),r.processRichTextImages(e),function(e){e.find("a.rtlink").each((function(){var e=a()(this);e.find("span").css({"text-decoration":"",color:""});var t=e.attr("target");!1!==t&&void 0!==t||e.attr("target","_top")}))}(e),(0,o.processRichTextWidgetPlayLinks)(e,!0),function(e){e.find("video").each((function(){(0,s.adjustRichTextVideoSize)(a()(this))}))}(e),function(e){e.find(".iframeplaceholder").each((function(){var e=a()(this),t=e.attr("src");e.replaceWith(a()(document.createElement("iframe")).addClass("rt-iframe").attr("src",t))}))}(e),(0,u.processEmbeddedIframes)(e.find(".rt-iframe")),function(e){e.find("table").addClass("bw-richtext-table").each((function(){var e=this.parentNode,t=document.createElement("div");t.style.overflowX="scroll",e.insertBefore(t,this),t.appendChild(this)}))}(e)}function d(e){return null==e||""===e.trim()||-1===e.indexOf("img")&&-1===e.indexOf("audio")&&-1===e.indexOf("iframe")&&-1===e.indexOf("video")&&-1===e.indexOf("src=")&&""===(0,l.appSafeUnescape)(e).trim()}},74719:function(e){e.exports=window.Hammer},28524:function(e){e.exports=window.$},51177:function(e,t,n){var r,o,i,a;e.exports=(r=n(69238),o=n(63347).Z,i=n(22927),a=i.createLogger("AsyncKeyStoreToBWDSAdapter"),function(e){var t={};function n(e,n){t.queue.executeSequential((function(t){try{e(t)}catch(e){console.error("AsyncBWDS: Uncaught error: "+e),r.handleException(e,n,t)}}))}return t.async=e,t.queue=r.newCallbackQueue(),t.readNoSync=function(e,n,r){a.debug("readNoSync "+e),t.async.getItemsAsync([e],(function(r){if(r.hasOwnProperty(e)){var o=JSON.parse(r[e].attribs);!1===o.removed?n(r[e].value,t.fileStat(e,o)):n(null,t.fileStat(e,o))}else n(null,null)}),(function(e){r(e)}))},t.read=function(e,i){n((function(n){t.readNoSync(e,(function(e,t){null==e?r.callSafe(i,r.error(o.BWDS_ERROR_UNKNOWN,"AsyncBWDS Error: no such file"),null,t):r.callSafe(i,null,e,t),n()}),(function(e){r.handleException(e,i,n)}))}),i)},t.writeNoSync=function(e,n,o,i){a.debug("writeNoSync "+e+" "+n);var u=null==n?0:n.length;t.async.getItemsAsync([e],(function(a){var s,l=r.getDateTime();a.hasOwnProperty(e)?((s=JSON.parse(a[e].attribs)).updated_at=l,s.filesize=u,s.isdir=null==n,s.removed=!1,s.version=s.version+1,s.offline=!1):s={created_at:l,updated_at:l,filesize:u,isdir:null==n,removed:!1,version:1,backup_version:0,backup_date:null,offline:!1},t.async.setItemsAsync([{key:e,value:null==n?"":n,attribs:JSON.stringify(s)}],(function(n){if(""!=e){var r=e.lastIndexOf("/"),a="";-1!=r&&(a=e.substring(0,r)),t.writeNoSync(a,null,o,i)}else o(t.fileStat(e,s))}),(function(e){i(e)}))}),(function(e){i(e)}))},t.write=function(e,o,i){n((function(n){t.writeNoSync(e,null==o?"":o,(function(e){r.callSafe(i,null,e),n()}),(function(e){r.handleException(e,i,n)}))}),i)},t.removeFiles=function(e,n,o){if(0==e.length)null!=n&&n();else{var i=e.shift(),u=i.attribs,s=r.getDateTime();u.removed=!0,u.offline=!1,u.updated_at=s,t.async.setItemsAsync([{key:i.name,value:"",attribs:JSON.stringify(u)}],(function(){t.removeFiles(e,(function(){n(u)}),o)}),(function(){a.error("removeFiles, could not write new file attribs to clear, removing including attribs"),t.async.removeItemsAsync([i.name],(function(){t.removeFiles(e,(function(){n(u)}),o)}),o)}))}},t.removeRecurse=function(e,n,r){if(0==e.length)null!=n&&n();else{var o=e.shift();t.async.getDirAttribs(o,(function(o){var i=[];for(var a in o){var u=JSON.parse(o[a]);!1===u.removed&&(!0===u.isdir&&e.push(a),i.push({name:a,attribs:u}))}t.removeFiles(i,(function(){t.removeRecurse(e,n,r)}),r)}),r)}},t.removeNoSync=function(e,n,i){a.debug("removeNoSync "+e),""==e?t.removeRecurse([e],n,(function(e){r.handleException(e,i)})):t.async.getItemsAsync([e],(function(a){if(a.hasOwnProperty(e)){var u=JSON.parse(a[e].attribs);!1===u.removed?u.isdir?t.removeFiles([{name:e,attribs:u}],(function(){t.removeRecurse([e],n,(function(e){r.handleException(e,i)}))}),(function(e){r.handleException(e,i)})):t.removeFiles([{name:e,attribs:u}],(function(r){n(t.fileStat(e,r))}),(function(e){r.handleException(e,i)})):i(r.error(o.BWDS_ERROR_UNKNOWN,"AsyncBWDS Error: no such file"))}else i(r.error(o.BWDS_ERROR_UNKNOWN,"AsyncBWDS Error: no such file"))}),(function(e){r.handleException(e,i)}))},t.remove=function(e,o){n((function(n){t.removeNoSync(e,(function(){r.callSafe(o,null),n()}),(function(e){r.callSafe(o,e),n()}))}),o)},t.dirNoSync=function(e,n,o){a.debug("dirNoSync "+e),t.async.getDirAttribs(e,(function(t){var o=[];for(var i in t)!1===JSON.parse(t[i]).removed&&""!=i&&o.push(r.trimLeadingSlash(i.substr(e.length)));o.length>0?n(o):n(null)}),(function(e){o(e)}))},t.dir=function(e,i){n((function(n){t.dirNoSync(e,(function(t){null!==t?r.callSafe(i,null,t):""===e?r.callSafe(i,null,[]):r.callSafe(i,r.error(o.BWDS_ERROR_UNKNOWN,"AsyncBWDS Error: no such file")),n()}),(function(e){r.handleException(e,i,n)}))}),i)},t.fileStat=function(e,t){return{name:e,size:t.filesize,created:t.created_at,modified:t.updated_at,isdir:t.isdir,removed:t.removed,version:t.version,backup_version:t.backup_version,backup_date:t.hasOwnProperty("backup_date")?t.backup_date:null,offline:!!t.hasOwnProperty("offline")&&t.offline}},t.dirStat=function(e,n,r,o){a.debug("dirNoSync "+e),t.async.getDirAttribs(e,(function(e){var o=[];for(var i in e)""!==i&&o.push(t.fileStat(i,JSON.parse(e[i])));r(n,o)}),(function(e){o(e)}))},t.statNoSync=function(e,n,r){a.debug("statNoSync "+e),t.async.getItemsAsync([e],(function(o){if(o.hasOwnProperty(e)){var i=JSON.parse(o[e].attribs),a=t.fileStat(e,i);i.isdir?t.dirStat(e,a,n,r):n(a)}else n(null)}),(function(e){r(e)}))},t.stat=function(e,i){n((function(n){t.statNoSync(e,(function(e,t){null!==e?void 0===t?r.callSafe(i,null,e):r.callSafe(i,null,e,t):r.callSafe(i,r.error(o.BWDS_ERROR_UNKNOWN,"AsyncBWDS Error: no such file")),n()}),(function(e){r.handleException(e,i,n)}))}),i)},t.setStatNoSync=function(e,n,i,u){a.debug("setStatNoSync "+e),t.async.getItemsAsync([e],(function(a){if(a.hasOwnProperty(e)){var s=JSON.parse(a[e].attribs);for(var l in n)if("backup_date"==l)s.backup_date=n.backup_date;else{if("backup_version"!=l)return void u(r.error(o.BWDS_ERROR_WRONG_ATTRIB,"KeyStoreBWDS Error: Can't set attribute "+l));s.backup_version=n.backup_version}t.async.setItemsAsync([{key:e,value:a[e].value,attribs:JSON.stringify(s)}],(function(n){i(t.fileStat(e,s))}),(function(e){r.handleException(e,u)}))}else u(r.error(o.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"))}),(function(e){u(e)}))},t.setStat=function(e,o,i){n((function(n){t.setStatNoSync(e,o,(function(e){r.callSafe(i,null,e),n()}),(function(e){r.callSafe(i,e),n()}))}),i)},t.executeSync=function(e,n){t.queue.executeSequential(e,n)},t.removeAll=function(e){var n=[""],r=[],o=null;!function i(){if(r.length>0){var a=r.shift();t.removeNoSync(a,(function(){i()}),(function(){console.log("Could not remove ",a),o="Could not remove file",i()}))}else if(0!==n.length){var u=n.shift();t.dirStat(u,null,(function(e,t){for(var o=0;o<t.length;++o){var a=t[o];a.removed||(a.isdir?n.push(a.name):r.push(a.name))}i()}),(function(){console.log("Error getting stat for ",u),o="Error removing files",i()}))}else e(o)}()},t.clearAll=function(e){a.debug("clearAll"),t.async.clearAllAsync?t.async.clearAllAsync((function(){a.debug("AsyncBWDS.clearAll OK callback"),r.callSafe(e)}),(function(t){r.handleException(t,e)})):t.removeAll(e)},t})},63347:function(e,t,n){"use strict";n.d(t,{B:function(){return r}});var r={BWDS_ERROR_INTERNAL:0,BWDS_ERROR_UNKNOWN:1,BWDS_ERROR_UNAVAILABLE:2,BWDS_ERROR_WRONG_ATTRIB:3,BWDS_ERROR_FULL:4,BWDS_ERROR_SECURITY:5};t.Z=r},99065:function(e,t,n){var r,o,i,a=n(76635).each,u=n(34169);e.exports=(r=n(22927),o=r.createLogger("IndexedDBAsyncKeyStore"),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;this.idbstore=t},i.prototype.getItemsAsync=function(e,t,n){var r=this;if(o.debug("IndexedDBAsyncKeyStore getItemsAsync"),0===e.length)return o.debug("IndexedDB Error: getItemsAsync without names"),void n({code:9999,message:"IndexedDB Error: getItemsAsync without names"});var i={};function a(e){var t=this;return o.debug("readelem ",e),new Promise((function(n,r){t.idbstore.get(e).then((function(t){o.debug("read elem: "+e),null!=t&&(i[e]=t),n()}),(function(t){o.debug("error accessing elem: "+e),r(t)})).catch((function(e){o.error("Caught idb exception",e),r(e)}))}))}e.reduce((function(e,t){return e.then((function(){return a.bind(r,t)()}))}),Promise.resolve()).then((function(){t(i)}),n)},i.prototype.getDirAttribs=function(e,t,n){o.debug("IndexedDBAsyncKeyStore getDirAttribs"),this.idbstore.direlems(e).then((function(e){var n={};a(e,(function(e){n[e.keyname]=e.attribs})),t(n)}),n)},i.prototype.setItemsAsync=function(e,t,n){if(o.debug("IndexedDBAsyncKeyStore setItemsAsync"),0===e.length)return o.error("IndexedDB Error: setItemsAsync without names"),void n({code:9999,message:"setItemsAsync without names"});if(e.length>1)return o.error("IndexedDB Error: setItemsAsync can only handle 1 item"),void n({code:9999,message:"setItemsAsync can only handle 1 item"});var r,i,a=e[0];this.idbstore.set(a.key,{keyname:a.key,value:a.value,attribs:a.attribs,dir:(r=a.key,i=r.lastIndexOf("/"),-1!=i?r.substring(0,i):"")}).then((function(){t()}),n).catch(n)},i.prototype.removeItemsAsync=function(e,t,n){var r=this;if(o.debug("IndexedDBAsyncKeyStore removeItemsAsync"),0===e.length)return o.debug("IndexedDB Error: removeItemsAsync without names"),void n({code:9999,message:"IndexedDB Error: removeItemsAsync without names"});e.reduce((function(e,t){return e.then((function(){return r.idbstore.del(t)}))}),Promise.resolve()).then((function(){t()}),n)},i.prototype.clearAllAsync=function(e,t){o.debug("IndexedDBAsyncKeyStore clearAllAsync"),this.idbstore.clear().then(e,t)},i)},80322:function(e,t,n){var r,o,i,a,u=n(25265);e.exports=(r=n(87171),o=n(22927),i=o.createLogger("NativeSQLAsyncKeyStore"),(a=new r).startListening(),function(e){e=e||function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),t.setAttribute("height","1px"),t.setAttribute("width","1px"),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null};var t={};function n(e){var t=String.fromCharCode(29);return(e=e.map((function(e){return e.replace(new RegExp(",","g"),t)}))).join()}return t.resultForCallback=function(e,t){a.processCallback(e,t)},t.runningInIframe=function(){try{return window.self!==window.parent}catch(e){return!0}},t.callObjC=function(n,r,o,i){var s=u.url(n,r),l=a.registerCallbacks(o,i),c="'"+l.ok+"'",d="'"+l.error+"'",f="window.BWKSNativeSQL.resultForCallback";t.runningInIframe()&&(f="function BWKSNativeSQL_callback_wrapper(callbackID, arg) { window.postMessage({ 'command': callbackID, 'arg': arg, 'to': '_widget' }, '*'); }; BWKSNativeSQL_callback_wrapper"),e(s+"&okCallbackId="+c+"&errorCallbackId="+d+"&callbackFunc="+f)},t.getItemsAsync=function(e,r,o){if(0==e.length)return i.error("NativeSQL Error: getItemsAsync without names"),void o({message:"NativeSQL Error: getItemsAsync without names"});t.callObjC("getItemsAsync",{names:n(e)},r,o)},t.getDirAttribs=function(e,n,r){t.callObjC("getDirAttribsAsync",{dirname:e},n,r)},t.setItemsAsync=function(e,n,r){if(0==e.length)return i.error("NativeSQL Error: setItemsAsync without names"),void r({message:"setItemsAsync without names"});if(e.length>1)return i.error("NativeSQL Error: setItemsAsync can only handle 1 item"),void r({message:"setItemsAsync can only handle 1 item"});var o=e[0];t.callObjC("setItemAsync",{keyname:o.key,value:o.value,attribs:o.attribs},n,r)},t.removeItemsAsync=function(e,r,o){if(0==e.length)return i.error("NativeSQL Error: removeItemsAsync without names"),void o({message:"NativeSQL Error: removeItemsAsync without names"});t.callObjC("removeItemsAsync",{names:n(e)},r,o)},t})},35613:function(e,t,n){e.exports=function(e,t,n){var r=n.createLogger("SyncKeyStoreToBWDSAdapter");function o(t,n){try{t()}catch(t){r.error("Uncaught error: "+t),e.handleException(t,n)}}return function(n){var i={};function a(n,r,o){return!1!==i.keystore.setItem(n,r)||(e.callSafe(o,e.error(t.BWDS_ERROR_FULL,"KeyStoreBWDS error: storage full"),null),!1)}return i.keystore=n,i.write=function(t,n,u){o((function(){r.debug("write "+t);var o,s,l=n.length,c=t.lastIndexOf(".");if(-1==c?(o=t,s=""):(o=t.substr(0,c),s=t.substr(c+1)),a(o,n,u))if(""!=o){var d,f=o.lastIndexOf("/"),p="";-1!=f&&(p=o.substring(0,f)),d=o.substring(f);var g,h=i.keystore.getItem(p),m=e.getDateTime();null===h?(g={})[d]={type:s,created_at:m,updated_at:m,filesize:l,removed:!1,version:1,backup_version:0,backup_date:null,offline:!1}:(g=JSON.parse(h))[d]?(g[d].type=s,g[d].updated_at=m,g[d].filesize=l,g[d].version=g[d].hasOwnProperty("version")?g[d].version+1:2,g[d].removed=!1,g[d].offline=!1):g[d]={type:s,created_at:m,updated_at:m,filesize:l,removed:!1,version:1,backup_version:0,backup_date:null,offline:!1};var v=i.fileStat(p,d,g[d]);i.write(p+".dir",JSON.stringify(g),(function(t){e.callSafe(u,t,v)}))}else e.callSafe(u,null,null)}),u)},i.read=function(n,a){o((function(){var o,u;r.debug("read "+n);var s=n.lastIndexOf(".");-1==s?(o=n,u=""):(o=n.substr(0,s),u=n.substr(s+1));var l,c=o.lastIndexOf("/"),d="";-1!=c&&(d=o.substring(0,c)),l=o.substring(c);var f=i.keystore.getItem(d);if(null!==f){var p=JSON.parse(f);if(p[l])if(u&&p[l].type!=u)e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"),null,null);else if(!0===p[l].removed)e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"BWKDLocal Error: removed file"),null,i.fileStat(d,l,p[l]));else{var g=i.keystore.getItem(o);e.callSafe(a,null,g,i.fileStat(d,l,p[l]))}else e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"BWKDLocal Error: unknown file"),null,null)}else e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"),null,null)}),a)},i.clearDir=function(e){var t=i.keystore.getItem(e);if(null!=t){var n=JSON.parse(t);for(var o in n)"dir"==n[o].type&&""!=o&&i.clearDir(e+o),r.debug("Clearing: "+e+o),i.keystore.removeItem(e+o);i.keystore.removeItem(e)}},i.clear=function(t,n){o((function(){if(r.debug("clear "+t),t)throw Error("clear(): Unexpected parameter");i.clearDir(""),e.callSafe(n,null)}),n)},i.removeDir=function(t,n){r.debug("removeDir("+t+")");var o=i.keystore.getItem(t);if(null!=o){var u=JSON.parse(o),s=e.getDateTime();for(var l in u){var c=u[l];!1===c.removed&&("dir"===c.type?""!==l&&i.removeDir(t+l,n):(r.debug("Clearing: "+t+l),i.keystore.removeItem(t+l)),u[l].version=u[l].hasOwnProperty("version")?u[l].version+1:2,u[l].removed=!0,u[l].updated_at=s)}if(!a(t,JSON.stringify(u),n))return}},i.remove=function(n,a){o((function(){if(r.debug("remove "+n),""==n||null==n||null==n)return i.removeDir("",a),void e.callSafe(a,null);var o,u,s=n.lastIndexOf("."),l=(o=-1==s?n:n.substr(0,s)).lastIndexOf("/"),c="";-1!=l&&(c=o.substring(0,l)),u=o.substring(l);var d=i.keystore.getItem(c);if(null!==d){var f=JSON.parse(d);if(!f[u])return r.error("unknown file"),void e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"));"dir"==f[u].type?i.removeDir(n,a):i.keystore.removeItem(o),f[u].removed=!0,f[u].version=f[u].hasOwnProperty("version")?f[u].version+1:2;var p=e.getDateTime();f[u].updated_at=p;var g=i.fileStat(c,u,f[u]);i.write(c+".dir",JSON.stringify(f),(function(t){e.callSafe(a,t,g)}))}else e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"))}),a)},i.dir=function(n,a){o((function(){var o,u;if(r.debug("dir "+n),""!=n){var s,l=n.lastIndexOf("/"),c="";if(-1!=l&&(c=n.substring(0,l)),s=n.substring(l),null===(o=i.keystore.getItem(c)))return void e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown directory"));if(!1===(u=JSON.parse(o)).hasOwnProperty(s)||"dir"!==u[s].type)return void e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown directory"))}o=i.keystore.getItem(n),u=JSON.parse(o);var d=[];for(var f in u)!0!==u[f].removed&&d.push(e.trimLeadingSlash(f)+("dir"==u[f].type?"":"."+u[f].type));e.callSafe(a,null,d)}),a)},i.fileStat=function(e,t,n){return{name:e+t+("dir"==n.type?"":"."+n.type),size:n.hasOwnProperty("filesize")?n.filesize:null==i.keystore.getItem(e+t)?0:i.keystore.getItem(e+t).length,created:n.created_at,modified:n.updated_at,isdir:"dir"==n.type,removed:n.hasOwnProperty("removed")&&!0===n.removed,version:n.version,backup_version:n.backup_version,backup_date:n.hasOwnProperty("backup_date")?n.backup_date:null,offline:!!n.hasOwnProperty("offline")&&n.offline}},i.dirStat=function(t,n,r){var o=i.keystore.getItem(t),a=JSON.parse(o),u=[];for(var s in a)u.push(i.fileStat(t,s,a[s]));e.callSafe(n,null,r,u)},i.stat=function(n,a){o((function(){if(r.debug("stat "+n),""!=n){var o,u,s=n.lastIndexOf("."),l=(o=-1==s?n:n.substr(0,s)).lastIndexOf("/"),c="";-1!=l&&(c=o.substring(0,l)),u=o.substring(l);var d=i.keystore.getItem(c);if(null!==d&&""!==d){var f=JSON.parse(d);if(f[u])return"dir"==f[u].type?void i.dirStat(n,a,i.fileStat(c,u,f[u])):void e.callSafe(a,null,i.fileStat(c,u,f[u]));e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"))}else e.callSafe(a,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"))}else i.dirStat(n,a,{isdir:!0,name:""})}),a)},i.setStat=function(n,u,s){o((function(){if(r.debug("stat "+n),""!=n){var o,l,c=n.lastIndexOf("."),d=(o=-1==c?n:n.substr(0,c)).lastIndexOf("/"),f="";-1!=d&&(f=o.substring(0,d)),l=o.substring(d);var p=i.keystore.getItem(f);if(null!==p){var g=JSON.parse(p);if(g[l]){if("dir"==g[l].type)return void e.callSafe(s,e.error(t.BWDS_ERROR_WRONG_ATTRIB,"KeyStoreBWDS Error: Can't set attributes for directory"));for(var h in u)if("backup_date"==h)g[l].backup_date=u.backup_date;else{if("backup_version"!=h)return void e.callSafe(s,e.error(t.BWDS_ERROR_WRONG_ATTRIB,"KeyStoreBWDS Error: Can't set attribute "+h));g[l].backup_version=u.backup_version}if(!a(f,JSON.stringify(g),s))return;e.callSafe(s,null,i.fileStat(f,l,g[l]))}else e.callSafe(s,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"))}else e.callSafe(s,e.error(t.BWDS_ERROR_UNKNOWN,"KeyStoreBWDS Error: unknown file"))}else e.callSafe(s,e.error(t.BWDS_ERROR_WRONG_ATTRIB,"KeyStoreBWDS Error: Can't set attributes for directory"))}),s)},i.executeSync=function(e,t){e((function(){}))},i.clearAll=function(e){o((function(){i.clear("",e)}),e)},i}}(n(69238),n(63347).Z,n(22927))},46958:function(e,t,n){e.exports=function(e){var t=e.createLogger("WebSQLAsyncKeyStore");function n(e,n,r){t.error("WebSQL Error: executeSQL triggered error: "+r.message),null!=e&&e(r)}var r=function(e,t){this.name=e||"BWDS1",this.initialized=!1,this.valid=!1,this.db=null,this.openDatabase=void 0!==t?t:window.openDatabase?window.openDatabase.bind(window):function(){console.error("webSQL not supported")}};return r.prototype._prepareDatabase=function(e,n){var r=this.openDatabase(this.name,"","Offline BW storage",5242880);return""==r.version&&(t.debug("WebSQL: creating db"),r.changeVersion(r.version,"1.0",(function(e){t.debug("WebSQL: creating table"),e.executeSql("CREATE TABLE keyvalue (keyname PRIMARY KEY, dir, name, value, attribs)")}),n)),r},r.prototype._initializeAndRun=function(e,n){if(this.initialized)this.valid?void 0!==e&&e():(t.debug("WebSQL Error: Database is initialized but not valid, calling error"),void 0!==n&&n(this.error));else if(this.initialized=!0,this.openDatabase){try{t.debug("WebSQL: initializing database"),this.db=this._prepareDatabase((function(e){t.debug("WebSQL Error: Received error while preparing database: "+e.message)})),this.valid=!0}catch(e){switch(e.code){case e.SECURITY_ERR:t.debug("WebSQL Error: Received security error: "+e.message);break;case e.INVALID_STATE_ERR:t.debug("WebSQL Error: Received invalid state error: "+e.message);break;default:t.debug("WebSQL Error: Received error "+e.code+": "+e.message)}return this.valid=!1,this.error=e,void n(e)}e()}else t.debug("WebSQL Error: No WebSQL database available"),this.valid=!1,this.error={code:9999,message:"WebSQL Error: No WebSQL database available"},n(this.error)},r.prototype._initializeAndRunTransaction=function(e,n,r){var o=this;this._initializeAndRun((function(){o.db[e?"readTransaction":"transaction"]((function(e){try{n(e)}catch(e){t.error("Error while executing transaction: "+e.code+": "+e.message),null!=r&&r(e)}}),(function(e){t.error("WebSQL Error: "+e.code+" starting transaction :"+e.message),o.valid=!1,o.initialized=!1,null!=r&&r(e)}))}),(function(e){t.error("WebSQL Error: database not valid"),null!=r&&r(e)}))},r.prototype._initializeAndRunReadTransaction=function(e,t){this._initializeAndRunTransaction(!0,e,t)},r.prototype._initializeAndRunReadWriteTransaction=function(e,t){this._initializeAndRunTransaction(!1,e,t)},r.prototype.getItemsAsync=function(e,r,o){if(0===e.length)return t.debug("WebSQL Error: getItemsAsync without names"),void o({code:9999,message:"WebSQL Error: getItemsAsync without names"});this._initializeAndRunReadTransaction((function(i){for(var a="",u=0;u<e.length;++u)a+=(""==a?"":", ")+"?";i.executeSql("SELECT keyname, value, attribs FROM keyvalue where keyname IN ("+a+")",e,(function(e,n){for(var o={},i=0;i<n.rows.length;++i){var a=n.rows.item(i);o[a.keyname]=a,t.debug("WebSQL: read ("+a.keyname+") = "+a.value)}r(o)}),n.bind(null,o))}),o)},r.prototype.getDirAttribs=function(e,t,r){this._initializeAndRunReadTransaction((function(o){o.executeSql("SELECT keyname, attribs FROM keyvalue where dir = ?",[e],(function(e,n){for(var r={},o=0;o<n.rows.length;++o){var i=n.rows.item(o);r[i.keyname]=i.attribs}t(r)}),n.bind(null,r))}),r)},r.prototype.setItemsAsync=function(e,r,o){if(0===e.length)return t.error("WebSQL Error: setItemsAsync without names"),void o({code:9999,message:"setItemsAsync without names"});if(e.length>1)return t.error("WebSQL Error: setItemsAsync can only handle 1 item"),void o({code:9999,message:"setItemsAsync can only handle 1 item"});var i=e[0];this._initializeAndRunReadWriteTransaction((function(a){var u,s=i.key,l=s.lastIndexOf("/"),c="";-1!=l&&(c=s.substring(0,l)),u=s.substring(l+1),a.executeSql("INSERT OR REPLACE INTO 'keyvalue' ( 'keyname', 'dir', 'name', 'value', 'attribs' ) VALUES ( ? , ? , ?, ? , ? )",[i.key,c,u,i.value,i.attribs],(function(n,a){a.rowsAffected!=e.length?(t.error("WebSQL Error: store error on key "+name),o({code:9999,message:"WebSQL store error: wrong # rows affected"})):null!=r?(t.debug("WebSQL: wrote ("+i.key+")"),r()):t.error("WebSQL Error: setItemsAsync no OK function")}),n.bind(null,o))}),o)},r.prototype.removeItemsAsync=function(e,r,o){if(0===e.length)return t.debug("WebSQL Error: removeItemsAsync without names"),void o({code:9999,message:"WebSQL Error: removeItemsAsync without names"});this._initializeAndRunReadWriteTransaction((function(i){for(var a="",u=0;u<e.length;++u)a+=(""==a?"":", ")+"?";i.executeSql("DELETE FROM keyvalue where keyname IN ("+a+")",e,(function(n,o){t.debug("WebSQL: removed "+e.join(", ")),null!=r&&r()}),n.bind(null,o))}),o)},r.prototype.clearAllAsync=function(e,r){this._initializeAndRunReadWriteTransaction((function(o){o.executeSql("DELETE FROM keyvalue",[],(function(n,r){t.debug("WebSQL: Cleared all"),null!=e&&e()}),n.bind(null,r))}),r)},r}(n(22927))},34169:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}n.r(t),n.d(t,{Store:function(){return u},clear:function(){return f},del:function(){return d},direlems:function(){return p},get:function(){return l},set:function(){return c}});var i,a=n(78881),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bwds-store",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keyval";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storeName=n,this._dbp=new a((function(e,r){var o=indexedDB.open(t,1);o.onerror=function(){return r(o.error)},o.onsuccess=function(){return e(o.result)},o.onupgradeneeded=function(){o.result.createObjectStore(n).createIndex("dir_idx","dir")}}))}var t,n;return t=e,(n=[{key:"_withIDBStore",value:function(e,t){var n=this;return this._dbp.then((function(r){return new a((function(o,i){var a=r.transaction(n.storeName,e);a.oncomplete=function(){return o()},a.onabort=a.onerror=function(){return i(a.error)},t(a.objectStore(n.storeName))}))}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(){return i||(i=new u),i}function l(e){var t;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:s())._withIDBStore("readonly",(function(n){t=n.get(e)})).then((function(){return t.result}))}function c(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:s())._withIDBStore("readwrite",(function(n){n.put(t,e)}))}function d(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:s())._withIDBStore("readwrite",(function(t){t.delete(e)}))}function f(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:s())._withIDBStore("readwrite",(function(e){e.clear()}))}function p(e){var t;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:s())._withIDBStore("readonly",(function(n){t=n.index("dir_idx").getAll(e)})).then((function(){return t.result}))}},54083:function(e,t,n){"use strict";n.d(t,{m:function(){return c},z:function(){return l}});var r=n(59756),o=n.n(r),i=n(35226),a=n.n(i),u=void 0,s=[];function l(e){s.push(e),e(u)}var c=function(e){var t=e.studentaccount;return{init:function(){var e=function(e){var n;switch(e){case t.ANONYMOUS:n=void 0;break;case t.OFFLINE:n={state:"offline",text:a()("You're offline")};break;case t.ONLINE:var r=t.getUserName();-1!=r.indexOf("@")&&(r=r.substring(0,r.indexOf("@"))),n={state:"online",text:r}}u=n,function(e){o()(s,(function(t){return t(e)}))}(n)};e(t.ANONYMOUS),t.initialized().then((function(){e(t.getState()),t.registerStateChangeCallback(e)}),(function(){e(t.ANONYMOUS)}))}}}.bind(null)},74397:function(e,t,n){"use strict";n.r(t),n.d(t,{init:function(){return s}});var r=n(21506),o=n.n(r),i=n(95792),a=n(54083);function u(e){if(null==e)return o()("#loginbutton").remove(),void i.centerTitle();var t=function(){var e=o()("#loginbutton");return e.length>0||(e=o()(document.createElement("div")).addClass("loginbutton bw-tooltext").attr("id","loginbutton"),i.prependToTitleToolbar(e)),e}();if(t.show(),t.safeHtml()!==e.text||t.attr("state")!==e.state){t.safeHtml(e.text).attr({state:e.state});var n=o()(document.createElement("div")).addClass("login-change-wrapper").appendTo("#top-container"),r=t.clone();r.attr("id","login-change-alert").appendTo(n).fadeIn(400,"swing",(function(){setTimeout((function(){r.fadeOut(400,"swing",(function(){n.remove()}))}),1e3)})),t.effect&&t.effect("pulsate",{times:4},500)}i.centerTitle()}function s(){(0,a.z)(u)}},4375:function(e,t,n){"use strict";var r=n(90985),o=n(21506),i=n.n(o);t.Z={bindToContext:function(e){var t=e.bwConfig,n=e.studentaccount,o=e.bwdsstorage,a=e.writecachingonlinestorage,u={},s=i().Deferred();u.initialized=function(){return s};var l=(0,r.getParameters)(),c=l.hasOwnProperty("teacher_id")?l.teacher_id:"",d=l.hasOwnProperty("school_id")?l.school_id:"";return t.getConfig().then((function(e){var t="no"!==e.save_answers;function r(e){return"student_name"==e||"student_email"==e||"student_id"==e}var l=null,f=-1;function p(r){if(s.resolve(),r==f)return console.log("Warning: setting identical storage state, ignoring"),i().when();var u=e.book_title&&""!==e.book_title?e.book_title:"_no_name_";switch(r){case n.ANONYMOUS:l=o.createInfoStorage(u,"",t);break;case n.OFFLINE:l=o.createInfoStorage(u,n.getUserId(),t);break;case n.ONLINE:l=a.createInfoStorage(u,c,d)}return f=r,i().when()}u.get=function(e,o){if(f!=n.ANONYMOUS&&n.hasProperty(e))o(n.getProperty(e));else if(t){var i=function(t){o(t[e])};if(null==l)return void o(null);r(e)?l.getCommonProperties(i):l.getGroupProperties(i)}else o(null)},u.set=function(e,o){if(f!=n.ANONYMOUS&&n.hasProperty(e))console.log("Request setting read-only property... skipping");else if(t){var i={};i[e]=o,r(e)?l.setCommonProperties(i):l.setGroupProperties(i)}},u.hasStudentAccount=function(){return f==n.OFFLINE||f==n.ONLINE},u.getStudentAccountUserId=function(){return n.getUserId()},u.getStudentAccountUserName=function(){return n.getUserName()},u.getStudentAccountEmail=function(){return n.getEmail()},u.getStudentAccountProviderId=function(){return n.getProviderId()},u.getStudentAccountProviderHumanId=function(){return n.getProviderHumanId()},u.getStudentAccountToken=function(){return n.getUserToken()},u.getStudentAccountClassName=function(){return n.getUserClassName()},u.isCoAccount=function(){return n.isCoAccount()},n.initialized().then((function(){p(n.getState()),n.registerStateChangeCallback(p)}),(function(){p(n.ANONYMOUS)}))})),u}}},40904:function(e,t,n){"use strict";n.d(t,{setAutoDirectionIfRequired:function(){return o}});var r=n(44166);function o(e,t,n,o){(function(e){return null!=e&&e.endsWith("mixed")})(t)&&function(e,t,n){null==t?t=e.text():n&&(t=(0,r.appSafeUnescape)(t)),t.length>0?function(e){for(var t=[],n=new RegExp("^[֐-׾؀-۾܀-ݎݐ-ݾހ-޾߀-߾ࠀ-࠾ࡀ-࡞ࢠ-ࣾऀ-ॾ]|\ud802[\udf60-\udf7e]+$"),r=1,o=0;o<=r;o++)if(t[o]=e.substring(o-1,o),/\s/.test(t[o])&&r++,n.test(t[o]))return!0;return!1}(t)?e.css("direction","rtl"):e.css("direction","ltr"):console.log("setAutoDirection: no text")}(e,n,o)}},10306:function(e,t,n){"use strict";n.d(t,{createThrobber:function(){return i}});var r=n(21506),o=n.n(r);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=o()(document.createElement("div")).addClass("bw-throbber-wrapper bw-centering-container").appendTo(e),i=o()(document.createElement("canvas")).addClass("bw-throbber bw-centered").attr({width:t,height:t}).appendTo(r),a=i[0].getContext("2d");a.translate(t/2,t/2);for(var u=30*t/100,s=0;s<u;++s){a.rotate(2*-Math.PI/u);var l=n?0:255;a.strokeStyle="rgba("+l+","+l+","+l+","+(1/u).toFixed(2)+")",a.lineWidth=3,a.moveTo(t/5,0),a.lineTo(2*t/5,0),a.stroke()}var c=null,d=!1;return window.requestionAnimationFrame&&window.requestAnimationFrame((function e(t){if(c||(c=t),!d){var n="rotate("+360*Math.floor(t/1e3*u)/u+"deg)";i.css({transform:n,"-webkit-transform":n,"-moz-transform":n,"-ms-transform":n}),window.requestionAnimationFrame&&window.requestAnimationFrame(e)}})),{close:function(){r.remove(),d=!0}}}},76176:function(e){e.exports=function(){var e=[];function t(){for(var t=0;t<e.length;++t)e[t]()}return{executeCssUpdateCallbacks:t,CssUpdateCallbacks:e,updateConfigCSS:function(e){for(var n=document.getElementsByTagName("link"),r=0,o=n.length;r<o;r++){var i=n[r],a=i.rel;if("string"!=typeof a||0===a.length||"stylesheet"===a){var u=i.getAttribute("href");0===u.indexOf("config")&&-1!==u.indexOf(".css")&&(i.setAttribute("href","config"+e+".css"),setTimeout(t,100))}}},addAllDesignInfo:function(){void 0!==window.addAllDesignInfo&&window.addAllDesignInfo()},addCSSUpdateCallback:function(t){e.push(t)}}}()},58405:function(e,t,n){"use strict";n.r(t);var r=n(21506),o=n.n(r);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var a=(0,n(58436).getPlatform)();-1!==a.indexOf("android")?o().fn.extend({clickOnDraggable:function(e){return this.each((function(){var t=!1;this.ClickOnDraggableCallback=e,o()(this).on("touchstart",(function(e){var n=e.originalEvent?e.originalEvent:e;1===n.changedTouches.length&&1===n.touches.length&&n.changedTouches[1]===n.touches[1]?(t=!0,setTimeout((function(){t&&(console.error("touch takes too long"),t=!1)}),100)):t=!1})),o()(this).on("touchend",(function(e){if(t){var n=e.originalEvent?e.originalEvent:e;1===n.changedTouches.length&&0===n.touches.length?(t=!1,this.ClickOnDraggableCallback()):t=!1}}))}))}}):o().fn.extend({clickOnDraggable:function(e){return this.each((function(){o()(this).click(e)}))}}),-1!==a.indexOf("android")||-1!==a.indexOf("preview")||-1!==a.indexOf("phantomjs")||-1!==a.indexOf("headlesschrome")||-1!==a.indexOf("chrome")||"ibw-platform-osx-safari"===a||"ibw-platform-osx-other"===a||"ibw-platform-osx-ibooks-epub"===a||"ibw-platform-unknown"===a?o().fn.extend({tapOrClick:function(e){return this.each((function(){o()(this).click(e);var t=this,n=o()(this);n.is("button")||n.is("a")||n.on("keydown",(function(n){var r=n.which;13!==r&&32!==r||e.bind(t)({preventDefault:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}})}))}))},tapOrClickOff:function(){return this.each((function(){o()(this).unbind("click");var e=o()(this);e.is("button")||e.is("a")||e.off("keydown")}))},triggerTapOrClick:function(e){return this.each((function(){o()(this).trigger("click",e)}))}}):o().fn.extend({tapOrClick:function(e){return this.each((function(){var t=this,n=o()(this);n.addClass("epub-block"),n.find("*").each((function(){this instanceof SVGElement&&o()(this).addClass("epub-block")}));var r=!1;n.hammer?"ibw-platform-ipad-bookwidgets"===a||"ibw-platform-ipad-seb"===a||"ibw-platform-ipad-ibooks-epub"===a||"ibw-platform-ipad-other"===a?n.hammer().on("tap",(function(o){!1===r&&(e.bind(t)(o),r=!0,setTimeout((function(){r=!1}),500)),n.blur(),o.stopImmediatePropagation()})):n.hammer().on("tap",(function(r){e.bind(t)(r),n.blur(),r.stopImmediatePropagation()})):n.click((function(r){e.bind(t)(r),n.blur()})),(n.hammer||!n.is("button")&&!n.is("a"))&&n.on("keydown",(function(n){var r=n.which;13!==r&&32!==r||e.bind(t)({preventDefault:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}})}))}))},tapOrClickOff:function(){return this.each((function(){var e=o()(this);e.hammer?e.hammer().off("tap"):e.unbind("click"),(e.hammer||!e.is("button")&&!e.is("a"))&&e.off("keydown")}))},triggerTapOrClick:function(e){return this.each((function(){var t=o()(this);t.hammer?t.hammer().trigger("tap",e):t.trigger("click",e)}))}}),o().fn.extend({clickOrHold:function(e,t,n){return n=n||3e3,this.each((function(){var r=!1,i=null;o()(this).click((function(t){r||e.bind(this)(t),r=!1})),o()(this).on("keydown",(function(t){var n=t.which;13!==n&&32!==n||e.bind(this)({prevent:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}})})),o()(this).on("mousedown touchstart",(function(){var e=this;i=setTimeout((function(){i=null,r=!0,t.bind(e)()}),n)})),o()(this).on("mouseup touchend",(function(){null!==i&&(clearTimeout(i),i=null),r&&setTimeout((function(){r=!1}),400)}))}))}}),o().fn.extend({makeButton:function(e){"string"==typeof(e=e||{})&&(e={label:e}),this.attr({role:e.hasOwnProperty("role")?e.role:"button"});var t=this.attr("tabindex");return"undefined"!==i(t)&&!1!==t||this.attr({tabindex:"0"}),e.hasOwnProperty("label")&&this.attr({"aria-label":e.label}),e.hasOwnProperty("labelledby")&&this.attr({"aria-labelledby":e.labelledby}),e.describedby&&this.attr("aria-describedby",e.describedby),this},makeLink:function(e){return this.attr({role:"link",tabindex:"0"}),e&&this.attr({"aria-label":e}),this}})},35226:function(e,t,n){e.exports=(n(937),function(e){try{return window.bwlocalizationmap&&window.bwlocalizationmap[e]&&""!==window.bwlocalizationmap[e]?window.bwlocalizationmap[e]:e}catch(t){return e}})},84615:function(e,t,n){var r,o;e.exports=(r=n(21506),o=n(35226),{createLabeledCheckbox:function(e,t,n,o,i){var a=r(document.createElement("table")).addClass("bw-checkbox").appendTo(e),u=r(document.createElement("tr")).appendTo(a),s=r(document.createElement("td")).addClass("bw-checkbox-cell").appendTo(u);function l(){return null!=o&&o>0&&r(e).find("[role=checkbox][checked=checked]").length>=o}function c(){r(e).toggleClass("bw-check-limit-reached",l())}return r(document.createElement("div")).addClass("bw-checkbox-checkbox bw-icon bw-icon-accept").appendTo(s),r(document.createElement("td")).addClass("bw-button-label-cell").append(r(document.createElement("div")).addClass("bw-button-label").safeHtml(t)).appendTo(u),a.bind("check",(function(){r(this).attr({checked:"checked","aria-checked":"true"}),c()})),a.bind("clear",(function(){r(this).attr({checked:null,"aria-checked":"false"}),c()})),a.makeButton({role:"checkbox",describedby:i}).tapOrClick((function(){var e=r(this);if("disabled"!==e.attr("disabled"))if("checked"===e.attr("checked"))e.trigger("clear"),n&&n.call(e[0],!1);else{if(l())return;e.trigger("check"),n&&n.call(e[0],!0)}})),a.trigger("clear"),a},createProgressBar:function(e,t){var n={};n.parent=e,n.max=t,r(document.createElement("div")).addClass("bw-progress-bar").css("left","-100%").appendTo(r(e));var o=100/t;return r(document.createElement("div")).addClass("bw-progress-bar-marker").css({left:"-100%",width:o+"%"}).appendTo(r(e)),n.setProgress=function(t,n,o){n=n||400;var i=100*-(this.max-parseFloat(t))/this.max,a=r(this.parent+"> .bw-progress-bar"),u=r(e).width(),s=-(this.max-parseFloat(t))*u/this.max;a.css("left",a.css("left")),a.animate({left:s},n,"swing",(function(){a.css("left",i+"%"),o&&o()}))},n.setPosition=function(t,n){n=n||400;var o=r(this.parent+"> .bw-progress-bar-marker"),i=100*parseFloat(t)/this.max,a=r(e).width()*t/this.max;o.css("left",o.css("left")),o.animate({left:a},n,"swing",(function(){o.css("left",i+"%")}))},n.clear=function(){r(this.parent+" .bw-progress-bar").css("left","-100%"),r(this.parent+" .bw-progress-bar-marker").css("left","-100%")},n},createSimpleCheckbox:function(e,t,n,o,i,a){var u=r(document.createElement("div")).addClass("bw-simple-checkbox bw-icon bw-icon-accept").appendTo(r(e)),s={role:"checkbox"};function l(){return null!=i&&i>0&&r(o).find("[role=checkbox][checked=checked]").length>=i}function c(){r(o).toggleClass("bw-check-limit-reached",l())}return n&&(s.labelledby=n),a&&(s.describedby=a),u.bind("check",(function(){r(this).attr({checked:"checked","aria-checked":"true"}),c()})),u.bind("clear",(function(){r(this).attr({checked:null,"aria-checked":"false"}),c()})),u.makeButton(s).tapOrClick((function(){var e=r(this);if("disabled"!==e.attr("disabled"))if("checked"===e.attr("checked"))e.trigger("clear"),t&&t.call(e[0],!1);else{if(l())return;e.trigger("check"),t&&t.call(e[0],!0)}})),u.trigger("clear"),u},createNumberButtons:function(e,t,n,i,a){function u(e){if(r(".buttonslot").removeClass("selected"),t<=9)r("#BS_"+e).addClass("selected");else if(e<5){r("#BS_1").removeClass("hide_number"),r("#BS_7").addClass("hide_number");for(var n=1;n<8;++n)r("#BS_"+n).find(".number-button").safeHtml(n+1);r("#BS_"+e).addClass("selected")}else if(t-e<6){r("#BS_1").addClass("hide_number"),r("#BS_7").removeClass("hide_number");for(var o=2;o<8;++o)r("#BS_"+o).find(".number-button").safeHtml(t-8+o);r("#BS_"+(9-(t-e))).addClass("selected")}else{r("#BS_1").addClass("hide_number"),r("#BS_7").addClass("hide_number");for(var u=1;u<8;++u)r("#BS_"+u).find(".number-button").safeHtml(u+e-3);r("#BS_4").addClass("selected")}0===e?r(i).addClass("hidden"):r(i).removeClass("hidden"),e===t-1?r(a).addClass("hidden"):r(a).removeClass("hidden")}r(e).addClass("bw-column-container");for(var s=0,l=Math.min(t,9),c=r(e),d=0;d<l;++d)r(document.createElement("div")).addClass("buttonslot bw-column-resizing").attr("id","BS_"+d).append(r(document.createElement("div")).addClass("number-button bw-button").text(d+1)).appendTo(c).find(".number-button").makeButton().tapOrClick((function(){u(s=parseInt(r(this).safeHtml())-1),n(s)}));function f(){--s<0&&(s=0),u(s),n(s)}function p(){++s>=t&&(s=t-1),u(s),n(s)}return t>9&&(r(document.createElement("div")).addClass("ellipsis").appendTo(r("#BS_1")),r(document.createElement("div")).addClass("ellipsis").appendTo(r("#BS_7")),r("#BS_7").addClass("hide_number"),r("#BS_7").find(".number-button").safeHtml(t-1),r("#BS_8").find(".number-button").safeHtml(t)),r("#BS_0").addClass("selected"),r(i).addClass("hidden"),r(i).makeButton(o("previous")).tapOrClick(f),r(a).makeButton(o("next")).tapOrClick(p),{updateButtons:u,next:p,prev:f}},createSimpleRadiobutton:function(e,t,n,o){var i=r(document.createElement("div")).addClass("bw-simple-radiobutton bw-icon").appendTo(r(e));i.bind("check",(function(){r(this).attr({checked:"checked","aria-checked":"true"})})),i.bind("clear",(function(){r(this).attr({checked:null,"aria-checked":"false"})}));var a={role:"radio"};return n&&(a.labelledby=n),o&&(a.describedby=o),i.makeButton(a).tapOrClick((function(){var e=r(this);"disabled"!==e.attr("disabled")&&("checked"===e.attr("checked")?(e.trigger("clear"),t&&t.call(e[0],!1)):(e.trigger("check"),t&&t.call(e[0],!0)))})),i.trigger("clear"),i},createLabeledRadiobutton:function(e,t,n,o){var i=r(document.createElement("table")).addClass("bw-radiobutton").appendTo(e),a=r(document.createElement("tr")).appendTo(i),u=r(document.createElement("td")).addClass("bw-radiobutton-cell").appendTo(a);return r(document.createElement("div")).addClass("bw-radiobutton-radiobutton bw-icon bw-icon-largedot").appendTo(u),r(document.createElement("td")).addClass("bw-button-label-cell").append(r(document.createElement("div")).addClass("bw-button-label").safeHtml(t)).appendTo(a),i.bind("check",(function(){r(this).attr({checked:"checked","aria-checked":"true"})})),i.bind("clear",(function(){r(this).attr({checked:null,"aria-checked":"false"})})),i.makeButton({role:"radio",describedby:o}).tapOrClick((function(){var e=r(this);"disabled"!==e.attr("disabled")&&("checked"===e.attr("checked")?(e.trigger("clear"),n&&n.call(e[0],!1)):(e.trigger("check"),n&&n.call(e[0],!0)))})),i.trigger("clear"),i},createProgressCircle:function(e,t,n){var o={},i=40,a=40;o.id=t,o.progress=Array(n);var u=r(document.createElement("div")).addClass("bw-progress-circle bw-centering-container").attr("id",t).appendTo(r(e));r(document.createElement("div")).addClass("bw-progress-circle-text bw-centered").appendTo(u);var s=[];function l(e,t){if(-1===e)return"";var r=2*Math.PI*e/n,o=2*Math.PI*(e+1)/n,u=i+Math.sin(r)*t,s=a-Math.cos(r)*t,l=i+Math.sin(o)*t,c=a-Math.cos(o)*t;return"M X1 Y1 A R R 0 0 1 X2 Y2".replace("X1",u).replace("Y1",s).replace("X2",l).replace("Y2",c).replace("D",r).replace("R",t).replace("R",t)}function c(e){return'<path d="'+l(e,30)+'"/>'}for(var d=0;d<n;++d)s.push(c(d));return r('<svg class="bw-progress-circle-drawing" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 80 80">'+s.join("")+'<path class="the marker"/></svg>').appendTo(u),o.setProgress=function(e,t){r("#"+this.id+" path:nth-child("+(e+1)+")").attr("class",t)},o.setTextAndPosition=function(e,t){var n=r("#"+this.id+" .bw-progress-circle-text");n.animate({opacity:0},200,"swing",(function(){n.empty().append(e).animate({opacity:1},200)}));var o=r("#"+this.id+" path.the.marker");o.animate({opacity:0},200,"swing",(function(){o.attr("d",l(t,30)).animate({opacity:1},200)}))},o}})},25750:function(e){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}e.exports=function(e){return"string"==typeof(n=e)||"object"===t(n)&&n.constructor===String?0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("//")?e.replace(/\(/g,"_").replace(/\)/g,"_").replace(/'/g,"%27"):encodeURIComponent(e).replace(/%2F/g,"/").replace(/'/g,"%27"):"";var n}},63584:function(e,t,n){"use strict";n.r(t),n.d(t,{replaceParamsBySessionLink:function(){return a},valueOrCacheValue:function(){return u}});var r=n(16760),o=n.n(r),i=["backbutton","backlink","q"];function a(e){if(""===e)return e;if("undefined"==typeof sessionStorage)return e;var t=e.substring(1).split("&"),n="cache_"+(new Date).getTime()+"_";return"?"+o()(t,(function(e){for(var t=0;t<i.length;++t)if(e.startsWith(i[t]+"=")&&!e.startsWith(i[t]+"=cache_")){var r=n+t;return sessionStorage.setItem(r,decodeURIComponent(e.substring(i[t].length+1))),i[t]+"="+r}return e})).join("&")}function u(e){return null==e?e:e.startsWith("cache_")?sessionStorage.getItem(e):e}},95792:function(e,t,n){var r=n(76635).isEmpty,o=n(63584).valueOrCacheValue,i=n(3328),a=i.instructionsAreEmpty,u=i.prepareInfoPopup,s=i.showInfoPopupIfFirstTimeInSession,l=n(90985).getUrlParams;n(58405),n(68500),n(70882),e.exports=function(e,t,n,i,c,d,f,p){function g(e){if(-1===e.indexOf("?"))return e;var t=/^([^?]*)\?/.exec(e);if(t&&2===t.length)return t[1];throw Error("Shoudln't happen")}function h(e,t){if(r(t))return e;var n=g(e),o=[];return i.each(t,(function(e,t){o.push(e+"="+t)})),n+"?"+o.join("&")}function m(){var e=l(window.location.href);return{backlink:e.hasOwnProperty("backlink")?o(e.backlink):null,backbutton:e.hasOwnProperty("backbutton")?o(e.backbutton):null}}function v(){var t=m().backlink,n=e.getPlatform();if("ibw-platform-osx-preview"===n||"ibw-platform-win32-preview"===n)console.log("Moving back by using history.back()"),window.history.back();else{var r=window.location.origin;t.startsWith(r)&&(t=t.substr(r.length)),console.log("Moving back by setting window.location to: "+t),window.location=t}}function b(){var e=m(),t=e.backlink,n=e.backbutton;null!=t&&(null!=n?i(document.createElement("div")).addClass("widget-backlink widget-backlink-text").safeHtml("&#9664; ").text(n).appendTo(i("body")):i(document.createElement("div")).addClass("widget-backlink widget-backlink-icon").appendTo(i("body"))).click(v)}var w=!1;function y(e){if(!w){var t=i("#top-container"),n=t.height(),r=t.width(),o=i(".closebutton-container"),a=i("#top-container .bw-toolbar");o.css("min-width",""),a.css("min-width","");var u=o.width(),s=a.width();if(a.css("min-width",u),o.css("min-width",s),i(".title-container").css("max-width",r-2*Math.max(u,s)),!0!==e&&i("#top-container").height()!==n){w=!0;try{window.onresize&&window.onresize()}catch(e){console.error("Error when calling onResize during centerWidgetTitle"),console.error(e)}w=!1}}}function D(){i("#top-container").removeClass("bw-show-popup-menu"),i("#title-toolbar").appendTo(i("#top-container .bw-toolbar")),i(".bw-menu-overlay").remove()}function E(){if(!(i("#menubutton").length>0)){var e=i("#top-container .bw-toolbar");if(e.children(":not(.outside-popup)").length>1){e.removeClass("bw-toolbar");var t=i(document.createElement("div")).addClass("bw-toolbar").attr("role","menubar").appendTo(i(".titlebar-layout"));e.find(".outside-popup").each((function(){i(this).appendTo(t)})),e.appendTo(t).addClass("bw-button-group"),i(document.createElement("div")).attr("id","menubutton").addClass("bw-toolbutton").append(i(document.createElement("div")).addClass("bw-icon bw-icon-menu")).makeButton(n("Menu")).tapOrClick((function(){i("#top-container").hasClass("bw-show-popup-menu")?D():setTimeout((function(){i("#top-container").addClass("bw-show-popup-menu");var e=i(document.createElement("div")).addClass("bw-menu-overlay").appendTo("#container");setTimeout((function(){e.on("click touchend",(function(){setTimeout(D,500)}))}),350),i("#title-toolbar").appendTo(e)}),100)})).appendTo(t)}else e.attr("role","toolbar")}}function C(e,t,n){var r=i(e),o=i(document.createElement("div")).attr("id","container").prependTo(r).addClass("top-bottom-layout"),a=i(document.createElement("div")).attr("id","top-container").appendTo(o).addClass("top-container"),u=i(document.createElement("div")).appendTo(a).addClass("titlebar-layout");return i(document.createElement("div")).addClass("closebutton-container").appendTo(u),i(document.createElement("div")).addClass("title-container").append(i(document.createElement("span")).attr("id","title")).appendTo(u),n?i(n).addClass("bw-toolbar").appendTo(u):i(document.createElement("div")).attr("id","title-toolbar").addClass("bw-toolbar").appendTo(u),E(),i(t).appendTo(o).addClass("bottom-container"),y(),o}function A(){var t=i(document.createElement("div")).addClass("bw-debug-window bw-row-container").appendTo("body"),n=i(document.createElement("div")).addClass("bw-debug-output bw-row-resizing").appendTo(t);function r(e){e.appendTo(n),n[0].scrollTop=n[0].scrollHeight-n[0].getBoundingClientRect().height}function o(e){for(var t=[],n=0;n<e.length;++n)t.push(JSON.stringify(e[n]));return t.join(" ")}i(document.createElement("div")).addClass("bw-debug-close").text("X").tapOrClick((function(){t.remove(),localStorage.removeItem("bw-debug-enabled")})).appendTo(t),console.log=function(){r(i(document.createElement("p")).safeHtml(o(arguments)))},console.error=function(e,t){r(i(document.createElement("p")).css("color","red").safeHtml(o(arguments)))},window.onerror=function(e,t,n){return r(i(document.createElement("p")).attr("style","color: red").safeHtml(e+" ("+t+":"+n+")")),!0},console.log(e.getPlatform(),navigator.platform,navigator.userAgent,window.innerWidth,window.innerHeight);var a=i(document.createElement("input")).addClass("bw-debug-input bw-row-fixed").appendTo(t),u=[],s=0;a.keypress((function(e){var t;13===(e.keyCode?e.keyCode:e.which)&&(t=a.val().replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"'),console.log((0,eval)(t)),u.push(t),s=u.length,a.val(""))})),a.keydown((function(e){var t=e.keyCode?e.keyCode:e.which;38===t?s>0&&(--s,a.val(u[s])):40===t&&s<u.length&&(++s===u.length?a.val(""):a.val(u[s]))}));try{t.draggable()}catch(e){console.error("No drag support")}}function S(e){var t=0;e.clickOrHold((function(){t=0}),(function(){3==++t&&(function(){if(!(i(".bw-debug-window").length>0)){var e=i(document.createElement("div")).addClass("bw-debug-wrapper").appendTo("body"),t=i(document.createElement("div")).addClass("bw-debug-dialog").appendTo(e);i(document.createElement("p")).text("Enter your support key:").appendTo(t);var n=i(document.createElement("input")).attr("placeholder","key").appendTo(t);i(document.createElement("br")).appendTo(t),i(document.createElement("button")).attr("type","button").text("Cancel").tapOrClick((function(){e.remove()})).appendTo(t),i(document.createElement("button")).attr("type","button").text("OK").tapOrClick((function(){"bw-magic"===n.val()&&(A(),e.remove(),localStorage.setItem("bw-debug-enabled","true"))})).appendTo(t)}}(),t=0)}),2e3);try{"true"===localStorage.getItem("bw-debug-enabled")&&A()}catch(e){}}return i((function(){var t=e.getPlatform(),n=i("html");n.hasClass("ibw-platform-custom")||n.addClass(t)})),window.custom_alert=t.showAlert,window.criticalAlert=t.showCriticalAlert,window.bw_confirmation_dialog=t.showConfirmationDialog,window.tr=n,window.getUrlParams=l,window.getNakedURL=g,window.setQueryParameters=h,window.createLabeledCheckbox=c.createLabeledCheckbox,window.createProgressBar=c.createProgressBar,window.createSimpleCheckbox=c.createSimpleCheckbox,window.createNumberButtons=c.createNumberButtons,window.createSimpleRadiobutton=c.createSimpleRadiobutton,window.createLabeledRadiobutton=c.createLabeledRadiobutton,window.createProgressCircle=c.createProgressCircle,window.URIEncodeImage=d,window.BWAdaptToPageProtocol=p,window.updateConfigCSS=f.updateConfigCSS,{makeWidget:function(t){u((t=t||{}).instructions),a(t.instructions)||"title_layout"!==t.layout||(t.layout="title_toolbar_layout");var n=i("body");n.addClass("bw"),t.hasOwnProperty("no-user-select")&&!0===t["no-user-select"]&&n.addClass("no-user-select");var r,o=t.layout||"";if("title_layout"===o?(r=C("body","#bottom-container")).find(".top-container").addClass("title-only"):"title_overlay_layout"===o?((r=C("body","#bottom-container")).addClass("title-overlay"),r.find(".top-container").addClass("title-only")):r="title_toolbar_layout"===o?C("body","#bottom-container","#title-toolbar"):i("#container"),t.hasOwnProperty("title")&&""!==t.title){var l=r.find("#title");l.safeHtml(t.title),S(l)}else{var c=r.find(".top-container");c.addClass("title-empty"),S(c)}"ibw-platform-ipad-ibooks-epub"===e.getPlatform()&&(t.hasOwnProperty("epubBlockTouchEndCheck")||(t.epubBlockTouchEndCheck=function(e){return e.srcElement instanceof SVGElement||i(e.srcElement).hasClass("epub-block")}),document.addEventListener("touchend",(function(e){var n=i(window).width();(e.layerX<50||n-e.layerX<50||t.epubBlockTouchEndCheck(e))&&e.preventDefault()}),!1),t.hasOwnProperty("epubBlockTouchStartCheck")&&document.addEventListener("touchstart",(function(e){t.epubBlockTouchStartCheck(e)&&e.preventDefault()}),!1)),b(),s(t.instructions,t.uuid)},getNakedURL:g,setQueryParameters:h,prependToTitleToolbar:function(e){var t=i("#title-toolbar");e.prependTo(t),E(),y()},centerTitle:y,getBacklinkInfo:m,moveBackToPreviousWidget:v,ShowBacklinkIfRequired:b}}(n(58436),n(35048),n(35226),n(21506),n(84615),n(25750),n(76176),n(91845).Z)},92817:function(e,t,n){"use strict";n.d(t,{LT:function(){return g},_z:function(){return v},bw:function(){return h},v:function(){return b}});var r=n(3255),o=n.n(r),i=n(32944);function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=new(o()),l=function(e,t){var n=a(e);return n[t]||(n[t]=[]),n},c=function(e,t,n){var r=a(e);return r=function(e,t,n){var r=a(e);return r[n]||(r=l(r,n)),r[n][t]||(r[n]=a(e[n]),r[n][t]={x:t,y:n}),r}(r=l(r,n),t,n),r},d=function(e,t){return"V"===e.dir?{x:parseInt(e.x),y:parseInt(e.y)+t}:{x:parseInt(e.x)+t,y:parseInt(e.y)}},f=function(e,t,n){return e[n]?Object.assign({},e[n][t]):void 0},p=function(e,t){var n=function(e){return s.splitGraphemes(e.word).map((function(t,n){return d(e,n)}))}(t);return n.map((function(t){return f(e,t.x,t.y)}))},g=function(e,t){return p(e,t).map((function(e){return(null==e?void 0:e.letter)||" "})).join("")},h=function(e,t){var n=p(e,t);return!n.every((function(e){return" "===(null==e?void 0:e.letter)}))&&n.every((function(e){return null==e?void 0:e.letter}))},m=function(e,t,n,r,o){var i=a(e);return i[n]&&i[n][t]?i[n][t][r]=o:(i=c(i,t,n))[n][t][r]=o,i},v=function(e,t){var n=a(e);return t.forEach((function(e){e.letter&&(n=m(n,e.x,e.y,"letter",e.letter))})),n},b=function(e,t,n){var r=function(e){var t=[];return e&&e.forEach((function(e){s.splitGraphemes(e.word).forEach((function(n,r){var o=d(e,r);t=c(t,o.x,o.y),t=m(t,o.x,o.y,"letter",n)}))})),t}(t),o=e.map((function(e){return e?e.map((function(e){var t=Object.assign({},e);if(e&&(e.x||0===e.x)&&(e.y||0===e.y)){var o=f(r,e.x,e.y),a=(0,i.matchesOneOfAnswers)(e.letter,null==o?void 0:o.letter,n);t.isCorrect=a}return t})):e}));return function(e,t){var n=function(e){return e?e.map((function(e,t){var n={direction:e.dir,coords:[],description:e.description,id:t};return s.splitGraphemes(e.word).forEach((function(t,r){var o=d(e,r);n.coords.push(o)})),n})):[]}(t);return n.filter((function(t){return!t.coords.some((function(t){var n=f(e,t.x,t.y);return void 0===(null==n?void 0:n.letter)||""===n.letter}))}))}(e,t).forEach((function(e){e.coords.forEach((function(e){o=m(o,e.x,e.y,"isCompleteWord",!0)}))})),o}},57873:function(e,t,n){"use strict";function r(e){for(var t={},n=e.split("&"),r=0;r<n.length;r++){var o=n[r].indexOf("=");if(!(o<0)){var i=[n[r].substr(0,o),n[r].substr(o+1)],a=decodeURIComponent(i[0]);if(void 0===t[a])t[a]=decodeURIComponent(i[1]);else if("string"==typeof t[a]){var u=[t[a],decodeURIComponent(i[1])];t[a]=u}else t[a].push(decodeURIComponent(i[1]))}}return t}function o(e){return-1===e.indexOf("?")?{}:r(e.replace(/[^?]*\?/,"").replace(/#.*/,""))}n.d(t,{oj:function(){return f},Z7:function(){return d},BZ:function(){return _},L2:function(){return A},U0:function(){return c},hC:function(){return l},qS:function(){return E},Zr:function(){return p},Cj:function(){return S},pn:function(){return C},aJ:function(){return D},Qd:function(){return y}});var i=/^(https?:\/\/)?((www\.)?youtube\.com\/(v|embed|u|w|shorts)|youtu\.be)\/([^?&#]+)/,a=/^(https?:\/\/)?(www\.)?youtube\.com\/watch\?(.*)/;function u(e){var t;return null!=(t=e.match(i))?t[5]:null!=(t=e.match(a))?r(t[3].split("#")[0]).v:null}function s(e){return-1!==(e=e.split("#")[0]).indexOf("?")?e:e.replace("&","?")}function l(e){var t=o(s(e));return null!=t.t?function(e){var t=e.match(/(([0-9]+)m)?([0-9]+)s/);if(null==t)return 0;var n=parseInt(t[3]);return t[2]&&(n+=60*parseInt(t[2])),n}(t.t)+"":null!=t.start?t.start:null}function c(e){var t=o(s(e));return null!=t.end?t.end:null}function d(e){return o(e).cc_load_policy}function f(e){return o(e).cc_lang_pref}function p(e){var t=[],n=l(e);null!=n&&t.push("start="+n);var r=c(e);null!=r&&t.push("end="+r);var o=d(e);null!=o&&t.push("cc_load_policy="+o);var i=f(e);return null!=i&&t.push("cc_lang_pref="+i),0===t.length?"":"?"+t.join("&")}function g(e){return null!=u(e)}var h=[/^(https?:\/\/)?vimeo.com\/(\d+)/,/^(https?:\/\/)?vimeo.com\/album\/[^/]+\/video\/([0-9]+)/,/^(https?:\/\/)?vimeo.com\/channels\/[^/]+\/([0-9]+)/,/^(https?:\/\/)?vimeo.com\/groups\/[^/]+\/video\/([0-9]+)/,/^(https?:\/\/)?vimeo.com\/ondemand\/[^/]+\/video\/([0-9]+)/];function m(e){for(var t=0;t<h.length;++t){var n=e.match(h[t]);if(null!=n)return n[2]}return null}var v=/^(https?:\/\/)?(www\.)?giphy\.com\/(embed|gifs)\/([^/?]+)/,b=/^((https?:)?\/\/)?media.giphy.com\/media\/([^/]+)/;function w(e){var t=e.match(v);return null!=t?t[4]:null!=(t=e.match(b))?t[3]:null}function y(e){return g(e)}function D(e){return g(e)}function E(e){var t=u(e);return null!=t?t:e}function C(e){return function(e){return null!=m(e)}(e)}function A(e){var t=m(e);return null!=t?t:e}function S(e){return function(e){return null!=w(e)}(e)}function _(e){var t=w(e);return null!=t?t:e}},69725:function(e,t,n){"use strict";n.d(t,{BL:function(){return s},ut:function(){return l}});var r=n(59756),o=n.n(r),i={count:0},a=[];function u(e){o()(a,(function(t){return t(e)}))}function s(){var e={count:i.count+1};i=e,u(e)}function l(){var e={count:i.count-1};i=e,u(e)}},46837:function(e,t,n){"use strict";n.d(t,{An:function(){return c},Mn:function(){return d},Od:function(){return f}});var r,o=n(90882),i=n.n(o),a=n(21506),u=n.n(a),s=[];function l(){0!=s.length?(r=s.shift()).cb(r.data).always((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.deferred.resolve.apply(null,t),l()})):r=void 0}function c(e,t,n,o){if(n&&s.length&&s[s.length-1].cb===e){var i=s[s.length-1];return i.data=n(i.data,t),i.deferred}var a=u().Deferred(),c={cb:e,data:t,deferred:a};return o?s.unshift(c):s.push(c),void 0===r&&l(),a}function d(e){c((function(){return e(),u().when()}))}function f(e){s=i()(s,(function(t){return t.cb!==e}))}},51881:function(e,t,n){"use strict";n.d(t,{Dj:function(){return u},Ej:function(){return d},K9:function(){return i},Nh:function(){return s},OD:function(){return p},Od:function(){return l},QG:function(){return m},ZH:function(){return a},iy:function(){return g},n5:function(){return f},tZ:function(){return h},vW:function(){return c}});var r={username:null,userid:null,email:null,providerid:null,providerhumanid:null,provider:null,school:null,token:null,sid:null,coaccount:null,className:null},o=r;function i(){return o}function a(){o=r}function u(e){o=e}function s(){return o.token}function l(){return o.sid}function c(){return o.username}function d(){return o.className}function f(){return o.userid}function p(){return o.email}function g(){return o.providerid}function h(){return o.providerhumanid}function m(){return o.coaccount}},77143:function(e,t,n){"use strict";var r=n(63347),o=n(58436),i=n(21506),a=n.n(i),u=n(19923);function s(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}function l(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}t.Z={bindToContext:function(e){var t=e.bwds,n=!1;function i(e){var n=a().Deferred();return t.remove(e,(function(e){return null===e||e.code==r.B.BWDS_ERROR_UNKNOWN?n.resolve():(console.log("Remove failed: "+JSON.stringify(e)),n.reject()),n})),n}function d(e,i,u){var s=a().Deferred();return t.write(e,i,(function(e){if(null===e)s.resolve();else{if(u&&!1===n){if(e.code==r.B.BWDS_ERROR_SECURITY){var t=o.getPlatform();"ibw-platform-ipad-ibooks-epub"===t?window.criticalAlert("Unable to save your answer, please restart iBooks to solve this issue.<br>"+t.getIOSIBooksRestartInfo(),"Storage error"):window.criticalAlert("Storing answers not supported on this platform.","Storage error")}else window.criticalAlert("Could not save your answer.","Storage problem");n=!0}console.log("Save failed"),s.reject()}})),s}function f(e,i){var u=a().Deferred();return t.read(e,(function(e,t){if(null===e)t?u.resolve(t):(console.log("How did this happen?  No saved data on read!"),u.reject({}));else{if(i&&!1===n)if(e.code==r.B.BWDS_ERROR_SECURITY){var a=o.getPlatform();"ibw-platform-ipad-ibooks-epub"===a?window.criticalAlert("Unable to save your answer, please restart iBooks to solve this issue.<br>"+a.getIOSIBooksRestartInfo(),"Storage error"):window.criticalAlert("Storing answers not supported on this platform.","Storage error"),n=!0}else e.code!=r.B.BWDS_ERROR_UNKNOWN&&(console.log("Error "+e.code+" occurred while loading data: "+e.message),window.criticalAlert("Storing answers not supported on this platform.","Storage error"),n=!0);u.reject({})}})),u}return{createWidgetStorage:function(e,n,r,o,p,g,h,m){var v=c((function(){return null!=D?D:null==g?D=w():l((e=w(),n=a().Deferred(),t.stat(e,(function(e){null==e?n.resolve(!0):n.resolve(!1)})),n),(function(e){return D=e?w():(""==p?"":p+"/")+g}));var e,n})),b={};function w(){return(""==p?"":p+"/")+"books/"+e+"/"+n+"/"+r}var y={},D=null;function E(e,t){return e+"/img/"+t}return b.getWidgetTag=v,b.loadAll=function(e){var t=this;return s(v,(function(n){t.loadAllForWidgetTag(n,e)}))},b.loadAllForWidgetTag=function(e,n){var r,i;o?f(e+h,m).done(n).fail((function(){n(null)})):""!==p?f(e,m).always((function(e){try{var t=JSON.parse(e);y=t,n(t)}catch(e){console.log("Can't parse bwds user data"),console.log(e),n(y)}})):(r=e,i=a().Deferred(),t.dir(r,(function(e,t){null===e?i.resolve(t):i.reject(e)})),i).done((function(r){var o={},i=[];function u(e,n,r){t.read(e+"/"+n,(function(e,t){null===e?o[n]=t:console.log("Received error reading: "+n),r.resolve()}))}for(var s=0;s<r.length;++s){var l=a().Deferred();i.push(l),u(e,r[s],l)}a().when.apply(null,i).done((function(){n(o)}))})).fail((function(e){n({})}))},b.writeForWidgetTag=function(e,t,n){if(o)null===t?i(e+h).always(n):d(e+h,t,m).always(n);else if(""!==p)y=(0,u.b)(y,t),d(e,JSON.stringify(y),m).always(n);else{var r=[];for(var s in t){var l=t[s];null===l?r.push(i(e+"/"+s)):r.push(d(e+"/"+s,l,m))}a().when.apply(null,r).always(n)}},b.write=function(e,t){var n=this;return s(v,(function(r){n.writeForWidgetTag(r,e,t)}))},b.overwriteAndSetVersion=function(e,t){var n=this;return s(v,(function(r){return l(n.overwriteAndSetVersionForWidgetTag(r,e,t))}))},b.overwriteAndSetVersionForWidgetTag=function(e,t,n){var r=a().Deferred();if(o)null===t?i(e+h).always((function(){r.resolve()})):d(e+h,t,m).always((function(){b.setVersion(n).finally((function(){r.resolve()}))}));else if(""!==p){var u=JSON.stringify(t);y=JSON.parse(u),d(e,u,m).always((function(){b.setVersion(n).finally((function(){r.resolve()}))}))}else console.error("bwds_storage_if.overwriteAndSetVersion not implemented for this storage mode... only intended for local caching"),r.reject();return r},b.setVersionForWidgetTag=function(e,n){var r=a().Deferred(),i=e;return o&&(i+=h),t.stat(i,(function(e,o,a){null===e?t.setStat(i,{backup_date:o.modified,backup_version:n},(function(e){null===e?r.resolve():(console.log("Problem writing stat: "+JSON.stringify(e)),r.reject())})):(console.log("Got error reading stat for "+i+": means offline mode won't work"),r.reject())})),r},b.setVersion=function(e){var t=this;return s(v,(function(n){return l(t.setVersionForWidgetTag(n,e))}))},b.getVersionForWidgetTag=function(e,n){var r=e;o&&(r+=h),t.stat(r,(function(e,t,r){null===e?n({version:t.backup_version,offlinedata:t.backup_date!=t.modified,hasdata:!0}):(console.log("Error reading stat... assume there is no data"),n({version:0,offlinedata:!1,hasdata:!1}))}))},b.getVersion=function(e){var t=this;return s(v,(function(n){return l(t.getVersionForWidgetTag(n,e))}))},b.writeImage=function(e,t){var n=a().Deferred();return v().then((function(r){d(E(r,e),t,m).then(n.resolve.bind(n),n.reject.bind(n))})),n},b.clearImage=function(e){var t=a().Deferred();return v().then((function(n){i(E(n,e)).then(t.resolve.bind(t),t.reject.bind(t))})),t},b.isImageBackedUpForWidgetTag=c((function(e,n){var r=a().Deferred();return t.stat(E(e,n),(function(e,t){null===e?r.resolve(t.backup_date==t.modified):r.reject()})),r})),b.isImageBackedUp=function(e){var t=this;return s(v,(function(n){return l(t.isImageBackedUpForWidgetTag(n,e))}))},b.listImagesAndBackupStatusForWidgetTag=function(e){var n=a().Deferred();return t.stat(e+"/img",(function(e,t,r){if(null===e){for(var o=[],i=0;i<r.length;++i){var a=r[i].name;!0!==r[i].removed&&o.push({id:a.substring(a.lastIndexOf("/")+1),backed_up:r[i].backup_date===r[i].modified})}n.resolve(o)}else n.resolve([])})),n},b.listImagesAndBackupStatus=function(){var e=this;return s(v,(function(t){return l(e.listImagesAndBackupStatusForWidgetTag(t))}))},b.setImageBackedUpForWidgetTag=function(e,n){var r=a().Deferred();return t.stat(E(e,n),(function(o,i,a){null===o?t.setStat(E(e,n),{backup_date:i.modified},(function(e){null===e?r.resolve():r.reject()})):r.reject()})),r},b.setImageBackedUp=function(e){var t=this;return s(v,(function(n){return t.setImageBackedUpForWidgetTag(n,e)}))},b.readImage=function(e){var t=a().Deferred();return v().then((function(n){f(E(n,e),m).then(t.resolve.bind(t),t.reject.bind(t))})),t},b.sync=function(e){t.executeSync(e)},b},createInfoStorage:function(e,t,n){var r={},o={},i={};function a(e){return(""==t?"":t+"/")+"info/"+e}return f(a("BWCommon"),n).always((function(e){try{o=JSON.parse(e)}catch(e){o={}}})),f(a(e),n).always((function(e){try{i=JSON.parse(e)}catch(e){i={}}})),r.getCommonProperties=function(e){e(o)},r.getGroupProperties=function(e){e(i)},r.setCommonProperties=function(e){o=(0,u.b)(o,e),d(a("BWCommon"),JSON.stringify(o),n)},r.setGroupProperties=function(t){i=(0,u.b)(i,t),d(a(e),JSON.stringify(i),n)},r}}}}},3328:function(e,t,n){"use strict";n.r(t),n.d(t,{instructionsAreEmpty:function(){return f},prepareInfoPopup:function(){return g},showInfoPopup:function(){return p},showInfoPopupIfFirstTimeInSession:function(){return h}});var r=n(2784),o=n(28316),i=n.n(o),a=n(21506),u=n.n(a),s=n(34785),l=n(6424),c={InstructionsDialog:"mDZNc4BgVxuPv7dxAvVP"},d=n(5733);function f(e){return!e||!e.instructions||!!(0,d.isEmptyRichText)(e.instructions)}function p(e){if(!f(e)){var t=u()(document.createElement("div")).css({position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"}).appendTo("body"),n=r.createElement(s.$,null,r.createElement(s.V,{className:c.InstructionsDialog,title:e.instructions_title||"",onOk:function(){t.remove()},onClose:function(){t.remove()}},r.createElement(l.H,{text:e.instructions||""})));i().render(n,t[0])}}function g(e){if(!f(e)){var t=u()("#title-toolbar");0===t.length&&(t=u()(document.createElement("div")).attr("id","title-toolbar").prependTo("body")),u()(document.createElement("div")).addClass("bw-toolbutton").append(u()(document.createElement("div")).addClass("bw-icon bw-icon-info")).makeButton(e.instructions_title||"").tapOrClick(p.bind(null,e)).prependTo(t)}}function h(e,t){if(!f(e))if(t){var n=t+"/instructions_shown";try{if("true"===sessionStorage.getItem(n))return}catch(e){}p(e);try{sessionStorage.setItem(n,"true")}catch(e){}}else p(e)}},60801:function(e,t,n){"use strict";n.r(t),n.d(t,{isLTI:function(){return o}});var r=(0,n(90985).getParameters)();function o(){return!!r.lti}},43683:function(e,t,n){"use strict";var r=n(11886),o=n.n(r),i=n(21506),a=n.n(i),u=n(19923),s=function(){return(new Date).getTime()},l=function(){var e=null;try{(e=parseInt(sessionStorage.getItem("widget-storage-session")))&&"true"===sessionStorage.getItem("widget-session-running-"+e)&&(e=null)}catch(t){e=null}if(null==e||isNaN(e)){e=s();try{sessionStorage.setItem("widget-storage-session",e+"")}catch(e){}}try{sessionStorage.setItem("widget-session-running-"+e,"true")}catch(e){}return window.addEventListener("beforeunload",(function(){try{sessionStorage.removeItem("widget-session-running-"+e)}catch(e){}})),e}(),c=function(){var e=null;try{e=localStorage.getItem("ws-bid")}catch(e){console.error("Could not load browser ID from localStorage",e)}if(null==e){e=s()+"";try{localStorage.setItem("ws-bid",e+"")}catch(t){console.log("Could not save browser ID to localStorage",t),e+="_"}}return e}();t.Z={bindToContext:function(e){var t=e.bwConfig,n=e.studentaccount,r=e.blob,i=e.dialog,d=e.tr,f=t.getConfigSync();return{createWidgetStorage:function(e,t,p,g,h,m,v,b,w){var y={},D=null,E=null,C=-1,A=null;function S(e,t){var r=n.getUserToken();return a().ajax({type:"POST",data:e,url:t,headers:{Authorization:"BWWAAuthToken "+r},timeout:3e4,connectTimeout:2e3,beforeSend:function(e,t){var n=this,r=t.xhr;t.xhr=function(){var e=r();return n.connectTimeoutCB=setTimeout((function(){console.log("Connection timeout occurred !"),e.abort()}),n.connectTimeout),e.onreadystatechange=function(){1==this.readyState&&clearTimeout(n.connectTimeoutCB)},e}}})}return y.loadAll=function(r){var u,s,y,S={"widget-id":p,"widget-type":e,"widget-name":t,"teacher-id":h,"school-id":m,"course-id":v,"class-id":b,"context-id":w,"session-id":l,"browser-id":c};void 0!==window.bwshortcode&&(S["widget-shortcode"]=window.bwshortcode),u=S,s=function(e){if(D=e.id,E=e.url,C=e.version,A=JSON.parse(e.data),e.isObserved){var t=JSON.parse(sessionStorage.getItem("observerMessage"))||[];o()(t,p)||(i.showInfoMessage(d("Your progress on this activity will be shared with your teacher.")),t.push(p),sessionStorage.setItem("observerMessage",JSON.stringify(t)))}var n,a,u;e.submissionInfo&&e.submissionInfo.storage_timestamp&&(n=e.submissionInfo,i.showInfoMessage(d("Your working copy of %s was submitted by your teacher.").replace("%s",(a=new Date(n.storage_timestamp),u=window.navigator.userLanguage||window.navigator.language,new Intl.DateTimeFormat(u,{dateStyle:"full",timeStyle:"long"}).format(a)))));try{r(g?A.hasOwnProperty("DATA")?A.DATA:"":A,C)}catch(e){console.error("Error in widget load callback"),console.error(e)}},y=function(e){403===e.status?(console.log("Online  storage nog allowed in this case, use offline storage: ",e.responseText),n.setForceOfflineStorage()):(console.error("Got error reading widget data"),n.goOffline()),r(g?null:{},-1)},a().ajax({type:"GET",dataType:"json",data:u,timeout:3e4,headers:{Authorization:"BWWAAuthToken "+n.getUserToken()},url:f.student_account_server+"/widget-storage/",connectTimeout:2e3,beforeSend:function(e,t){var n=this,r=t.xhr;t.xhr=function(){var e=r();return n.connectTimeoutCB=setTimeout((function(){console.log("Connection timeout occurred !"),e.abort()}),n.connectTimeout),e.onreadystatechange=function(){1==this.readyState&&clearTimeout(n.connectTimeoutCB)},e}},success:s,error:y})},y.overwrite=function(e,t,r){var o=g?{DATA:e}:e;!function(e,t,r,o,i,u,d){var f={version:r,data:JSON.stringify(o),i:1,"session-id":l,"browser-id":c,timestamp:s()};d&&(f.sync=1);var p=n.getUserToken();a().ajax({type:"PUT",contentType:"text/plain",data:JSON.stringify(f),url:t,headers:{Authorization:"BWWAAuthToken "+p},timeout:3e4,success:i,error:u})}(0,E,C,o,(function(e){C=e.version,e.hasOwnProperty("url")&&(E=e.url),A=e.hasOwnProperty("data")?JSON.parse(e.data):o,t({status:"OK",data:g?A.hasOwnProperty("DATA")?A.DATA:null:A,version:C})}),(function(e){if(console.log("Got error putting widget data"),409==e.status){console.log("Conflict, someone wrote newer data");var r=JSON.parse(e.responseText);C=r.version,A=JSON.parse(r.data),t({status:"CONFLICT",data:g?A.hasOwnProperty("DATA")?A.DATA:null:A,version:C})}else n.goOffline(),t({status:"OFFLINE"})}),r)},y.write=function(e,t){this.overwrite(g?e:(0,u.b)(A,e),t)},y.setNextUploadVersion=function(e){C=e},y.writeImage=function(e,t){var o=a().Deferred();return function(e,t){return S({name:t,confirm:"1",contentType:"image/jpeg"},f.student_account_server+"/widget-storage/"+e+"/resources")}(D,e).done((function(e){(function(e,t,n){var o=new r([n],{type:"image/jpeg"});return a().ajax({url:e,data:o,processData:!1,contentType:o.type,type:"PUT"})})(e.upload_url,0,t).done((function(){var t;(t=e.confirm_url,S({},t)).done((function(){o.resolve()})).fail((function(){console.log("confirming upload failed"),n.goOffline(),o.reject()}))})).fail((function(){console.log("upload resource failed"),n.goOffline(),o.reject()}))})).fail((function(){console.log("getting image url failed"),n.goOffline(),o.reject()})),o},y.clearImage=function(){return a().Deferred().resolve()},y.readImage=function(e){var t=f.student_account_server+"/widget-storage/"+D+"/resources/"+e,r=n.getUserToken(),o=a().Deferred();return a().ajax({url:t,headers:{Authorization:"BWWAAuthToken "+r},type:"GET"}).done((function(e){a().ajax({url:e.url,type:"GET"}).done((function(e){o.resolve(e)})).fail((function(){o.reject()}))})).fail((function(){o.reject()})),o},y.sync=function(e){e()},y.setSessionID=function(e){l=e},y.setBrowserID=function(e){c=e},y}}}}},56577:function(e,t,n){"use strict";n.r(t),n.d(t,{addLinkIcon:function(){return v},isWidgetPlayLink:function(){return g},openLinkOrWidgetLink:function(){return h},openWidget:function(){return p},processRichTextWidgetPlayLinks:function(){return m},widgetCoverImage:function(){return b}});var r=n(90882),o=n.n(r),i=n(86152),a=n.n(i),u=n(21506),s=n.n(u),l=n(63584),c=n(90985),d=n(51881),f=n(35048);function p(e,t,n){if(console.log("Widget link: "+e),e=function(e,t){var n=(0,c.getParameters)();delete n.design,delete n.content,delete n.translation,delete n.sig;var r=d.iy(),i=window.location.protocol+"//"+window.location.host+window.location.pathname+(0,l.replaceParamsBySessionLink)(window.location.search);if(null==n.login_hint&&r&&""!==r&&(window.location.search.length>1?i+="&":i+="?",i+="login_hint="+encodeURIComponent(r)),i+=(0,c.getHash)(),""===e||"?"===e.charAt(0))return f.showAlert("The widget is not included.","Broken link"),e;function u(e){return-1===e.indexOf("?")?"?":"&"}if(n.playBaseURL){var s=new URL(e),p=new URL(n.playBaseURL);s.protocol=p.protocol,s.host=p.host,e=s.href}if(t&&(e+=u(e)+"backlink="+encodeURIComponent(i),window.bwbackbuttonlabel&&(e+="&backbutton="+encodeURIComponent(window.bwbackbuttonlabel))),e.indexOf("/play/")>=0)n.q&&""!==n.q&&(e+=u(e)+function(e,t){if(null==e)return"";var n=a()(t)?t:[t];return o()(e.split("&"),(function(e){for(var t=0;t<n.length;++t)if(e.startsWith(n[t]+"="))return!1;return!0})).join("&")}((0,l.valueOrCacheValue)(n.q),["context_id","backlink","backbutton"])),null!=n.toplevel&&(e+=u(e)+"toplevel="+encodeURIComponent(n.toplevel)),r&&""!==r&&(e+=u(e)+"login_hint="+encodeURIComponent(r));else{var g={},h={};for(var m in n)"sid"!==m&&n.hasOwnProperty(m)&&(c.LEGACY_HASH_PARAMETERS.indexOf(m)>=0?g[m]=n[m]:h[m]=n[m]);r&&""!==r&&(g.login_hint=r),Object.keys(h).length>0&&(e+=u(e)+(0,c.urlencode)(h)),Object.keys(g).length>0&&(e+="#"+(0,c.urlencode)(g))}return e}(e,t),n){var r=s()(n.target),i=0===r.length?{left:0,top:0}:r.offset(),u=r.clone();s()("body").append(u),u.css({position:"absolute",left:i.left+"px",top:i.top+"px",width:r.width()+"px",height:r.height()+"px","border-left":r.css("border-left"),"border-right":r.css("border-right"),"border-top":r.css("border-top"),"border-bottom":r.css("border-bottom"),"border-top-left-radius":r.css("border-top-left-radius"),"border-top-right-radius":r.css("border-top-right-radius"),"border-bottom-left-radius":r.css("border-bottom-left-radius"),"border-bottom-right-radius":r.css("border-bottom-right-radius"),"-webkit-border-top-left-radius":r.css("-webkit-border-top-left-radius"),"-webkit-border-top-right-radius":r.css("-webkit-border-top-right-radius"),"-webkit-border-bottom-left-radius":r.css("-webkit-border-bottom-left-radius"),"-webkit-border-bottom-right-radius":r.css("-webkit-border-bottom-right-radius"),"box-shadow":r.css("box-shadow"),"-webkit-box-shadow":r.css("-webkit-box-shadow")});var p="all .5s linear";u.css({"-webkit-transition":p,"-moz-transition":p,"-o-transition":p,transition:p,"box-sizing":"border-box"});var g=s()(document).width(),h=s()(document).height(),m=g/r.width(),v=h/r.height(),b=m>v?v:m,w="translate("+(g/2-i.left-r.width()/2)+"px, "+(h/2-i.top-r.height()/2)+"px) scale("+b+")";u.css({"-webkit-transform":w,"-moz-transform":w,"-o-transform":w,transform:w,opacity:.1}),setTimeout((function(){window.location.href=e,u.remove()}),500)}else window.location.href=e,setTimeout((function(){window.location.href=e}),100)}function g(e){return null!=e&&-1!==e.indexOf("bookwidgets.com/play/")}function h(e,t,n){if(g(e)){var r=-1===e.indexOf("?")?"?":"&";p(e+=r+"noiframe=1",t)}else s()().isSafeURLForNavigation(e)&&(n||null==top?(console.log("open link in new tab ",e),window.open(e,"_blank")):(console.log("open link in same tab ",e),top.location.href=e))}function m(e,t){e.find("a").filter((function(){return g(s()(this).attr("href"))})).each((function(){var e=s()(this),n=e.attr("href"),r=-1===n.indexOf("?")?"?":"&";n+=r+"noiframe=1",e.before(s()(document.createElement("a")).tapOrClick((function(e){return p(n,t),e.preventDefault(),e.stopPropagation(),!1})).attr("href","#").safeHtml(e.html())),e.after("&nbsp;"),e.hide()}))}function v(e){s()(document.createElement("div")).addClass("link-icon").css({width:"24px",height:"24px",position:"absolute",top:"10px",right:"10px",opacity:"0.6",background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA+JJREFUeAHlm8tLIzEcx2Nb67M3wZsXb7uw91UPHv0f/AdEEEEEUUQQRBBE0a4PfKJWEV+IiIgUEfHmraxXBa/e3NvCbjbf2oiPTZv5zWRm0gn8GoyTmXw+ySTttGHsc/oqiqZF3Il4FsEtDzCABUxgU6ak+E9axB8RtkOr2g82MIL1XUJBVoSqYrmVg/WdhB8RgpediZHAKkTgvsiJiImIUvorYL/FxcuQiO9RIi+wovN/4wUz5JdCYdSyOwjAMpGKGnmB9xcEYFKIbEpQyJubm1ljY6NW1YoKOKYnav1cLseenzG4Sye5LGjnTU1N/P7+noc5tbW1afGQlr7Hx0fW3t7OHh4eSusN+REkAWAqFwlkAeUiwZWAcpDgWoDtEjwRYLMEzwTYKsFTATZK8FyAbRKMCLBJgjEBtkgwKsAGCcYFhF2CLwLeSnh6esKfxpP4pKp1Dd8EoDUdHR2soaFBq2F+HeSbgK6uLra4uMioDzhMCfFFQHd3N5ufnw8dPKQaF9DT08Pm5uZCCW9cQG9vL5udnTU1ej07r9azM3E1R8f19fUF+siwtbVVt73OwHRE9Pf3BwqPiwcmYGBgIHD4wAQMDg6GAj4QAcPDw6GB913AyMiI5/C3t7dcfO9APq9vc8Do6Ci5kaqKNzc3PJVKcTffQPkiYGxsTMVALr++vub19fWvSxhVgnEB4+PjZEhVxaurK15XV/cKL5dcigSjAiYmJlQM5PLLy0teW1v7CZ4qwZiAyclJMqSqYjabLQpPkdDS0qKUKc9XyPXfCU5NTakYyOUXFxe8pqZGt7HaE6PnAmZmZsiQqorn5+e8urpaG172nM6c4KmAdDqtYiCXn52d8aqqKsfwuhI8ESCe3nDxWZ4Mqap4enrqCl5HgmsBgBePsFQM5PKTkxOeTCbJPS/hZa66HVwJAPzS0hIZUlXx+PjYU/hiElwJ6OzsVDGQy4+OjnhlZaVnPS/hZf5xJLgS4PXwPzg44IlEwhj8/yS4EoATQsLy8jK5x2XFvb09X+A/SnAtQEpYXV2VLI7z3d1dHo/Hjfe8hJc5bgfxY07d6xZ/JxiLxfj6+rpj+O3t7UDgpQQHeXEBOBEkbG5uakvY2tqyBR6jpLQAKSGTyZSUsLGxkReme94QHKcnAA3F/byzs6OUsLa2Zhu8/giQPQUJmNw+ppWVlfzKIY+zKHe+NxBr+v7+/qsDvGvEsmkRtGxr/vf02DIjC7RzSDg8POQLCwu2woP1p4j8jkpt8LeyIMHSnpe809jOEeltcxgBSJHdOPmC/7KNNNJbZyECe2kxEiK5eRoCZMKcEJnt8/8AtqIJGXRoCukAAAAASUVORK5CYII=)","background-size":"cover"}).appendTo(e)}function b(e){return e?e.replace("/play/","/cover/"):null}},90985:function(e,t,n){"use strict";n.r(t),n.d(t,{LEGACY_HASH_PARAMETERS:function(){return r},getHash:function(){return f},getParameters:function(){return m},getQueryParams:function(){return s},getUrlParams:function(){return u},removeQueryStringParameter:function(){return d},split:function(){return i},splitList:function(){return a},updateWindowQueryParameter:function(){return p},urlencode:function(){return o}});var r=["context_id","course_id","hide_account","lfq","lti","login_hint","no_logout","q","sso","smartschool_platform","student_class_id","submit_url","teacher_email","teacher_id"];function o(e){var t=[];if("[object Array]"===Object.prototype.toString.call(e))for(var n=0;n<e.length;++n){var r=e[n];r.length>1?t.push(encodeURIComponent(r[0])+"="+encodeURIComponent(r[1])):t.push(encodeURIComponent(r[0]))}else for(var o in e)e.hasOwnProperty(o)&&t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")}function i(e){for(var t={},n=e.split("&"),r=0;r<n.length;r++){var o=n[r].indexOf("=");if(!(o<0)){var i=[n[r].substr(0,o),n[r].substr(o+1)],a=decodeURIComponent(i[0]);if(void 0===t[a])t[a]=decodeURIComponent(i[1]);else if("string"==typeof t[a]){var u=[t[a],decodeURIComponent(i[1])];t[a]=u}else t[a].push(decodeURIComponent(i[1]))}}return t}function a(e){for(var t=[],n=e.split("&"),r=0;r<n.length;r++){var o=n[r].indexOf("=");if(o<0)t.push([n[r]]);else{var i=[n[r].substr(0,o),n[r].substr(o+1)];t.push([decodeURIComponent(i[0]),decodeURIComponent(i[1])])}}return t}function u(e){return-1===e.indexOf("?")?{}:i(e.replace(/[^?]*\?/,"").replace(/#.*/,""))}function s(e){return!e||e.length<1||"?"!==e[0]?{}:i(e.substr(1))}function l(e){return!e||e.length<1||"?"!==e[0]?[]:a(e.substr(1))}function c(e,t){return e.split("&").filter((function(e){return decodeURIComponent(e.split("=")[0])!==t})).join("&")}function d(e,t){return e.length>0&&("?"===e[0]||"#"===e[0])?e[0]+c(e.substring(1),t):c(e,t)}function f(e){return(e=e||window.location.href).indexOf("#")>=0?"#"+(e.split("#")[1]||""):""}function p(e,t){for(var n=l(window.location.search),r=!1,i=0;i<n.length;++i)if(n[i][0]===e){n[i].length>1?n[i][1]=t:n[i].push(t),r=!0;break}r||n.push([e,t]),history.replaceState("",document.title,window.location.pathname+"?"+o(n)+f())}!function(){if(!window.WidgetParams){var e=l(window.location.search),t=[],n=f();if(n.length>=1&&"#"===n[0])for(var i=a(n.substr(1)),u=0;u<i.length;++u){var s=i[u];r.indexOf(s[0])>=0?e.push(s):t.push(s)}var c=window.location.pathname;e.length>0&&(c+="?"+o(e)),t.length>0&&(c+="#"+o(t)),"undefined"!=typeof history&&history.replaceState("",document.title,c)}}();var g=f(),h=window.location.search;function m(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=window.hasOwnProperty("WidgetParams")?{}:s(h);if(e){var n=function(e){return!e||e.length<1||"#"!==e[0]?{}:i(e.substr(1))}(g);for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}if(window.WidgetParams)for(var o in window.WidgetParams)t[o]=window.WidgetParams[o];return t}},19923:function(e,t,n){"use strict";function r(e,t){var n=e||{};for(var r in t){var o=t[r];null===o?delete n[r]:n[r]=o}return n}n.d(t,{b:function(){return r}})},96809:function(e,t,n){"use strict";var r=n(21941),o=n(60801),i=n(46837),a=n(21506),u=n.n(a),s=n(35048),l=n(35226),c=n.n(l),d=n(58436),f=n(90985),p=n(51881);function g(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function h(e,t){return e&&e.then?e.then(t):t(e)}function m(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function v(e,t,n){if(!e.s){if(n instanceof b){if(!n.s)return void(n.o=v.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(v.bind(null,e,t),v.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var b=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{v(r,1,i(this.v))}catch(e){v(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?v(r,1,t?t(o):o):n?v(r,1,n(o)):v(r,2,o)}catch(e){v(r,2,e)}},r},e}();function w(e){return e instanceof b&&1&e.s}t.Z={bindToContext:function(e){var t=e.bwConfig,n=e.credentialstorage,a=e.throbber,l={INIT:-1,ANONYMOUS:0,OFFLINE:1,ONLINE:2},y=u().Deferred(),D=u().Deferred();return l.initialized=function(){return y.resolve(),D},l.showAlert=s.showAlert,t.getConfig().then((function(e){var t,s=null!==(t=e.parameters)&&void 0!==t?t:(0,f.getParameters)(),E=(0,o.isLTI)(),C=s.sso,A=s.login_hint,S=l.INIT,_=!1;l.stateChangeCallbacks=[],l.registerStateChangeCallback=function(e){this.stateChangeCallbacks.push(e)},l.triggerStateChangeCallbacks=function(){for(var e=[],t=0;t<this.stateChangeCallbacks.length;++t)e.push(this.stateChangeCallbacks[t](S,_));return u().when.apply(null,e)},l.onlinecheck_enabled=!1,l.onlinecheck_count=0;var k=null,O=.5;function x(){return(0,o.isLTI)()||C}function F(){return new Promise((function(e){u()(e)}))}l.isStudentAccountsSupported=x,l.setCredentials=function(e,t){var o={username:(0,r.s)(e),userid:e.id,email:e.email,providerid:e.providerID,providerhumanid:e.providerHumanID,provider:e.provider,school:t,className:e.className,token:e.token,sid:null,coaccount:e.isCoAccount};p.Dj(o),n.setCredentials(p.K9())},l.loadCredentials=m((function(){return h(function(e,t){try{var r=g(n.getCredentials(),(function(e){null!==e?p.Dj(e):p.ZH()}))}catch(e){return t()}return r&&r.then?r.then(void 0,t):r}(0,(function(){console.log("credentials load failure"),p.ZH()})),(function(){return p.K9()}))})),l.getStudentInfo=function(t,n,r){var o=null,i=null;return null!=t&&""!==t?i={Authorization:"BWWAAuthToken "+t}:null!=n&&""!==n&&(o={sid:n}),r&&((o=null!=o?o:{}).pc=r),u().ajax({type:"GET",dataType:"json",data:o,url:e.student_account_server+"/student/GetInfo",headers:i,timeout:1e4})},l.checkIfOnline=function(){if(!this.onlinecheck_enabled)return u().when();var e=u().Deferred(),t=p.Nh();return this.getStudentInfo(t,null,++this.onlinecheck_count).done((function(){console.log("Got back online !"),l.goOnline(),e.resolve()})).fail((function(){e.reject()})),e},l.goOffline=function(){var e=this;console.log("goOffline"),i.An((function(){return console.log("Executing goOffline"),e.setState(l.OFFLINE)}),null,void 0,!0)},l.goOnline=function(){var e=this;console.log("goOnline"),i.An((function(){return console.log("Executing goOnline"),e.setState(l.ONLINE)}),null,void 0,!0)},l.scheduleOnlineCheck=function(){var e=this;O=Math.min(2*O,20),this.onlinecheck_enabled&&(k=setTimeout((function(){e.checkIfOnline().always((function(){e.scheduleOnlineCheck()}))}),1e3*O))},l.startOnlineCheck=function(){this.onlinecheck_enabled=!0,this.onlinecheck_count=0,O=.5,this.scheduleOnlineCheck()},l.stopOnlineCheck=function(){this.onlinecheck_enabled=!1,null!==k&&clearTimeout(k)},l.setState=function(e){return e===S?(console.log("Warning: setting identical storage state, ignoring",e),u().when()):(S===l.OFFLINE&&this.stopOnlineCheck(),e===l.OFFLINE&&this.startOnlineCheck(),S=e,this.triggerStateChangeCallbacks())},l.setForceOfflineStorage=function(){return!1===_&&(_=!0),this.triggerStateChangeCallbacks()},l.setAnonymous=function(){this.setState(this.ANONYMOUS),D.resolve()},l.initializeWithStoredCredentials=m((function(e){var t=!1,n=this,r=e.token,o=e.sid,i=null!=r&&""!==r;if(!1!==i||!1!=(null!=o&&""!==o)){var u=1,s=1e3;return h(function(e,t,n){for(var r;;){var o=e();if(w(o)&&(o=o.v),!o)return i;if(o.then){r=0;break}var i=n();if(i&&i.then){if(!w(i)){r=1;break}i=i.s}if(t){var a=t();if(a&&a.then&&!w(a)){r=2;break}}}var u=new b,s=v.bind(null,u,2);return(0===r?o.then(c):1===r?i.then(l):a.then(d)).then(void 0,s),u;function l(r){i=r;do{if(t&&(a=t())&&a.then&&!w(a))return void a.then(d).then(void 0,s);if(!(o=e())||w(o)&&!o.v)return void v(u,1,i);if(o.then)return void o.then(c).then(void 0,s);w(i=n())&&(i=i.v)}while(!i||!i.then);i.then(l).then(void 0,s)}function c(e){e?(i=n())&&i.then?i.then(l).then(void 0,s):l(i):v(u,1,i)}function d(){(o=e())?o.then?o.then(c).then(void 0,s):c(o):v(u,1,i)}}((function(){return!t&&u<=5}),void 0,(function(){return g(function(e,t,n,r,o,i,u){return new Promise((function(s){var d=a("body");e.getStudentInfo(t,n).then((function(t){d.close(),!C||n||t.provider===C&&A&&0!=A.length&&(t.providerID===A||t.providerHumanID===A)?(e.setCredentials(t,r.school),e.setState(l.ONLINE),D.resolve(),s(!0)):(console.log("Logged in with incompatible credentials. Re-login."),e.showAlert(c()("Wrong widget link"),c()("Sign in failed")))}),(function(t){if(d.close(),console.log("Error getting student info -> either invalid token or wrong connection"),o&&401!==t.status)console.log("got token -> moving offline"),e.setState(l.OFFLINE),D.resolve(),s(!0);else if(o||401!==t.status){console.log("other login problem -> retry");var n=e.showAlert(c()("Retrying...")+" (".concat(i,")"),c()("Sign in failed"));setTimeout((function(){n.dialog("close"),s(!1)}),u)}else console.log("sid invalid -> reloading"),window.location.reload()}))}))}(n,r,o,e,i,"".concat(u,"/").concat(5),s),(function(e){e?t=!0:(++u,s<8e3&&(s*=2))}))})),(function(e){if(t)return e;n.showAlert(c()("Sign in failed"),c()("Sign in failed"),c()("Reload"),(function(){window.location.reload()}))}))}console.log("Wrong widget link: no token and no sid..."),n.showAlert(c()("Wrong widget link"),c()("Sign in failed"))})),l.initialize=function(){var e=this;return function(e,t,n){try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}(F,(function(){if(!x())return console.log("no student accounts supported"),e.setState(e.ANONYMOUS),void D.resolve();var t=s.sid;return t?(console.log("Got SID from params"),"blank"===window.location.pathname||window.WidgetParams||window.history.replaceState("",document.title,window.location.pathname+window.location.search+(0,f.removeQueryStringParameter)((0,f.getHash)(),"sid")),void e.initializeWithStoredCredentials({sid:t})):!E&&(0,d.isPreview)()?(e.setState(e.ANONYMOUS),void D.resolve()):g(e.loadCredentials(),(function(t){e.initializeWithStoredCredentials(t)}))}))},y.then((function(){l.initialize()})),l.getUserToken=function(){return p.Nh()},l.getUserSid=function(){return p.Od()},l.getUserName=function(){return p.vW()},l.getUserClassName=function(){return p.Ej()},l.getUserId=function(){return p.n5()},l.getEmail=function(){return p.OD()},l.getProviderId=function(){return p.iy()},l.getProviderHumanId=function(){return p.tZ()},l.isCoAccount=function(){return p.QG()},l.getState=function(){return S},l.getForceOfflineStorage=function(){return _},l.hasProperty=function(e){return"user_id"===e},l.getProperty=function(e){if("user_id"==e)return this.getUserId()}})),l}}},27813:function(e,t,n){"use strict";n.r(t),n.d(t,{createDefaultContext:function(){return C}});var r=n(937),o=n(78563),i=n.n(o),a=n(4375),u=n(10306),s=n(96809),l=n(54083),c=n(55459),d=n(43683),f=n(77143),p=n(78294),g=n(13352),h=n.n(g),m=n(45442),v=n.n(m),b=n(35048),w=n(35226),y=n.n(w),D=n(13342),E=n.n(D);function C(e){e=e||{};var t={bwConfig:r,dialog:b,throbber:u.createThrobber};return t.tr=y(),t.credentialstorage=i()(),t.studentaccount=s.Z.bindToContext(t),t.studentaccountbutton=l.m(t),t.bwds=h(),t.blob=v(),t.bwdsstorage=f.Z.bindToContext(t),t.onlinestorage=d.Z.bindToContext(t),t.writecachingonlinestorage=p.Z.bindToContext(t),t.studentinfo=a.Z.bindToContext(t),e.nostorage||(t.widgetstorage=c.Z.bindToContext(t)),e.nosubmitter||(t.StudentWorkSubmitter=E().bindToContext(t)),t}},55459:function(e,t,n){"use strict";var r=n(79421),o=n.n(r),i=n(69725),a=n(90985),u=n(46837),s=n(21506),l=n.n(s);t.Z={bindToContext:function(e){var t,n,r,s,c,d=e.bwConfig,f=e.studentaccount,p=e.studentaccountbutton,g=e.bwdsstorage,h=e.writecachingonlinestorage,m=e.throbber,v={},b="",w=!1,y=(0,a.getParameters)(),D=y.hasOwnProperty("teacher_id")?y.teacher_id:"",E=y.hasOwnProperty("school_id")?y.school_id:"",C=y.hasOwnProperty("course_id")?y.course_id:"",A=y.storageKey,S=y.hasOwnProperty("student_class_id")&&!y.hasOwnProperty("iscid")?y.student_class_id:"",_=y.hasOwnProperty("context_id")?y.context_id:"",k=null;v.WIDGET_ANONYMOUS=0,v.WIDGET_OFFLINE=1,v.WIDGET_ONLINE=2;var O=-1,x=!1;function F(){return O!==v.WIDGET_ONLINE||x?l().when(!1):k.moveImageOnlineIfRequired()}function T(){u.An(F).done((function(e){e&&T()}))}function I(){var e=m("body"),n=l().Deferred();return i.BL(),k.loadAll((function(r){i.ut(),e.close(),Promise.resolve(t(r)).then((function(){T(),n.resolve()}))})),n}v.stateChanged=function(e,o){if(e===O&&o===x)return console.log("Warning: setting identical storage state, ignoring"),l().when();if(O===v.WIDGET_OFFLINE&&e===v.WIDGET_ONLINE&&!0===o)return O=e,x=o,l().when();var a="no"!==d.getConfigSync().save_answers;switch(e){case v.WIDGET_ANONYMOUS:console.log("Using anonymous storage"),k=g.createWidgetStorage(r,n,c,w,"",A,b,a);break;case v.WIDGET_ONLINE:if(!1===o){console.log("Using online storage"),k=h.createWidgetStorage(r,n,s,c,w,f.getUserId(),A,b,D,E,C,null==S||""===S?f.getUserClassName()?f.getUserClassName():"":S,_);break}case v.WIDGET_OFFLINE:console.log("Using offline storage"),k=g.createWidgetStorage(r,n,c,w,f.getUserId(),A,b,a)}var u,p=O,m=x;return O=e,x=o,function(e,t){return-1!=e&&e+t<3}(p,e)?I():p===v.WIDGET_OFFLINE&&e===v.WIDGET_ONLINE?(u=l().Deferred(),i.BL(),k.goneOnlineSync((function(e){i.ut(),"CONFLICT"==e.status&&t(e.data),"OFFLINE"!==e.status&&T(),u.resolve()})),u):p===v.WIDGET_ONLINE&&e===v.WIDGET_OFFLINE||m!==x?function(){var e=l().Deferred();return k.loadAll((function(t){e.resolve()})),e}():l().when()},v.init=function(e){var o=this;t=e.updateCallback,n=e.type,r=e.group,s=e.name,c=e.id,w=e.singleKey,b=e.extension,f.initialized().then((function(){o.stateChanged(f.getState(),f.getForceOfflineStorage()),I(),f.registerStateChangeCallback(o.stateChanged.bind(o))}),(function(){o.stateChanged(f.ANONYMOUS,!0),I()}));var i=!!e.hide_account;f.isStudentAccountsSupported()&&!i&&p.init()};var B=null;function N(e,t){var n=e||{};for(var r in t)n[r]=t[r];return n}function R(e){var n=l().Deferred();return i.BL(),k.write(e,(function(e){i.ut(),e&&"CONFLICT"===e.status&&(t(e.data),u.Od(R)),n.resolve()})),n}return v.prepareStorageUpgrade=function(e){B=e},v.write=function(e){null!==k&&(null!=B&&(e=N(B,e),B=null),u.An(R,e,w?function(e,t){return t}:N))},v.registerImage=function(e){var t=l().Deferred(),n=(new Date).getTime()+function(e){for(var t="",n=0;n<5;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}();return u.Mn((function(){k.writeImage(n,e).done((function(){t.resolve("bwimg:"+n)})).fail((function(){t.reject()}))})),t},v.clearImage=function(e){var t=l().Deferred();return 0!==e.indexOf("bwimg:")?(t.reject(),t):(u.Mn((function(){var n=e.substring(6);k.clearImage(n).done((function(){t.resolve()})).fail((function(){console.log("Could not clear image"),t.reject()}))})),t)},v.getImageUrl=function(e){var t=l().Deferred();return 0!==e.indexOf("bwimg:")?(t.resolve(e),t):(u.Mn((function(){var n=e.substring(6);k.readImage(n).done((function(e){t.resolve(e)})).fail((function(){t.reject("")}))})),t)},v.sync=function(e){u.Mn(e)},v.clear=function(){},v.throttlers=[],v.createThrottler=function(e){var t={cb:e,maxdelay:arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,timeout:null,flush:function(){null!=this.timeout&&(this.clear(),this.cb())},cancel:function(){null!=this.timeout&&(clearTimeout(this.timeout),this.clear())},clear:function(){this.timeout=null,i.ut()},trigger:function(){var e=this;null!=this.cb&&null==this.timeout&&(i.BL(),this.timeout=setTimeout((function(){e.flush()}),this.maxdelay))}};return this.throttlers.push(t),t},v.cancelThrottlers=function(){o()(this.throttlers,(function(e){e.cancel()}))},v.flushThrottlers=function(){o()(this.throttlers,(function(e){e.flush()}))},v}}},78294:function(e,t,n){"use strict";var r=n(22927),o=n(21506),i=n.n(o),a=(0,r.createLogger)("WriteCachingOnlineStorage");t.Z={bindToContext:function(e){var t=e.studentaccount,n=e.onlinestorage,r=e.bwdsstorage;return{createWidgetStorage:function(e,o,u,s,l,c,d,f,p,g,h,m,v){var b={};return b.os=n.createWidgetStorage(o,u,s,l,p,g,h,m,v),b.bs=r.createWidgetStorage(e,o,s,l,t.getUserId(),d,f,!1),b.loadAll=function(e){var t=this;a.debug("loadAll");var n=i().Deferred(),r=i().Deferred();this.os.loadAll((function(e,t){a.debug("loadAll OS",t,e),n.resolve(e,t)})),this.bs.getVersion((function(e){a.debug("loadAll BS",e),r.resolve(e)})),i().when(n,r).done((function(n,r){var o=n[0],i=n[1];-1==i?(console.log("error accessing online data, return local data or null"),r.hasdata?(a.debug("load BS data"),t.bs.loadAll(e)):(a.debug("empty data"),e(l?null:{}))):r.version<=i&&!1===r.offlinedata?(a.debug("loadall no offline BS data, use OS data"),t.bs.overwriteAndSetVersion(o,i).finally((function(){a.debug("overwriteAndSetVersion done",o,i),e(o)}))):(a.debug("have BS offline data"),t.os.setNextUploadVersion(r.version),t.bs.loadAll((function(n){a.debug("BS data loaded",n),t.os.overwrite(n,(function(r){"OFFLINE"===r.status?(console.log("error when flushing local data"),e(n)):"CONFLICT"===r.status?(a.debug("goneOnlineSync online data conflict",r.version),t.bs.overwriteAndSetVersion(r.data,r.version).finally((function(){e(r.data)}))):(a.debug("loadAll online data written to version",r.version),t.bs.setVersion(r.version).finally((function(){a.debug("loadAll bs version set"),e(n)})))}),!0)})))}))},b.goneOnlineSync=function(e){var t=this;a.debug("goneOnlineSync");var n=i().Deferred(),r=i().Deferred();this.os.loadAll((function(e,t){a.debug("goneOnlineSync OS",t,e),n.resolve(e,t)})),this.bs.getVersion((function(e){a.debug("goneOnlineSync BS",e),r.resolve(e)})),i().when(n,r).done((function(n,r){var o=n[0],i=n[1];-1==i?(console.log("goneOnlineSync: Can't find online version"),e({status:"OFFLINE"})):r.version<i&&!1===r.offlinedata?(console.log("goneOnlineSync: local version out of date, need to use online version"),t.bs.overwriteAndSetVersion(o,i).finally((function(){a.debug("goneOnlineSync returning conflict"),e({status:"CONFLICT",data:o})}))):!0===r.offlinedata?(console.log("goneOnlineSync: latest version is local, pushing state online"),t.os.setNextUploadVersion(r.version),t.bs.loadAll((function(n){a.debug("goneOnlineSync: latest version loaded",n),t.os.overwrite(n,(function(n){"OFFLINE"===n.status?(a.debug("goneOnlineSync data error when flushing local data"),e({status:"OFFLINE"})):"CONFLICT"==n.status?(a.debug("goneOnlineSync online data conflict",n.version),t.bs.overwriteAndSetVersion(n.data,n.version).finally((function(){e(n)}))):(a.debug("goneOnlineSync online data written to version",n.version),t.bs.setVersion(n.version).finally((function(){a.debug("WriteCachingOnlineStorage goneOnlineSync bs version set"),e({status:"OK"})})))}),!0)}))):e({status:"OK"})}))},b.write=function(e,t){var n=this;this.bs.write(e,(function(){n.os.write(e,(function(e){void 0!==e&&e.hasOwnProperty("data")?n.bs.overwriteAndSetVersion(e.data,e.version).finally((function(){t(e)})):t(e)}))}))},b.writeImage=function(e,t){var n=this,r=i().Deferred();return this.bs.writeImage(e,t).done((function(){r.resolve(),n.os.writeImage(e,t).done((function(){n.bs.setImageBackedUp(e)})).fail((function(){}))})).fail((function(){n.os.writeImage(e,t).done((function(){r.resolve()})).fail((function(){r.reject()}))})),r},b.clearImage=function(e){var t=i().Deferred();return i().when(this.bs.clearImage(e),this.os.clearImage(e)).done((function(){t.resolve()})).fail((function(){t.reject()})),t},b.readImage=function(e){var t=this;a.debug("WriteCachingOnlineStorage readImage",e);var n=i().Deferred();return this.bs.readImage(e).done((function(e){n.resolve(e)})).fail((function(){t.os.readImage(e).done((function(e){n.resolve(e)})).fail((function(){n.reject()}))})),n},b.moveImageOnline=function(e){var t=this;a.debug("WriteCachingOnlineStorage moveImageOnline",e);var n=i().Deferred();return this.bs.readImage(e).done((function(r){a.debug("Read image data and moving it online"),t.os.writeImage(e,r).done((function(){a.debug("image written online, setting backed up tag"),t.bs.setImageBackedUp(e).finally((function(){n.resolve()}))})).fail((function(){a.debug("moving image online failed"),n.reject()}))})).fail((function(){a.debug("error reading image"),n.reject()})),n},b.moveImageOnlineIfRequired=function(){var e=this;a.debug("WriteCachingOnlineStorage moveImageOnlineIfRequired");var t=i().Deferred();return this.bs.listImagesAndBackupStatus().then((function(n){a.debug("WriteCachingOnlineStorage moveImageOnlineIfRequired image list:",n);for(var r=0;r<n.length;++r)if(!1===n[r].backed_up)return void e.moveImageOnline(n[r].id).then((function(){a.debug("moveImageOnline succeeded"),t.resolve(!0)}),(function(){a.debug("moveImageOnline failed"),t.reject()}));t.resolve(!1)})),t},b},createInfoStorage:function(e){var n={};return n.bs=r.createInfoStorage(e,t.getUserId(),!1),n.getCommonProperties=function(e){this.bs.getCommonProperties((function(t){e(t)}))},n.getGroupProperties=function(e){this.bs.getGroupProperties((function(t){e(t)}))},n.setCommonProperties=function(e){this.bs.setCommonProperties(e)},n.setGroupProperties=function(e){this.bs.setGroupProperties(e)},n}}}}},34785:function(e,t,n){"use strict";n.d(t,{V:function(){return s},$:function(){return l}});var r=n(2784),o=n(72779),i=n.n(o),a=n(88853),u={DialogWrapper:"zCWlb6KxN0wcFaBAlKK1",Dialog:"EUUG1NFe0EylNBWxGYLa",DialogBody:"c4uvUz6vdVB2ho6B3nyQ",DialogCloseButton:"XuaxNjYhh3a9jn_R0FtR"};function s(e){var t=e.title,n=e.children,o=e.OK,s=e.onOk,l=e.Cancel,c=e.onCancel,d=e.onClose,f=e.className;return r.createElement("div",{className:i()("bw-centered bw-row-container ui-dialog ui-widget ui-widget-content ui-corner-all bw-dialog",u.Dialog,f)},r.createElement("div",{className:"bw-row-fixed ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"},r.createElement("span",{className:"i-dialog-title",id:"ui-dialog-title-1"},t)),d&&r.createElement("button",{className:u.DialogCloseButton,onClick:d,"aria-label":(0,a.Iu)("Cancel")},"×"),r.createElement("div",{className:i()("bw-row-expanding ui-dialog-content ui-widget-content",u.DialogBody)},n),r.createElement("div",{className:"bw-row-fixed ui-dialog-buttonpane"},r.createElement("div",{className:"ui-dialog-buttonset"},c&&r.createElement("button",{className:"ui-button ui-widget ui-state-default ui-button-text-only",onClick:c},r.createElement("span",{className:"ui-button-text"},l)),r.createElement("button",{className:"ui-button ui-widget ui-state-default ui-button-text-only",onClick:s},r.createElement("span",{className:"ui-button-text"},o||(0,a.Iu)("OK"))))))}function l(e){var t=e.children;return r.createElement("div",{className:i()("bw-centering-container",u.DialogWrapper)},t)}},6424:function(e,t,n){"use strict";n.d(t,{H:function(){return h}});var r=n(2784),o=n(21506),i=n.n(o),a=n(5733),u=n(40904),s=n(89372),l=n(92824),c=n(39458);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===d(o)?o:String(o)),r)}var o}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,p(t).apply(this,arguments))}var n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),n=t,(o=[{key:"setWrapperDivRef",value:function(e){if(null!=e){var t=i()(e);t.safeHtml(s.prepare(this.props.text)),l.resolveYoutubePlaceholders(t),a.process(t),s.processMathElems(t),c.processAudioTags(t),this.props.direction&&(0,u.setAutoDirectionIfRequired)(this.props.directionSelector?t.find(this.props.directionSelector):t,this.props.direction)}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.onClick,o=e.style,i=e.id;return r.createElement("div",{className:t,onClick:n,style:o,ref:this.setWrapperDivRef.bind(this),id:i})}}])&&f(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(r.PureComponent)},90882:function(e,t,n){var r=n(67552),o=n(98043),i=n(68286),a=n(86152);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},16760:function(e,t,n){var r=n(50343),o=n(68286),i=n(93401),a=n(86152);e.exports=function(e,t){return(a(e)?r:i)(e,o(t,3))}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=t,r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},e=[],r.O=function(t,n,o,i){if(!n){var a=1/0;for(c=0;c<e.length;c++){n=e[c][0],o=e[c][1],i=e[c][2];for(var u=!0,s=0;s<n.length;s++)(!1&i||a>=i)&&Object.keys(r.O).every((function(e){return r.O[e](n[s])}))?n.splice(s--,1):(u=!1,i<a&&(a=i));if(u){e.splice(c--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,o,i]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.j=654,function(){var e={654:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,a=n[0],u=n[1],s=n[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(o in u)r.o(u,o)&&(r.m[o]=u[o]);if(s)var c=s(r)}for(t&&t(n);l<a.length;l++)i=a[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},n=self.webpackChunkbw_widgets=self.webpackChunkbw_widgets||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o=r.O(void 0,[736],(function(){return r(1019)}));o=r.O(o)}();